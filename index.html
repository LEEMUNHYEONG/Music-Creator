<!-- prettier-ignore -->
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI ê¸°ë°˜ ê°€ì‚¬ ì œì‘ & ìˆ˜ë…¸ í”„ë¡¬í”„íŠ¸ & ë§ˆì¼€íŒ… ìë£Œ ìƒì„±ê¸°">
    <meta name="theme-color" content="#8b5cf6">
    <script>
        // HTTP/HTTPS í™˜ê²½ì—ì„œë§Œ manifest.json ë¡œë“œ (file:// í”„ë¡œí† ì½œì—ì„œëŠ” CORS ì˜¤ë¥˜ ë°©ì§€)
        if (window.location.protocol === 'http:' || window.location.protocol === 'https:') {
            const link = document.createElement('link');
            link.rel = 'manifest';
            link.href = 'manifest.json';
            document.head.appendChild(link);
        }
    </script>
    <title>ğŸµ Music Creator - AI ê°€ì‚¬ & ìˆ˜ë…¸ í”„ë¡¬í”„íŠ¸ ìƒì„±ê¸°</title>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700;800&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link id="main-styles" rel="stylesheet" href="./styles.css">
    <script>
        (function(){
            function injectFallbackStyles() {
                var style = document.createElement('style');
                style.id = 'fallback-styles';
                style.textContent = ':root{--bg-primary:#f8f9fc;--bg-secondary:#eef1f7;--bg-card:#fff;--bg-input:#f1f3f8;--text-primary:#1a1d26;--text-secondary:#5c6370;--border:#dde1e8;--accent:#8b5cf6;--accent-dark:#7c3aed;--primary:#6366f1;--success:#10b981;--warning:#f59e0b;--error:#ef4444}*{box-sizing:border-box}body{margin:0;font-family:\'Pretendard\',\'Noto Sans KR\',sans-serif;background:var(--bg-primary);color:var(--text-primary);line-height:1.6;min-height:100vh}.main-wrapper{display:flex;flex-direction:column;min-height:100vh}.container{flex:1;max-width:100%;padding:20px;margin:0 auto}.sidebar{position:fixed;top:0;left:0;width:320px;height:100vh;background:var(--bg-card);border-right:1px solid var(--border);z-index:1000;display:flex;flex-direction:column}.sidebar:not(.open){transform:translateX(-100%)}button,input,select,textarea{font-family:inherit;font-size:inherit}.btn,.button{padding:8px 16px;border-radius:8px;border:1px solid var(--border);background:var(--bg-card);color:var(--text-primary);cursor:pointer}.btn:hover,.button:hover{background:var(--bg-secondary)}';
                document.head.appendChild(style);
            }
            setTimeout(function(){
                var link = document.getElementById('main-styles');
                if (!link || !link.sheet) {
                    injectFallbackStyles();
                    return;
                }
                try {
                    if (link.sheet.cssRules.length === 0) {
                        injectFallbackStyles();
                    }
                } catch (e) {
                    // file:// ë˜ëŠ” cross-origin: cssRules ì ‘ê·¼ ì‹œ SecurityError ë°œìƒ. ìŠ¤íƒ€ì¼ì€ ë¡œë“œëœ ê²ƒìœ¼ë¡œ ê°„ì£¼.
                }
            }, 150);
        })();
    </script>
    <style>
        /* ë‹¨ê³„ ì™„ë£Œ í‘œì‹œ */
        .step.step-complete .step-number { background: var(--success); color: white; }
        .step.step-complete .step-number::after { content: ' âœ“'; font-size: 0.7em; }
        /* ë‹¤í¬/ë¼ì´íŠ¸ í…Œë§ˆ */
        body.theme-dark { --bg-primary: #1a1a2e; --bg-secondary: #16213e; --bg-card: #0f3460; --bg-input: #1a1a2e; --text-primary: #e8e8e8; --text-secondary: #a0a0a0; --border: #2a2a4a; --accent: #a78bfa; --accent-dark: #7c3aed; }
        /* ë ˆì´ì•„ì›ƒ ê¹¨ì§ ë°©ì§€: ê°€ì‚¬ ì§€ì—­Â·íƒœê·¸ ê·¸ë¦¬ë“œ */
        .tag-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            max-width: 100%;
            overflow-x: hidden;
            box-sizing: border-box;
        }
        .tag-container .tag-btn {
            flex-shrink: 0;
            max-width: 100%;
            box-sizing: border-box;
        }
        /* ë©”ì¸ ì˜ì—­ ê°€ë¡œ ë„˜ì¹¨ ë°©ì§€ */
        .container, .main-wrapper, .panel .card, .panel .form-group {
            max-width: 100%;
            overflow-x: hidden;
            box-sizing: border-box;
        }
        /* ë‹¨ê³„ ì•„ì´ì½˜ ì°Œê·¸ëŸ¬ì§ ë°©ì§€ */
        .progress-steps {
            display: flex;
            flex-wrap: wrap;
            max-width: 100%;
            gap: 4px;
        }
        .progress-steps .step {
            flex-shrink: 0;
            min-width: 0;
        }
        .progress-steps .step-icon {
            flex-shrink: 0;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 1.25em;
        }
        .progress-steps .step-icon i {
            font-size: 1em;
        }
        /* API í‚¤ ì„¤ì • ëª¨ë‹¬: ë°°ê²½ + ì „ì²´ ë””ìì¸ */
        #apiSettingsModal.modal-overlay {
            background: rgba(0, 0, 0, 0.6) !important;
            backdrop-filter: blur(12px);
        }
        #apiSettingsModal .modal {
            background: var(--bg-card) !important;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.35);
            border: 1px solid var(--border);
            border-radius: 16px;
            overflow: hidden;
            max-width: 520px;
        }
        #apiSettingsModal .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 20px 24px 16px;
            border-bottom: 1px solid var(--border);
            background: var(--bg-secondary);
        }
        #apiSettingsModal .modal-title {
            margin: 0;
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            letter-spacing: -0.02em;
        }
        #apiSettingsModal .modal-close {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0;
            border: none;
            border-radius: 10px;
            background: transparent;
            color: var(--text-secondary);
            font-size: 1.25rem;
            line-height: 1;
            cursor: pointer;
            transition: background 0.2s, color 0.2s;
        }
        #apiSettingsModal .modal-close:hover {
            background: var(--bg-input);
            color: var(--text-primary);
        }
        #apiSettingsModal .modal-body {
            padding: 24px;
        }
        #apiSettingsModal .api-key-notice {
            background: rgba(139, 92, 246, 0.08);
            border: 1px solid rgba(139, 92, 246, 0.2);
            border-radius: 12px;
            padding: 16px 18px;
            margin-bottom: 24px;
        }
        #apiSettingsModal .api-key-notice p:first-of-type {
            color: var(--accent);
            font-weight: 600;
            font-size: 0.875rem;
            margin-bottom: 10px;
        }
        #apiSettingsModal .api-key-notice p:last-of-type {
            color: var(--text-secondary);
            font-size: 0.8125rem;
            line-height: 1.65;
            margin: 0;
        }
        #apiSettingsModal .api-key-notice a {
            color: var(--accent);
            text-decoration: none;
        }
        #apiSettingsModal .api-key-notice a:hover {
            text-decoration: underline;
        }
        #apiSettingsModal .api-key-notice .api-notice-security {
            color: var(--error);
        }
        #apiSettingsModal .api-key-msg {
            margin-top: 8px;
            padding: 10px 12px;
            border-radius: 8px;
            font-size: 0.8125rem;
        }
        #apiSettingsModal .api-key-error {
            background: rgba(239, 68, 68, 0.1);
            border-left: 3px solid var(--error);
            color: var(--error);
        }
        #apiSettingsModal .api-key-success {
            background: rgba(16, 185, 129, 0.1);
            border-left: 3px solid var(--success);
            color: var(--success);
        }
        #apiSettingsModal .form-group {
            margin-bottom: 20px;
        }
        #apiSettingsModal .form-group:last-of-type {
            margin-bottom: 0;
        }
        #apiSettingsModal .form-group label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 8px;
        }
        #apiSettingsModal .form-group input[type="text"] {
            width: 100%;
            padding: 12px 14px;
            border: 1px solid var(--border);
            border-radius: 10px;
            background: var(--bg-input);
            color: var(--text-primary);
            font-size: 0.9375rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        #apiSettingsModal .form-group input[type="text"]:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.15);
        }
        #apiSettingsModal .form-group input::placeholder {
            color: var(--text-secondary);
            opacity: 0.8;
        }
        #apiSettingsModal .form-group p {
            font-size: 0.75rem;
            color: var(--text-secondary);
            margin: 6px 0 0;
        }
        #apiSettingsModal .modal-footer {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            padding: 16px 24px 20px;
            border-top: 1px solid var(--border);
            background: var(--bg-secondary);
        }
        #apiSettingsModal .modal-footer .btn {
            padding: 10px 18px;
            border-radius: 10px;
            font-size: 0.875rem;
            font-weight: 500;
        }
        #apiSettingsModal .modal-footer .btn-primary {
            background: var(--accent);
            color: #fff;
            border: none;
        }
        #apiSettingsModal .modal-footer .btn-primary:hover {
            background: var(--accent-dark);
        }
        #apiSettingsModal .modal-footer .btn-secondary {
            background: var(--bg-input);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }
        #apiSettingsModal .modal-footer .btn-secondary:hover {
            background: var(--border);
        }
        body.theme-dark #apiSettingsModal .modal {
            background: var(--bg-card) !important;
        }
    </style>
</head>
<body>
    <div class="bg-animation"></div>
    <div class="sound-waves" id="soundWaves"></div>

    <!-- Sidebar Toggle Button -->
    <button class="sidebar-toggle" id="sidebarToggle" onclick="toggleSidebar()" 
            aria-label="ì‚¬ì´ë“œë°” ì—´ê¸°" aria-expanded="false">
        <i class="fas fa-bars" aria-hidden="true"></i>
    </button>

    <!-- Left Sidebar (ë“œë˜ê·¸ ë° ë¦¬ì‚¬ì´ì¦ˆ ê°€ëŠ¥) -->
    <aside class="sidebar open" id="sidebar">
        <!-- ë¦¬ì‚¬ì´ì¦ˆ í•¸ë“¤ (ìš°ì¸¡ ê°€ì¥ìë¦¬) -->
        <div class="sidebar-resize-handle" id="sidebarResizeHandle" title="ë“œë˜ê·¸í•˜ì—¬ í¬ê¸° ì¡°ì ˆ"></div>
        <div class="sidebar-header" id="sidebarHeader">
            <h3><i class="fas fa-folder" aria-hidden="true"></i> ì €ì¥ëœ í”„ë¡œì íŠ¸</h3>
            <div style="display: flex; gap: 8px; align-items: center;">
                <span class="sidebar-drag-handle" title="ë“œë˜ê·¸í•˜ì—¬ ìœ„ì¹˜ ì´ë™" style="cursor: grab; padding: 4px; opacity: 0.5; transition: opacity 0.2s;">
                    <i class="fas fa-grip-vertical" aria-hidden="true"></i>
                </span>
                <button class="sidebar-close" onclick="toggleSidebar()" aria-label="ì‚¬ì´ë“œë°” ë‹«ê¸°">
                    <i class="fas fa-times" aria-hidden="true"></i>
                </button>
            </div>
        </div>
        
        <div class="sidebar-actions">
            <button class="btn btn-primary btn-small" onclick="if(typeof window.saveCurrentProject === 'function') { const saved = window.saveCurrentProject(); if(!saved) { alert('âš ï¸ í”„ë¡œì íŠ¸ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); } } else { alert('âš ï¸ ì €ì¥ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }" style="width: 100%;"
                    aria-label="í˜„ì¬ í”„ë¡œì íŠ¸ ì €ì¥">
                <i class="fas fa-save" aria-hidden="true"></i> í˜„ì¬ í”„ë¡œì íŠ¸ ì €ì¥
            </button>
            <button class="btn btn-secondary btn-small" onclick="if(typeof window.saveAndClose === 'function') { window.saveAndClose(); } else { alert('ì €ì¥ í›„ ë‹«ê¸° ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'); }" style="width: 100%; margin-top: 8px;"
                    aria-label="ì €ì¥ í›„ ë‹«ê¸°" title="ëª¨ë“  ë‚´ìš© ì €ì¥ í›„ ì°½ì„ ë‹«ìŠµë‹ˆë‹¤">
                <i class="fas fa-save"></i> ì €ì¥ í›„ ë‹«ê¸°
            </button>
        </div>

        <div class="sidebar-search">
            <label for="projectSearch" class="sr-only">í”„ë¡œì íŠ¸ ê²€ìƒ‰</label>
            <input type="text" id="projectSearch" placeholder="ğŸ” í”„ë¡œì íŠ¸ ê²€ìƒ‰..." 
                   oninput="filterProjects()" aria-label="í”„ë¡œì íŠ¸ ê²€ìƒ‰">
        </div>
        
        <div class="sidebar-sort">
            <label for="projectSort" class="sr-only">ì •ë ¬ ê¸°ì¤€</label>
            <select id="projectSort" class="project-sort-select" onchange="sortProjects()" aria-label="í”„ë¡œì íŠ¸ ì •ë ¬">
                <option value="savedAt-desc">ğŸ“… ìˆ˜ì •ì¼ì‹œ (ìµœì‹ ìˆœ)</option>
                <option value="savedAt-asc">ğŸ“… ìˆ˜ì •ì¼ì‹œ (ì˜¤ë˜ëœìˆœ)</option>
                <option value="createdAt-desc">ğŸ†• ì‘ì„±ì¼ì‹œ (ìµœì‹ ìˆœ)</option>
                <option value="createdAt-asc">ğŸ†• ì‘ì„±ì¼ì‹œ (ì˜¤ë˜ëœìˆœ)</option>
                <option value="title-asc">ğŸ“ ì œëª© (ê°€ë‚˜ë‹¤ìˆœ)</option>
                <option value="title-desc">ğŸ“ ì œëª© (ì—­ìˆœ)</option>
                <option value="genre-asc">ğŸµ ì¥ë¥´ (ê°€ë‚˜ë‹¤ìˆœ)</option>
                <option value="genre-desc">ğŸµ ì¥ë¥´ (ì—­ìˆœ)</option>
                <option value="step-desc">ğŸ“ ì§„í–‰ë‹¨ê³„ (ë†’ì€ìˆœ)</option>
                <option value="step-asc">ğŸ“ ì§„í–‰ë‹¨ê³„ (ë‚®ì€ìˆœ)</option>
            </select>
        </div>

        <!-- ìµœê·¼ í”„ë¡œì íŠ¸ (ìƒë‹¨ 5ê°œ) -->
        <div id="recentProjectsList" style="margin-bottom: 12px; padding-bottom: 12px; border-bottom: 1px solid var(--border); display: none;"></div>
        <!-- í”„ë¡œì íŠ¸ ë¦¬ìŠ¤íŠ¸ (ìµœëŒ€í•œ ì„¸ë¡œë¡œ ê¸¸ê²Œ) -->
        <div class="project-list" id="projectList" style="flex: 1; overflow-y: auto; min-height: 0;">
            <!-- Projects will be loaded here -->
        </div>
    </aside>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay" style="display: none !important; pointer-events: none !important; opacity: 0 !important; visibility: hidden !important; z-index: -9999 !important;"></div>

    <!-- Main Content Wrapper -->
    <div class="main-wrapper" id="mainWrapper">
    <header>
        <div class="header-top">
            <!-- ì²« ë²ˆì§¸ í–‰: ì œëª© -->
            <div class="header-row-1">
                <div class="header-center">
                    <div class="logo-main">
                        <span class="logo-icon"><i class="fas fa-music"></i></span>
                        <div>
                            <h1 class="logo" style="margin: 0; font-size: 3rem;">Music Creator</h1>
                            <p class="logo-subtitle" style="margin: 0; font-size: 0.75rem; text-align: center;">AI ê¸°ë°˜ ê°€ì‚¬ ì œì‘ & ìˆ˜ë…¸ í”„ë¡¬í”„íŠ¸ & ë§ˆì¼€íŒ… ìë£Œ ìƒì„±ê¸°</p>
                        </div>
                    </div>
                    <div class="current-song-title" id="currentSongTitle" style="display: none; margin: 8px 0 0 0;">
                        <i class="fas fa-headphones" style="margin-right: 8px; color: var(--accent);"></i>
                        <span class="song-title-text" id="songTitleText">ì œëª© ì—†ìŒ</span>
                    </div>
                </div>
            </div>
            
            <!-- ë‘ ë²ˆì§¸ í–‰: AI ìƒíƒœ/ì„ íƒ, ë©”ë‰´ ë²„íŠ¼ë“¤, ì €ì¥ ë²„íŠ¼ -->
            <div class="header-row-2">
                <div class="header-left">
                    <div class="api-status" title="AI ì—­í• : ChatGPT(ìƒì„±) + Gemini(ë¶„ì„/MV)">
                        <span class="api-dot"></span>
                        <span id="apiStatusText">Dual AI ëª¨ë“œ</span>
                    </div>
                    <div class="api-selector-wrapper" style="display: flex; align-items: center; gap: 8px; white-space: nowrap;">
                        <select id="apiSelector" class="api-selector" onchange="handleAPIChange(this.value, event)" title="ê¸°ë³¸ AI ì„ íƒ">
                            <option value="gemini">ğŸ”® Gemini</option>
                            <option value="openai" selected>ğŸ¤– ChatGPT</option>
                        </select>
                        <span class="ai-role-hint" style="font-size: 0.7rem; color: var(--text-secondary); cursor: help; white-space: nowrap;" 
                              title="ChatGPT: ê°€ì‚¬/ìŠ¤íƒ€ì¼ ìƒì„±&#10;Gemini: ì •ë°€ë¶„ì„/ê°œì„ ì•ˆ/MVí”„ë¡¬í”„íŠ¸">
                            â„¹ï¸ AI í˜‘ì—…
                        </span>
                    </div>
                </div>
                <div class="header-right">
                    <div class="header-menu-dropdown" style="position: relative;">
                        <button type="button" class="btn btn-header-icon" id="adminMenuTrigger" onclick="toggleAdminMenu(event)" title="ê´€ë¦¬ì ë©”ë‰´ (API, ë°±ì—…, ë³µêµ¬, ì´ˆê¸°í™” ë“±)">
                            <span class="btn-icon"><i class="fas fa-cog"></i></span>
                            <span class="btn-text">ê´€ë¦¬ì</span>
                            <span class="btn-icon" style="margin-left: 4px; font-size: 0.65rem;"><i class="fas fa-chevron-down"></i></span>
                        </button>
                        <div id="headerMenuContent" class="admin-menu-content" style="display: none; position: absolute; top: 100%; right: 0; left: auto; margin-top: 6px; min-width: 200px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 10px; box-shadow: 0 8px 24px rgba(0,0,0,0.25); z-index: 9999; padding: 8px 0; overflow: hidden;">
                            <div style="padding: 10px 14px; font-size: 0.75rem; font-weight: 600; color: var(--text-secondary); border-bottom: 1px solid var(--border);">ì„¤ì • Â· ë³µêµ¬ Â· ì´ˆê¸°í™”</div>
                            <button type="button" class="admin-menu-item" id="apiKeyMenuBtn" onclick="event.preventDefault(); event.stopPropagation(); closeAdminMenu(); if(typeof window.openAPISettings==='function'){ window.openAPISettings(); } else { alert('API ì„¤ì •ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }">
                                <i class="fas fa-key"></i> API í‚¤
                            </button>
                            <button type="button" class="admin-menu-item" onclick="handleHeaderButtonClick('openGuidelinesModal', event); closeAdminMenu();">
                                <i class="fas fa-book"></i> ì§€ì¹¨ì„œ
                            </button>
                            <button type="button" class="admin-menu-item" onclick="handleHeaderButtonClick('manualBackup', event); closeAdminMenu();">
                                <i class="fas fa-download"></i> ë°±ì—…
                            </button>
                            <div style="height: 1px; background: var(--border); margin: 6px 0;"></div>
                            <button type="button" class="admin-menu-item" onclick="handleHeaderButtonClick('resetCurrentStep', event); closeAdminMenu();">
                                <i class="fas fa-undo"></i> ë‹¨ê³„ ì´ˆê¸°í™”
                            </button>
                            <button type="button" class="admin-menu-item" onclick="handleHeaderButtonClick('resetAllSteps', event); closeAdminMenu();">
                                <i class="fas fa-redo"></i> ì „ì²´ ì´ˆê¸°í™”
                            </button>
                            <button type="button" class="admin-menu-item" onclick="handleHeaderButtonClick('resetStepOrder', event); closeAdminMenu();">
                                <i class="fas fa-arrows-alt"></i> ìˆœì„œ ì´ˆê¸°í™”
                            </button>
                            <button type="button" class="admin-menu-item" onclick="handleHeaderButtonClick('openStepOrderHelp', event); closeAdminMenu();">
                                <i class="fas fa-question-circle"></i> ë„ì›€ë§
                            </button>
                        </div>
                    </div>
                    <button class="btn btn-header-icon btn-edit" id="editModeToggleBtn" onclick="if(typeof window.toggleEditMode === 'function') { window.toggleEditMode(); } else { alert('âš ï¸ ìˆ˜ì • ëª¨ë“œ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }" 
                            title="ìˆ˜ì • ëª¨ë“œ ì „í™˜" aria-label="ìˆ˜ì • ëª¨ë“œ ì „í™˜">
                        <span class="btn-icon" aria-hidden="true"><i class="fas fa-edit"></i></span>
                        <span class="btn-text" id="editModeToggleText">ìˆ˜ì •</span>
                    </button>
                    <button class="btn btn-header-icon btn-save" onclick="handleHeaderButtonClick('saveCurrentProject', event)" 
                            title="í˜„ì¬ í”„ë¡œì íŠ¸ ì €ì¥ (Ctrl+S)" aria-label="í˜„ì¬ í”„ë¡œì íŠ¸ ì €ì¥">
                        <span class="btn-icon" aria-hidden="true"><i class="fas fa-save"></i></span>
                        <span class="btn-text">ì €ì¥</span>
                    </button>
                    <button class="btn btn-header-icon" id="themeToggleBtn" onclick="if(typeof window.toggleTheme === 'function') { window.toggleTheme(); }" title="ë‹¤í¬/ë¼ì´íŠ¸ í…Œë§ˆ ì „í™˜" aria-label="í…Œë§ˆ ì „í™˜">
                        <span class="btn-icon"><i class="fas fa-moon" id="themeToggleIcon"></i></span>
                        <span class="btn-text" id="themeToggleText">ë‹¤í¬</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Progress Steps -->
        <div class="progress-steps" id="progressSteps">
            <div class="step" data-step="1">
                <span class="step-drag-handle" title="ë“œë˜ê·¸í•˜ì—¬ ìˆœì„œ ë³€ê²½" draggable="true"><i class="fas fa-grip-vertical"></i></span>
                <span class="step-icon"><i class="fas fa-pen"></i></span>
                <span class="step-number">1</span>
                <span class="step-label" onclick="goToStep(1, false, true)">ê°€ì‚¬ ì‘ì„±</span>
            </div>
            <div class="step" data-step="2">
                <span class="step-drag-handle" title="ë“œë˜ê·¸í•˜ì—¬ ìˆœì„œ ë³€ê²½" draggable="true"><i class="fas fa-grip-vertical"></i></span>
                <span class="step-icon"><i class="fas fa-magic"></i></span>
                <span class="step-number">2</span>
                <span class="step-label" onclick="goToStep(2, false, true)">ìˆ˜ë…¸ ë³€í™˜</span>
            </div>
            <div class="step" data-step="3">
                <span class="step-drag-handle" title="ë“œë˜ê·¸í•˜ì—¬ ìˆœì„œ ë³€ê²½" draggable="true"><i class="fas fa-grip-vertical"></i></span>
                <span class="step-icon"><i class="fas fa-chart-line"></i></span>
                <span class="step-number">3</span>
                <span class="step-label" onclick="goToStep(3, false, true)">AI ë¶„ì„</span>
            </div>
            <div class="step" data-step="4">
                <span class="step-drag-handle" title="ë“œë˜ê·¸í•˜ì—¬ ìˆœì„œ ë³€ê²½" draggable="true"><i class="fas fa-grip-vertical"></i></span>
                <span class="step-icon"><i class="fas fa-lightbulb"></i></span>
                <span class="step-number">4</span>
                <span class="step-label" onclick="goToStep(4, false, true)">ê°œì„ ì•ˆ</span>
            </div>
            <div class="step" data-step="5">
                <span class="step-drag-handle" title="ë“œë˜ê·¸í•˜ì—¬ ìˆœì„œ ë³€ê²½" draggable="true"><i class="fas fa-grip-vertical"></i></span>
                <span class="step-icon"><i class="fas fa-file-export"></i></span>
                <span class="step-number">5</span>
                <span class="step-label" onclick="goToStep(5, false, true)">ìµœì¢… ì¶œë ¥</span>
            </div>
            <div class="step" data-step="6">
                <span class="step-drag-handle" title="ë“œë˜ê·¸í•˜ì—¬ ìˆœì„œ ë³€ê²½" draggable="true"><i class="fas fa-grip-vertical"></i></span>
                <span class="step-icon"><i class="fas fa-bullhorn"></i></span>
                <span class="step-number">6</span>
                <span class="step-label" onclick="goToStep(6, false, true)">ë§ˆì¼€íŒ…</span>
            </div>
        </div>

        <!-- Panel 1: ê°€ì‚¬ ì‘ì„± -->
        <div class="panel active" id="panel1">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">âœï¸</div>
                    <div>
                        <h2 class="card-title">ê°€ì‚¬ ì‘ì„±</h2>
                        <p class="card-subtitle">ì§ì ‘ ì‘ì„±í•˜ê±°ë‚˜ AIê°€ ìƒì„±í•´ë“œë¦½ë‹ˆë‹¤</p>
                    </div>
                    <button class="btn btn-small btn-save-step" onclick="saveCurrentProject(); showCopyIndicator('âœ… 1ë‹¨ê³„: ê°€ì‚¬ ì‘ì„±ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');" title="ì´ ë‹¨ê³„ ì €ì¥">
                        <i class="fas fa-save"></i> ì €ì¥
                    </button>
                </div>

                <!-- Mode Tabs -->
                <div class="mode-tabs">
                    <button class="mode-tab active" data-mode="manual" onclick="if(typeof window.switchLyricsMode === 'function') { window.switchLyricsMode('manual'); } else { alert('âš ï¸ ëª¨ë“œ ì „í™˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }">âœï¸ ì§ì ‘ ì‘ì„±</button>
                    <button class="mode-tab" data-mode="ai" onclick="if(typeof window.switchLyricsMode === 'function') { window.switchLyricsMode('ai'); } else { alert('âš ï¸ ëª¨ë“œ ì „í™˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }">ğŸ¤– AI ìƒì„±</button>
                </div>

                <!-- Manual Mode -->
                <div class="lyrics-mode active" id="manualMode">
                    <div class="form-group">
                        <label>ê³¡ ì œëª© (í•œê¸€/ì˜ì–´)</label>
                        <input type="text" id="songTitle" placeholder="ì˜ˆ: ë³„ë¹› ì•„ë˜ì„œ (Under the Starlight)">
                    </div>

                    <div class="form-group">
                        <label>ê°€ì‚¬ ë‚´ìš© <span style="color: var(--accent); font-size: 0.85rem; font-weight: normal;">(ì§€ì‹œì–´ í¬í•¨ ê°€ëŠ¥)</span></label>
                        <textarea id="originalLyrics" placeholder="ì—¬ê¸°ì— ê°€ì‚¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”. ì§€ì‹œì–´ë¥¼ í¬í•¨í•˜ì—¬ ì‘ì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆì‹œ (ì§€ì‹œì–´ í¬í•¨):
[Intro]
[Tempo: 68 BPM] [Vocal: Breathless whisper] [Reverb: Wide stereo]
ì–´ë‘  ì†ì— ë¹›ë‚˜ëŠ” ë³„ì²˜ëŸ¼
ë„ˆì˜ ëˆˆë™ìê°€ ë‚  ë¹„ì¶°

[Verse 1]
[Tempo: 72 BPM] [Vocal: Soft and warm] [Instruments: Soft piano]
ì´ ë°¤ì´ ì˜ì›í•˜ê¸¸ ë°”ë¼ë©°
ë„ˆì˜ ì†ì„ ì¡ì•„"></textarea>
                    </div>

                    <div class="form-group">
                        <label>ğŸµ ìˆ˜ë…¸ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ <span style="color: var(--accent); font-size: 0.85rem; font-weight: normal;">(ì„ íƒì‚¬í•­)</span></label>
                        <div style="display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 8px;">
                            <button type="button" class="btn btn-small btn-secondary" onclick="applyStylePreset('ballad')">ë°œë¼ë“œ</button>
                            <button type="button" class="btn btn-small btn-secondary" onclick="applyStylePreset('poprock')">íŒ ë¡</button>
                            <button type="button" class="btn btn-small btn-secondary" onclick="applyStylePreset('rnb')">R&B</button>
                            <button type="button" class="btn btn-small btn-secondary" onclick="applyStylePreset('kpop')">K-Pop</button>
                            <button type="button" class="btn btn-small btn-secondary" onclick="applyStylePreset('acoustic')">ì–´ì¿ ìŠ¤í‹±</button>
                        </div>
                        <textarea id="manualStylePrompt" placeholder="ì „ì²´ ë…¸ë˜ì— ëŒ€í•œ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ë¥¼ ì‘ì„±í•˜ì„¸ìš”. ì¥ë¥´, ë¶„ìœ„ê¸°, ë°•ì, ë³´ì»¬, ì•…ê¸° ë“±ì„ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì˜ˆì‹œ:
K-Pop Ballad, emotional, 72 BPM, soft and warm vocals, piano and strings, intimate atmosphere, studio quality, gentle reverb, cinematic, heartfelt, melancholic undertones

ë˜ëŠ”:
Pop Rock, energetic, 128 BPM, powerful vocals, electric guitar and drums, stadium atmosphere, dynamic, punchy, anthemic

ğŸ’¡ íŒ: ì¥ë¥´, ë¶„ìœ„ê¸°, í…œí¬(BPM), ë³´ì»¬ ìŠ¤íƒ€ì¼, ì•…ê¸°, ë¶„ìœ„ê¸°, ìŒì§ˆ ë“±ì„ ììœ ë¡­ê²Œ ì¡°í•©í•˜ì—¬ ì‘ì„±í•˜ì„¸ìš”." style="min-height: 120px;"></textarea>
                        <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 5px;">
                            ğŸ’¡ ì´ í”„ë¡¬í”„íŠ¸ëŠ” 2ë‹¨ê³„ ìˆ˜ë…¸ ë³€í™˜ ë‹¨ê³„ì˜ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ì— ìë™ìœ¼ë¡œ ë°˜ì˜ë©ë‹ˆë‹¤.
                        </p>
                    </div>

                    <!-- ì°¸ê³  ê°€ì‚¬ ì„¹ì…˜ -->
                    <div class="form-group" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
                        <label style="display: flex; justify-content: space-between; align-items: center;">
                            <span>ğŸ“š ì°¸ê³  ê°€ì‚¬ (ì„ íƒì‚¬í•­)</span>
                            <button type="button" class="btn btn-small btn-secondary" onclick="toggleReferenceSection()" id="toggleReferenceBtn">
                                <i class="fas fa-chevron-down"></i> í¼ì¹˜ê¸°
                            </button>
                        </label>
                        <div id="referenceSection" style="display: none; margin-top: 15px;">
                            <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 15px;">
                                ê¸°ì¡´ ë…¸ë˜ë‚˜ ì™¸ë¶€ ìŒì›ì˜ ê°€ì‚¬ë¥¼ ì°¸ê³ í•˜ì—¬ ìƒˆë¡œìš´ ê°€ì‚¬ë¥¼ ì°½ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br>
                                ì°¸ê³  ê°€ì‚¬ëŠ” AIê°€ ìƒˆë¡œìš´ ê°€ì‚¬ë¥¼ ìƒì„±í•  ë•Œ ìŠ¤íƒ€ì¼ê³¼ êµ¬ì¡°ë¥¼ ì°¸ê³ í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.
                            </p>
                            
                            <!-- ì €ì¥ëœ í”„ë¡œì íŠ¸ì—ì„œ ì°¸ì¡° -->
                            <div class="form-group" style="margin-bottom: 15px; padding: 15px; background: var(--bg-secondary); border-radius: 8px; border: 1px solid var(--border);">
                                <label style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <span>ğŸ’¾ ì €ì¥ëœ í”„ë¡œì íŠ¸ì—ì„œ ì°¸ì¡°</span>
                                    <button type="button" class="btn btn-small btn-primary" onclick="openProjectReferenceModal()">
                                        <i class="fas fa-folder-open"></i> í”„ë¡œì íŠ¸ ì„ íƒ
                                    </button>
                                </label>
                                <div id="selectedProjectInfo" style="display: none; margin-top: 10px; padding: 10px; background: var(--bg-card); border-radius: 6px; font-size: 0.85rem;">
                                    <div style="display: flex; justify-content: space-between; align-items: start;">
                                        <div>
                                            <div style="font-weight: 600; margin-bottom: 5px;" id="selectedProjectTitle">-</div>
                                            <div style="color: var(--text-secondary); font-size: 0.75rem;" id="selectedProjectDetails">-</div>
                                        </div>
                                        <button type="button" class="btn btn-small btn-secondary" onclick="clearProjectReference()" style="padding: 4px 8px;">
                                            <i class="fas fa-times"></i>
                                        </button>
                                    </div>
                                </div>
                                <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 8px;">
                                    ì €ì¥ëœ í”„ë¡œì íŠ¸ì˜ ê°€ì‚¬ì™€ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ë¥¼ ì°¸ê³ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                                </p>
                            </div>
                            
                            <div class="form-group" style="margin-bottom: 15px;">
                                <label>ì°¸ê³  ë…¸ë˜ ì œëª©</label>
                                <input type="text" id="referenceSongTitle" placeholder="ì˜ˆ: ë³„ì´ ë¹›ë‚˜ëŠ” ë°¤">
                            </div>
                            
                            <div class="form-group" style="margin-bottom: 15px;">
                                <label>ì°¸ê³  ë…¸ë˜ ê°€ìˆ˜/ì•„í‹°ìŠ¤íŠ¸</label>
                                <input type="text" id="referenceArtist" placeholder="ì˜ˆ: ì•„í‹°ìŠ¤íŠ¸ëª… (ì„ íƒì‚¬í•­)">
                            </div>
                            
                            <div class="form-group" style="margin-bottom: 15px;">
                                <label>ì°¸ê³  ê°€ì‚¬ ë‚´ìš©</label>
                                <textarea id="referenceLyrics" placeholder="ì°¸ê³ í•  ê°€ì‚¬ë¥¼ ì…ë ¥í•˜ì„¸ìš”...

ì˜ˆì‹œ:
ë°¤í•˜ëŠ˜ì— ë³„ì´ ë°˜ì§ì¼ ë•Œ
ë„ˆë¥¼ ìƒê°í•˜ë©° ë…¸ë˜í•´
ì´ ê°€ì‚¬ì²˜ëŸ¼ ë¹„ìŠ·í•œ ëŠë‚Œìœ¼ë¡œ
ìƒˆë¡œìš´ ê°€ì‚¬ë¥¼ ë§Œë“¤ì–´ì¤˜" style="min-height: 150px;"></textarea>
                            </div>
                            
                            <div class="form-group" style="margin-bottom: 15px;">
                                <label>ì°¸ê³  ë°©ì‹</label>
                                <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                        <input type="radio" name="referenceStyle" value="structure" checked>
                                        <span>êµ¬ì¡° ì°¸ê³ </span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                        <input type="radio" name="referenceStyle" value="mood">
                                        <span>ë¶„ìœ„ê¸° ì°¸ê³ </span>
                                    </label>
                                    <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                        <input type="radio" name="referenceStyle" value="both">
                                        <span>êµ¬ì¡° + ë¶„ìœ„ê¸°</span>
                                    </label>
                                </div>
                                <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 5px;">
                                    â€¢ êµ¬ì¡° ì°¸ê³ : ì„¹ì…˜ êµ¬ì„±, ê°€ì‚¬ íë¦„ ì°¸ê³ <br>
                                    â€¢ ë¶„ìœ„ê¸° ì°¸ê³ : ê°ì •, í†¤, ìŠ¤íƒ€ì¼ ì°¸ê³ <br>
                                    â€¢ êµ¬ì¡° + ë¶„ìœ„ê¸°: ë‘ ê°€ì§€ ëª¨ë‘ ì°¸ê³ 
                                </p>
                            </div>
                            
                            <button type="button" class="btn btn-secondary" onclick="clearReferenceLyrics()" style="width: 100%;">
                                <i class="fas fa-trash"></i> ì°¸ê³  ê°€ì‚¬ ì§€ìš°ê¸°
                            </button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ğŸŒ ê°€ì‚¬ ì§€ì—­ (ì„ íƒì‚¬í•­)</label>
                        <div class="tag-container" id="manualRegionTags">
                            <!-- ëŒ€ë¥™/ì§€ì—­ -->
                            <button class="tag-btn" data-value="ìœ ëŸ½">ìœ ëŸ½</button>
                            <button class="tag-btn" data-value="ì•„ì‹œì•„">ì•„ì‹œì•„</button>
                            <button class="tag-btn" data-value="ë¶ë¯¸">ë¶ë¯¸</button>
                            <button class="tag-btn" data-value="ë‚¨ë¯¸">ë‚¨ë¯¸</button>
                            <button class="tag-btn" data-value="ì•„í”„ë¦¬ì¹´">ì•„í”„ë¦¬ì¹´</button>
                            <button class="tag-btn" data-value="ì˜¤ì„¸ì•„ë‹ˆì•„">ì˜¤ì„¸ì•„ë‹ˆì•„</button>
                            
                            <!-- ì•„ì‹œì•„ êµ­ê°€ -->
                            <button class="tag-btn" data-value="í•œêµ­">í•œêµ­</button>
                            <button class="tag-btn" data-value="ì¼ë³¸">ì¼ë³¸</button>
                            <button class="tag-btn" data-value="ì¤‘êµ­">ì¤‘êµ­</button>
                            <button class="tag-btn" data-value="ëŒ€ë§Œ">ëŒ€ë§Œ</button>
                            <button class="tag-btn" data-value="í™ì½©">í™ì½©</button>
                            <button class="tag-btn" data-value="íƒœêµ­">íƒœêµ­</button>
                            <button class="tag-btn" data-value="ë² íŠ¸ë‚¨">ë² íŠ¸ë‚¨</button>
                            <button class="tag-btn" data-value="ì¸ë„ë„¤ì‹œì•„">ì¸ë„ë„¤ì‹œì•„</button>
                            <button class="tag-btn" data-value="í•„ë¦¬í•€">í•„ë¦¬í•€</button>
                            <button class="tag-btn" data-value="ì‹±ê°€í¬ë¥´">ì‹±ê°€í¬ë¥´</button>
                            <button class="tag-btn" data-value="ë§ë ˆì´ì‹œì•„">ë§ë ˆì´ì‹œì•„</button>
                            <button class="tag-btn" data-value="ì¸ë„">ì¸ë„</button>
                            
                            <!-- ìœ ëŸ½ êµ­ê°€ -->
                            <button class="tag-btn" data-value="í”„ë‘ìŠ¤">í”„ë‘ìŠ¤</button>
                            <button class="tag-btn" data-value="ì˜êµ­">ì˜êµ­</button>
                            <button class="tag-btn" data-value="ë…ì¼">ë…ì¼</button>
                            <button class="tag-btn" data-value="ì´íƒˆë¦¬ì•„">ì´íƒˆë¦¬ì•„</button>
                            <button class="tag-btn" data-value="ìŠ¤í˜ì¸">ìŠ¤í˜ì¸</button>
                            <button class="tag-btn" data-value="ë„¤ëœë€ë“œ">ë„¤ëœë€ë“œ</button>
                            <button class="tag-btn" data-value="ë²¨ê¸°ì—">ë²¨ê¸°ì—</button>
                            <button class="tag-btn" data-value="ìŠ¤ìœ„ìŠ¤">ìŠ¤ìœ„ìŠ¤</button>
                            <button class="tag-btn" data-value="ì˜¤ìŠ¤íŠ¸ë¦¬ì•„">ì˜¤ìŠ¤íŠ¸ë¦¬ì•„</button>
                            <button class="tag-btn" data-value="ê·¸ë¦¬ìŠ¤">ê·¸ë¦¬ìŠ¤</button>
                            <button class="tag-btn" data-value="í¬ë¥´íˆ¬ê°ˆ">í¬ë¥´íˆ¬ê°ˆ</button>
                            <button class="tag-btn" data-value="ìŠ¤ì›¨ë´">ìŠ¤ì›¨ë´</button>
                            <button class="tag-btn" data-value="ë…¸ë¥´ì›¨ì´">ë…¸ë¥´ì›¨ì´</button>
                            <button class="tag-btn" data-value="ë´ë§ˆí¬">ë´ë§ˆí¬</button>
                            <button class="tag-btn" data-value="í•€ë€ë“œ">í•€ë€ë“œ</button>
                            <button class="tag-btn" data-value="ëŸ¬ì‹œì•„">ëŸ¬ì‹œì•„</button>
                            <button class="tag-btn" data-value="ì²´ì½”">ì²´ì½”</button>
                            <button class="tag-btn" data-value="í´ë€ë“œ">í´ë€ë“œ</button>
                            
                            <!-- ë¶ë¯¸ êµ­ê°€ -->
                            <button class="tag-btn" data-value="ë¯¸êµ­">ë¯¸êµ­</button>
                            <button class="tag-btn" data-value="ìºë‚˜ë‹¤">ìºë‚˜ë‹¤</button>
                            <button class="tag-btn" data-value="ë©•ì‹œì½”">ë©•ì‹œì½”</button>
                            
                            <!-- í•œêµ­ ì§€ì—­ -->
                            <button class="tag-btn" data-value="ì„œìš¸">ì„œìš¸</button>
                            <button class="tag-btn" data-value="ë¶€ì‚°">ë¶€ì‚°</button>
                            <button class="tag-btn" data-value="ì¸ì²œ">ì¸ì²œ</button>
                            <button class="tag-btn" data-value="ëŒ€êµ¬">ëŒ€êµ¬</button>
                            <button class="tag-btn" data-value="ëŒ€ì „">ëŒ€ì „</button>
                            <button class="tag-btn" data-value="ê´‘ì£¼">ê´‘ì£¼</button>
                            <button class="tag-btn" data-value="ìš¸ì‚°">ìš¸ì‚°</button>
                            <button class="tag-btn" data-value="ê²½ê¸°ë„">ê²½ê¸°ë„</button>
                            <button class="tag-btn" data-value="ê°•ì›ë„">ê°•ì›ë„</button>
                            <button class="tag-btn" data-value="ì¶©ì²­ë„">ì¶©ì²­ë„</button>
                            <button class="tag-btn" data-value="ì „ë¼ë„">ì „ë¼ë„</button>
                            <button class="tag-btn" data-value="ê²½ìƒë„">ê²½ìƒë„</button>
                            <button class="tag-btn" data-value="ì œì£¼ë„">ì œì£¼ë„</button>
                            
                            <!-- ì£¼ìš” ë„ì‹œ -->
                            <button class="tag-btn" data-value="ë‰´ìš•">ë‰´ìš•</button>
                            <button class="tag-btn" data-value="ë¡œìŠ¤ì•¤ì ¤ë ˆìŠ¤">ë¡œìŠ¤ì•¤ì ¤ë ˆìŠ¤</button>
                            <button class="tag-btn" data-value="íŒŒë¦¬">íŒŒë¦¬</button>
                            <button class="tag-btn" data-value="ëŸ°ë˜">ëŸ°ë˜</button>
                            <button class="tag-btn" data-value="ë„ì¿„">ë„ì¿„</button>
                            <button class="tag-btn" data-value="ë² ì´ì§•">ë² ì´ì§•</button>
                            <button class="tag-btn" data-value="ìƒí•˜ì´">ìƒí•˜ì´</button>
                            <button class="tag-btn" data-value="ë°©ì½•">ë°©ì½•</button>
                            <button class="tag-btn" data-value="ì‹±ê°€í¬ë¥´">ì‹±ê°€í¬ë¥´</button>
                            <button class="tag-btn" data-value="í™ì½©">í™ì½©</button>
                            <button class="tag-btn" data-value="ì‹œë“œë‹ˆ">ì‹œë“œë‹ˆ</button>
                            <button class="tag-btn" data-value="ë©œë²„ë¥¸">ë©œë²„ë¥¸</button>
                            <button class="tag-btn" data-value="ë² ë¥¼ë¦°">ë² ë¥¼ë¦°</button>
                            <button class="tag-btn" data-value="ë¡œë§ˆ">ë¡œë§ˆ</button>
                            <button class="tag-btn" data-value="ë§ˆë“œë¦¬ë“œ">ë§ˆë“œë¦¬ë“œ</button>
                            <button class="tag-btn" data-value="ì•”ìŠ¤í…Œë¥´ë‹´">ì•”ìŠ¤í…Œë¥´ë‹´</button>
                            <button class="tag-btn" data-value="ë°”ë¥´ì…€ë¡œë‚˜">ë°”ë¥´ì…€ë¡œë‚˜</button>
                            <button class="tag-btn" data-value="ë¹„ì—”ë‚˜">ë¹„ì—”ë‚˜</button>
                            <button class="tag-btn" data-value="í”„ë¼í•˜">í”„ë¼í•˜</button>
                            <button class="tag-btn" data-value="ë¶€ë‹¤í˜ìŠ¤íŠ¸">ë¶€ë‹¤í˜ìŠ¤íŠ¸</button>
                            <button class="tag-btn" data-value="ë¦¬ìŠ¤ë³¸">ë¦¬ìŠ¤ë³¸</button>
                            <button class="tag-btn" data-value="ì•„í…Œë„¤">ì•„í…Œë„¤</button>
                            <button class="tag-btn" data-value="ëª¨ìŠ¤í¬ë°”">ëª¨ìŠ¤í¬ë°”</button>
                            <button class="tag-btn" data-value="ìŠ¤í†¡í™€ë¦„">ìŠ¤í†¡í™€ë¦„</button>
                            <button class="tag-btn" data-value="ì˜¤ìŠ¬ë¡œ">ì˜¤ìŠ¬ë¡œ</button>
                            <button class="tag-btn" data-value="ì½”íœí•˜ê²">ì½”íœí•˜ê²</button>
                            <button class="tag-btn" data-value="í—¬ì‹±í‚¤">í—¬ì‹±í‚¤</button>
                            <button class="tag-btn custom-tag-btn" data-container="manualRegionTags" onclick="showCustomTagInput('manualRegionTags')" style="background: var(--accent); color: white; border: 2px dashed white;">â• ê¸°íƒ€(ì¶”ê°€)</button>
                        </div>
                    </div>
                </div>

                <!-- AI Generation Mode -->
                <div class="lyrics-mode" id="aiMode">
                    <!-- AI Options -->
                    <div class="ai-options-grid">
                        <div class="form-group">
                            <label><i class="fas fa-clock"></i> ì‹œëŒ€ (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)</label>
                            <div class="tag-container" id="eraTags">
                                <!-- ê³¼ê±° ì‹œëŒ€ -->
                                <button class="tag-btn" data-value="ì›ì‹œì‹œëŒ€">ì›ì‹œì‹œëŒ€</button>
                                <button class="tag-btn" data-value="ì‚¼êµ­ì‹œëŒ€">ì‚¼êµ­ì‹œëŒ€</button>
                                <button class="tag-btn" data-value="ê³ ë ¤ì‹œëŒ€">ê³ ë ¤ì‹œëŒ€</button>
                                <button class="tag-btn" data-value="ì¡°ì„ ì‹œëŒ€">ì¡°ì„ ì‹œëŒ€</button>
                                <button class="tag-btn" data-value="ì¼ì œê°•ì ê¸°">ì¼ì œê°•ì ê¸°</button>
                                <button class="tag-btn" data-value="ì¤‘ì„¸">ì¤‘ì„¸</button>
                                <button class="tag-btn" data-value="ë¥´ë„¤ìƒìŠ¤">ë¥´ë„¤ìƒìŠ¤</button>
                                <button class="tag-btn" data-value="ë¹…í† ë¦¬ì•„ì‹œëŒ€">ë¹…í† ë¦¬ì•„ì‹œëŒ€</button>
                                <button class="tag-btn" data-value="1920ë…„ëŒ€">1920ë…„ëŒ€</button>
                                <button class="tag-btn" data-value="1930ë…„ëŒ€">1930ë…„ëŒ€</button>
                                <button class="tag-btn" data-value="1940ë…„ëŒ€">1940ë…„ëŒ€</button>
                                <button class="tag-btn" data-value="1950ë…„ëŒ€">50ë…„ëŒ€</button>
                                <button class="tag-btn" data-value="1960ë…„ëŒ€">60ë…„ëŒ€</button>
                                <button class="tag-btn" data-value="1970ë…„ëŒ€">70ë…„ëŒ€</button>
                                <button class="tag-btn" data-value="1980ë…„ëŒ€">80ë…„ëŒ€</button>
                                <button class="tag-btn" data-value="1990ë…„ëŒ€">90ë…„ëŒ€</button>
                                <button class="tag-btn" data-value="2000ë…„ëŒ€">2000ë…„ëŒ€</button>
                                <button class="tag-btn" data-value="2010ë…„ëŒ€">2010ë…„ëŒ€</button>
                                <button class="tag-btn" data-value="2020ë…„ëŒ€">2020ë…„ëŒ€</button>
                                <button class="tag-btn" data-value="í˜„ëŒ€">í˜„ëŒ€</button>
                                
                                <!-- ë¯¸ë˜ ì‹œëŒ€ -->
                                <button class="tag-btn" data-value="ê·¼ë¯¸ë˜">ê·¼ë¯¸ë˜</button>
                                <button class="tag-btn" data-value="ë¯¸ë˜">ë¯¸ë˜</button>
                                <button class="tag-btn" data-value="ë¨¼ ë¯¸ë˜">ë¨¼ ë¯¸ë˜</button>
                                
                                <!-- ë¯¸ë˜ SF ì‹œëŒ€ -->
                                <button class="tag-btn" data-value="AI ì‹œëŒ€">AI ì‹œëŒ€</button>
                                <button class="tag-btn" data-value="ë¡œë´‡ ì‹œëŒ€">ë¡œë´‡ ì‹œëŒ€</button>
                                <button class="tag-btn" data-value="ìš°ì£¼ ì‹œëŒ€">ìš°ì£¼ ì‹œëŒ€</button>
                                <button class="tag-btn" data-value="ê°€ìƒí˜„ì‹¤ ì‹œëŒ€">ê°€ìƒí˜„ì‹¤ ì‹œëŒ€</button>
                                <button class="tag-btn" data-value="VR/AR ì‹œëŒ€">VR/AR ì‹œëŒ€</button>
                                <button class="tag-btn" data-value="ë©”íƒ€ë²„ìŠ¤">ë©”íƒ€ë²„ìŠ¤</button>
                                <button class="tag-btn" data-value="ë‚˜ë…¸ ê¸°ìˆ  ì‹œëŒ€">ë‚˜ë…¸ ê¸°ìˆ  ì‹œëŒ€</button>
                                <button class="tag-btn" data-value="ìƒëª…ê³µí•™ ì‹œëŒ€">ìƒëª…ê³µí•™ ì‹œëŒ€</button>
                                <button class="tag-btn" data-value="ì–‘ì ì‹œëŒ€">ì–‘ì ì‹œëŒ€</button>
                                
                                <!-- ë¯¸ë˜ ì‚¬íšŒ ê°œë… -->
                                <button class="tag-btn" data-value="í¬ìŠ¤íŠ¸ ì•„í¬ì¹¼ë¦½ìŠ¤">í¬ìŠ¤íŠ¸ ì•„í¬ì¹¼ë¦½ìŠ¤</button>
                                <button class="tag-btn" data-value="ë””ìŠ¤í† í”¼ì•„">ë””ìŠ¤í† í”¼ì•„</button>
                                <button class="tag-btn" data-value="ìœ í† í”¼ì•„">ìœ í† í”¼ì•„</button>
                                <button class="tag-btn" data-value="í¬ìŠ¤íŠ¸ íœ´ë¨¼">í¬ìŠ¤íŠ¸ íœ´ë¨¼</button>
                                <button class="tag-btn" data-value="íŠ¸ëœìŠ¤íœ´ë¨¸ë‹ˆì¦˜">íŠ¸ëœìŠ¤íœ´ë¨¸ë‹ˆì¦˜</button>
                                <button class="tag-btn" data-value="ì‹±ê·¤ë˜ë¦¬í‹°">ì‹±ê·¤ë˜ë¦¬í‹°</button>
                                <button class="tag-btn" data-value="ê¸°í›„ ë³€í™” í›„">ê¸°í›„ ë³€í™” í›„</button>
                                <button class="tag-btn" data-value="í™˜ê²½ ì¬ìƒ ì‹œëŒ€">í™˜ê²½ ì¬ìƒ ì‹œëŒ€</button>
                                
                                <!-- ì™¸ê³„/ì°¨ì› -->
                                <button class="tag-btn" data-value="ì™¸ê³„ ë¬¸ëª…">ì™¸ê³„ ë¬¸ëª…</button>
                                <button class="tag-btn" data-value="ì²« ì ‘ì´‰">ì²« ì ‘ì´‰</button>
                                <button class="tag-btn" data-value="ì‹œê°„ ì—¬í–‰">ì‹œê°„ ì—¬í–‰</button>
                                <button class="tag-btn" data-value="í‰í–‰ ìš°ì£¼">í‰í–‰ ìš°ì£¼</button>
                                <button class="tag-btn" data-value="ë‹¤ì°¨ì›">ë‹¤ì°¨ì›</button>
                                <button class="tag-btn" data-value="ë©€í‹°ë²„ìŠ¤">ë©€í‹°ë²„ìŠ¤</button>
                                
                                <!-- íŒíƒ€ì§€/í‘í¬ -->
                                <button class="tag-btn" data-value="íŒíƒ€ì§€">íŒíƒ€ì§€</button>
                                <button class="tag-btn" data-value="ë¯¸ë˜ íŒíƒ€ì§€">ë¯¸ë˜ íŒíƒ€ì§€</button>
                                <button class="tag-btn" data-value="ìŠ¤íŒ€í‘í¬">ìŠ¤íŒ€í‘í¬</button>
                                <button class="tag-btn" data-value="ì‚¬ì´ë²„í‘í¬">ì‚¬ì´ë²„í‘í¬</button>
                                <button class="tag-btn" data-value="ë°”ì´ì˜¤í‘í¬">ë°”ì´ì˜¤í‘í¬</button>
                                <button class="tag-btn" data-value="ì†”ë¼í‘í¬">ì†”ë¼í‘í¬</button>
                                <button class="tag-btn" data-value="ë””ì ¤í‘í¬">ë””ì ¤í‘í¬</button>
                                <button class="tag-btn" data-value="ì•„í†°í‘í¬">ì•„í†°í‘í¬</button>
                                <button class="tag-btn custom-tag-btn" data-container="eraTags" onclick="showCustomTagInput('eraTags')" style="background: var(--accent); color: white; border: 2px dashed white;">â• ê¸°íƒ€(ì¶”ê°€)</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>ğŸ’• í…Œë§ˆ/ì†Œì¬ (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)</label>
                            <div class="tag-container" id="themeTags">
                                <button class="tag-btn" data-value="ì²«ì‚¬ë‘">ì²«ì‚¬ë‘</button>
                                <button class="tag-btn" data-value="ì´ë³„">ì´ë³„</button>
                                <button class="tag-btn" data-value="ì¬íšŒ">ì¬íšŒ</button>
                                <button class="tag-btn" data-value="ì§ì‚¬ë‘">ì§ì‚¬ë‘</button>
                                <button class="tag-btn" data-value="ìš°ì •">ìš°ì •</button>
                                <button class="tag-btn" data-value="ìì•„ì„±ì°°">ìì•„ì„±ì°°</button>
                                <button class="tag-btn" data-value="ê¿ˆ/í¬ë§">ê¿ˆ/í¬ë§</button>
                                <button class="tag-btn" data-value="ì„±ì¥">ì„±ì¥</button>
                                <button class="tag-btn" data-value="ì™¸ë¡œì›€">ì™¸ë¡œì›€</button>
                                <button class="tag-btn" data-value="ì¶”ì–µ">ì¶”ì–µ</button>
                                <button class="tag-btn" data-value="ì‚¬ë‘ê³ ë°±">ì‚¬ë‘ê³ ë°±</button>
                                <button class="tag-btn" data-value="ì§ˆíˆ¬">ì§ˆíˆ¬</button>
                                <button class="tag-btn" data-value="ê·¸ë¦¬ì›€">ê·¸ë¦¬ì›€</button>
                                <button class="tag-btn" data-value="í›„íšŒ">í›„íšŒ</button>
                                <button class="tag-btn" data-value="ìš©ì„œ">ìš©ì„œ</button>
                                <button class="tag-btn" data-value="ì´ë³„ í›„">ì´ë³„ í›„</button>
                                <button class="tag-btn" data-value="ì¬íšŒì˜ ê¸°ì¨">ì¬íšŒì˜ ê¸°ì¨</button>
                                <button class="tag-btn" data-value="ê°€ì¡±">ê°€ì¡±</button>
                                <button class="tag-btn" data-value="ì¹œêµ¬">ì¹œêµ¬</button>
                                <button class="tag-btn" data-value="ë™ë£Œ">ë™ë£Œ</button>
                                <button class="tag-btn" data-value="ìì‹ ê°">ìì‹ ê°</button>
                                <button class="tag-btn" data-value="ë„ì „">ë„ì „</button>
                                <button class="tag-btn" data-value="í¬ê¸°í•˜ì§€ ì•Šê¸°">í¬ê¸°í•˜ì§€ ì•Šê¸°</button>
                                <button class="tag-btn" data-value="íë§">íë§</button>
                                <button class="tag-btn" data-value="ìœ„ë¡œ">ìœ„ë¡œ</button>
                                <button class="tag-btn" data-value="ê²©ë ¤">ê²©ë ¤</button>
                                <button class="tag-btn" data-value="ìƒˆë¡œìš´ ì‹œì‘">ìƒˆë¡œìš´ ì‹œì‘</button>
                                <button class="tag-btn" data-value="ê³¼ê±°">ê³¼ê±°</button>
                                <button class="tag-btn" data-value="í˜„ì¬">í˜„ì¬</button>
                                <button class="tag-btn" data-value="ë¯¸ë˜">ë¯¸ë˜</button>
                                <button class="tag-btn" data-value="ë„ì‹œìƒí™œ">ë„ì‹œìƒí™œ</button>
                                <button class="tag-btn" data-value="ì¼ìƒ">ì¼ìƒ</button>
                                <button class="tag-btn" data-value="ì—¬í–‰">ì—¬í–‰</button>
                                <button class="tag-btn" data-value="ê³„ì ˆ">ê³„ì ˆ</button>
                                <button class="tag-btn" data-value="ë°¤">ë°¤</button>
                                <button class="tag-btn" data-value="ìƒˆë²½">ìƒˆë²½</button>
                                <button class="tag-btn" data-value="ë¹„">ë¹„</button>
                                <button class="tag-btn" data-value="ëˆˆ">ëˆˆ</button>
                                <button class="tag-btn" data-value="í•´ë³€">í•´ë³€</button>
                                <button class="tag-btn" data-value="ì‚°">ì‚°</button>
                                <button class="tag-btn" data-value="ì¹´í˜">ì¹´í˜</button>
                                <button class="tag-btn" data-value="í•™êµ">í•™êµ</button>
                                <button class="tag-btn" data-value="ì§ì¥">ì§ì¥</button>
                                <button class="tag-btn" data-value="ì§‘">ì§‘</button>
                                <button class="tag-btn" data-value="íŒŒí‹°">íŒŒí‹°</button>
                                <button class="tag-btn" data-value="ì¶•ì œ">ì¶•ì œ</button>
                                <button class="tag-btn" data-value="ê²°í˜¼">ê²°í˜¼</button>
                                <button class="tag-btn" data-value="ì´í˜¼">ì´í˜¼</button>
                                <button class="tag-btn" data-value="ìƒì‹¤">ìƒì‹¤</button>
                                <button class="tag-btn" data-value="ì¹˜ìœ ">ì¹˜ìœ </button>
                                <button class="tag-btn" data-value="ê°ì‚¬">ê°ì‚¬</button>
                                <button class="tag-btn" data-value="ì¶•í•˜">ì¶•í•˜</button>
                                <button class="tag-btn" data-value="ì‘ì›">ì‘ì›</button>
                                <button class="tag-btn" data-value="í¬ë§">í¬ë§</button>
                                <button class="tag-btn" data-value="ì ˆë§">ì ˆë§</button>
                                <button class="tag-btn" data-value="ë³µìˆ˜">ë³µìˆ˜</button>
                                <button class="tag-btn" data-value="ìš©ê¸°">ìš©ê¸°</button>
                                <button class="tag-btn" data-value="ììœ ">ììœ </button>
                                <button class="tag-btn" data-value="ë…ë¦½">ë…ë¦½</button>
                                <button class="tag-btn" data-value="ì„±ê³µ">ì„±ê³µ</button>
                                <button class="tag-btn" data-value="ì‹¤íŒ¨">ì‹¤íŒ¨</button>
                                <button class="tag-btn" data-value="ë…¸ë ¥">ë…¸ë ¥</button>
                                <button class="tag-btn" data-value="ì¸ë‚´">ì¸ë‚´</button>
                                <button class="tag-btn" data-value="ë³€í™”">ë³€í™”</button>
                                <button class="tag-btn" data-value="ì‹œê°„">ì‹œê°„</button>
                                <button class="tag-btn" data-value="ê¸°ì–µ">ê¸°ì–µ</button>
                                <button class="tag-btn" data-value="ìŠí˜€ì§">ìŠí˜€ì§</button>
                                <button class="tag-btn" data-value="ì¬ë°œê²¬">ì¬ë°œê²¬</button>
                                <button class="tag-btn" data-value="ìê¸°ê³„ë°œ">ìê¸°ê³„ë°œ</button>
                                <button class="tag-btn" data-value="ê¿ˆ">ê¿ˆ</button>
                                <button class="tag-btn" data-value="í™˜ìƒ">í™˜ìƒ</button>
                                <button class="tag-btn" data-value="í˜„ì‹¤">í˜„ì‹¤</button>
                                <button class="tag-btn" data-value="íŒíƒ€ì§€">íŒíƒ€ì§€</button>
                                <button class="tag-btn" data-value="SF">SF</button>
                                <button class="tag-btn" data-value="ë¯¸ìŠ¤í„°ë¦¬">ë¯¸ìŠ¤í„°ë¦¬</button>
                                <button class="tag-btn" data-value="ìŠ¤ë¦´">ìŠ¤ë¦´</button>
                                
                                <!-- ë¬¸í•™ ì‘í’ˆ ì˜¤ë§ˆì£¼ -->
                                <button class="tag-btn" data-value="ì†Œì„¤ ì˜¤ë§ˆì£¼">ğŸ“š ì†Œì„¤ ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="ì‹œ ì˜¤ë§ˆì£¼">ğŸ“– ì‹œ ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="ë…¸ë˜ ì˜¤ë§ˆì£¼">ğŸµ ë…¸ë˜ ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="ë¯¸ìˆ  ì˜¤ë§ˆì£¼">ğŸ¨ ë¯¸ìˆ  ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="ì˜í™” ì˜¤ë§ˆì£¼">ğŸ¬ ì˜í™” ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="ì—°ê·¹ ì˜¤ë§ˆì£¼">ğŸ­ ì—°ê·¹ ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="í´ë˜ì‹ ë¬¸í•™ ì˜¤ë§ˆì£¼">ğŸ“œ í´ë˜ì‹ ë¬¸í•™ ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="í˜„ëŒ€ ë¬¸í•™ ì˜¤ë§ˆì£¼">ğŸ“ í˜„ëŒ€ ë¬¸í•™ ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="ì‹œì  í‘œí˜„ ì˜¤ë§ˆì£¼">âœï¸ ì‹œì  í‘œí˜„ ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="ì„œì‚¬ì‹œ ì˜¤ë§ˆì£¼">ğŸ“š ì„œì‚¬ì‹œ ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="ì„œì •ì‹œ ì˜¤ë§ˆì£¼">ğŸ’­ ì„œì •ì‹œ ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="ë¯¼ìš” ì˜¤ë§ˆì£¼">ğŸ¶ ë¯¼ìš” ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="ë°œë¼ë“œ ì˜¤ë§ˆì£¼">ğŸ¤ ë°œë¼ë“œ ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="íšŒí™” ì˜¤ë§ˆì£¼">ğŸ–¼ï¸ íšŒí™” ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="ì¡°ê° ì˜¤ë§ˆì£¼">ğŸ—¿ ì¡°ê° ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="ê±´ì¶• ì˜¤ë§ˆì£¼">ğŸ›ï¸ ê±´ì¶• ì˜¤ë§ˆì£¼</button>
                                <button class="tag-btn" data-value="ë¬¸í•™ì  ìƒìƒë ¥">âœ¨ ë¬¸í•™ì  ìƒìƒë ¥</button>
                                <button class="tag-btn" data-value="ì˜ˆìˆ ì  ì˜ê°">ğŸ¨ ì˜ˆìˆ ì  ì˜ê°</button>
                                <button class="tag-btn" data-value="ë¬¸í•™ì  ë¹„ìœ ">ğŸ“– ë¬¸í•™ì  ë¹„ìœ </button>
                                <button class="tag-btn" data-value="ì‹œì  ì´ë¯¸ì§€">ğŸŒ™ ì‹œì  ì´ë¯¸ì§€</button>
                                <button class="tag-btn" data-value="ì„œì‚¬ì  ìŠ¤í† ë¦¬í…”ë§">ğŸ“– ì„œì‚¬ì  ìŠ¤í† ë¦¬í…”ë§</button>
                                <button class="tag-btn" data-value="ë¬¸í•™ì  ë©”íƒ€í¬">ğŸ’« ë¬¸í•™ì  ë©”íƒ€í¬</button>
                                
                                <button class="tag-btn custom-tag-btn" data-container="themeTags" onclick="showCustomTagInput('themeTags')" style="background: var(--accent); color: white; border: 2px dashed white;">â• ê¸°íƒ€(ì¶”ê°€)</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>ğŸ‘¤ í™”ì ì‹œì </label>
                            <div class="tag-container" id="perspectiveTags">
                                <button class="tag-btn" data-value="ë‚¨ì„± 1ì¸ì¹­">ë‚¨ì„± 1ì¸ì¹­</button>
                                <button class="tag-btn" data-value="ì—¬ì„± 1ì¸ì¹­">ì—¬ì„± 1ì¸ì¹­</button>
                                <button class="tag-btn" data-value="ë‚¨ì„± 2ì¸ì¹­">ë‚¨ì„± 2ì¸ì¹­</button>
                                <button class="tag-btn" data-value="ì—¬ì„± 2ì¸ì¹­">ì—¬ì„± 2ì¸ì¹­</button>
                                <button class="tag-btn" data-value="ë‚¨ì„± 3ì¸ì¹­">ë‚¨ì„± 3ì¸ì¹­</button>
                                <button class="tag-btn" data-value="ì—¬ì„± 3ì¸ì¹­">ì—¬ì„± 3ì¸ì¹­</button>
                                <button class="tag-btn" data-value="ì¤‘ì„±ì  1ì¸ì¹­">ì¤‘ì„±ì  1ì¸ì¹­</button>
                                <button class="tag-btn" data-value="ì¤‘ì„±ì  3ì¸ì¹­">ì¤‘ì„±ì  3ì¸ì¹­</button>
                                <button class="tag-btn" data-value="ëŒ€í™”ì²´">ëŒ€í™”ì²´</button>
                                <button class="tag-btn" data-value="ë…ë°±ì²´">ë…ë°±ì²´</button>
                                <button class="tag-btn" data-value="ì„œìˆ ì²´">ì„œìˆ ì²´</button>
                                <button class="tag-btn" data-value="í¸ì§€ì²´">í¸ì§€ì²´</button>
                                <button class="tag-btn" data-value="ì¼ê¸°ì²´">ì¼ê¸°ì²´</button>
                                <button class="tag-btn" data-value="íšŒìƒì²´">íšŒìƒì²´</button>
                                <button class="tag-btn" data-value="ì§ˆë¬¸ì²´">ì§ˆë¬¸ì²´</button>
                                <button class="tag-btn" data-value="ëª…ë ¹ì²´">ëª…ë ¹ì²´</button>
                                <button class="tag-btn" data-value="ì²­ìœ ì²´">ì²­ìœ ì²´</button>
                                <button class="tag-btn" data-value="ê°íƒ„ì²´">ê°íƒ„ì²´</button>
                                <button class="tag-btn" data-value="ë¶€íƒì²´">ë¶€íƒì²´</button>
                                <button class="tag-btn" data-value="ê³ ë°±ì²´">ê³ ë°±ì²´</button>
                                <button class="tag-btn" data-value="ê³ ë¯¼ì²´">ê³ ë¯¼ì²´</button>
                                <button class="tag-btn" data-value="ê·¸ë¦¬ì›€ì²´">ê·¸ë¦¬ì›€ì²´</button>
                                <button class="tag-btn" data-value="ìœ„ë¡œì²´">ìœ„ë¡œì²´</button>
                                <button class="tag-btn" data-value="ê²©ë ¤ì²´">ê²©ë ¤ì²´</button>
                                <button class="tag-btn" data-value="ì„¤ëª…ì²´">ì„¤ëª…ì²´</button>
                                <button class="tag-btn" data-value="ë¬˜ì‚¬ì²´">ë¬˜ì‚¬ì²´</button>
                                <button class="tag-btn" data-value="ë¹„ìœ ì²´">ë¹„ìœ ì²´</button>
                                <button class="tag-btn" data-value="ì€ìœ ì²´">ì€ìœ ì²´</button>
                                <button class="tag-btn" data-value="ì§ì„¤ì²´">ì§ì„¤ì²´</button>
                                <button class="tag-btn" data-value="ê°„ì ‘ì²´">ê°„ì ‘ì²´</button>
                                <button class="tag-btn" data-value="ì‹œì  í‘œí˜„">ì‹œì  í‘œí˜„</button>
                                <button class="tag-btn" data-value="êµ¬ì–´ì²´">êµ¬ì–´ì²´</button>
                                <button class="tag-btn" data-value="ë¬¸ì–´ì²´">ë¬¸ì–´ì²´</button>
                                <button class="tag-btn" data-value="ë°˜ë§ì²´">ë°˜ë§ì²´</button>
                                <button class="tag-btn" data-value="ì¡´ëŒ“ë§ì²´">ì¡´ëŒ“ë§ì²´</button>
                                <button class="tag-btn" data-value="ë“€ì—£ (ë‚¨ë…€)">ë“€ì—£ (ë‚¨ë…€)</button>
                                <button class="tag-btn" data-value="ë“€ì—£ (ë™ì„±)">ë“€ì—£ (ë™ì„±)</button>
                                <button class="tag-btn" data-value="í•©ì°½">í•©ì°½</button>
                                <button class="tag-btn" data-value="ëŒ€í™” (2ì¸)">ëŒ€í™” (2ì¸)</button>
                                <button class="tag-btn" data-value="ëŒ€í™” (3ì¸ ì´ìƒ)">ëŒ€í™” (3ì¸ ì´ìƒ)</button>
                                <button class="tag-btn" data-value="ë‚˜ë ˆì´ì…˜">ë‚˜ë ˆì´ì…˜</button>
                                <button class="tag-btn" data-value="ê´€ì°°ì ì‹œì ">ê´€ì°°ì ì‹œì </button>
                                <button class="tag-btn" data-value="ì „ì§€ì  ì‹œì ">ì „ì§€ì  ì‹œì </button>
                                <button class="tag-btn custom-tag-btn" data-container="perspectiveTags" onclick="showCustomTagInput('perspectiveTags')" style="background: var(--accent); color: white; border: 2px dashed white;">â• ê¸°íƒ€(ì¶”ê°€)</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>ğŸŒ™ ì‹œê°„ëŒ€ (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)</label>
                            <div class="tag-container" id="timeTags">
                                <button class="tag-btn" data-value="ìƒˆë²½">ìƒˆë²½</button>
                                <button class="tag-btn" data-value="ì•„ì¹¨">ì•„ì¹¨</button>
                                <button class="tag-btn" data-value="ì˜¤ì „">ì˜¤ì „</button>
                                <button class="tag-btn" data-value="ë‚®">ë‚®</button>
                                <button class="tag-btn" data-value="ì •ì˜¤">ì •ì˜¤</button>
                                <button class="tag-btn" data-value="ì˜¤í›„">ì˜¤í›„</button>
                                <button class="tag-btn" data-value="ì €ë…">ì €ë…</button>
                                <button class="tag-btn" data-value="ì €ë…ë…¸ì„">ì €ë…ë…¸ì„</button>
                                <button class="tag-btn" data-value="ì¼ëª°">ì¼ëª°</button>
                            <button class="tag-btn" data-value="í™©í˜¼">í™©í˜¼</button>
                            <button class="tag-btn" data-value="ìì •">ìì •</button>
                                <button class="tag-btn" data-value="ì‹¬ì•¼">ì‹¬ì•¼</button>
                                <button class="tag-btn" data-value="ë´„">ë´„</button>
                                <button class="tag-btn" data-value="ì—¬ë¦„">ì—¬ë¦„</button>
                                <button class="tag-btn" data-value="ê°€ì„">ê°€ì„</button>
                                <button class="tag-btn" data-value="ê²¨ìš¸">ê²¨ìš¸</button>
                                <button class="tag-btn" data-value="ì´ˆë´„">ì´ˆë´„</button>
                                <button class="tag-btn" data-value="ëŠ¦ë´„">ëŠ¦ë´„</button>
                                <button class="tag-btn" data-value="ì´ˆì—¬ë¦„">ì´ˆì—¬ë¦„</button>
                                <button class="tag-btn" data-value="í•œì—¬ë¦„">í•œì—¬ë¦„</button>
                                <button class="tag-btn" data-value="ì´ˆê°€ì„">ì´ˆê°€ì„</button>
                                <button class="tag-btn" data-value="ëŠ¦ê°€ì„">ëŠ¦ê°€ì„</button>
                                <button class="tag-btn" data-value="ì´ˆê²¨ìš¸">ì´ˆê²¨ìš¸</button>
                                <button class="tag-btn" data-value="í•œê²¨ìš¸">í•œê²¨ìš¸</button>
                                <button class="tag-btn" data-value="ì—°ë§">ì—°ë§</button>
                                <button class="tag-btn" data-value="ì—°ì´ˆ">ì—°ì´ˆ</button>
                                <button class="tag-btn" data-value="ìƒì¼">ìƒì¼</button>
                                <button class="tag-btn" data-value="ê¸°ë…ì¼">ê¸°ë…ì¼</button>
                                <button class="tag-btn" data-value="íœ´ì¼">íœ´ì¼</button>
                                <button class="tag-btn" data-value="í‰ì¼">í‰ì¼</button>
                                <button class="tag-btn" data-value="ì£¼ë§">ì£¼ë§</button>
                                <button class="tag-btn custom-tag-btn" data-container="timeTags" onclick="showCustomTagInput('timeTags')" style="background: var(--accent); color: white; border: 2px dashed white;">â• ê¸°íƒ€(ì¶”ê°€)</button>
                            </div>
                        </div>

                        <div class="form-group">
                            <label>âœ¨ íŠ¹ë³„ ìš”ì†Œ (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)</label>
                            <div class="tag-container" id="specialTags">
                                <button class="tag-btn" data-value="ë¹„ì˜¤ëŠ” ë‚ ">ë¹„ì˜¤ëŠ” ë‚ </button>
                                <button class="tag-btn" data-value="ì†Œë‚˜ê¸°">ì†Œë‚˜ê¸°</button>
                                <button class="tag-btn" data-value="ëˆˆì˜¤ëŠ” ë‚ ">ëˆˆì˜¤ëŠ” ë‚ </button>
                                <button class="tag-btn" data-value="ì²«ëˆˆ">ì²«ëˆˆ</button>
                                <button class="tag-btn" data-value="ë°”ëŒ">ë°”ëŒ</button>
                                <button class="tag-btn" data-value="ë¬´ì§€ê°œ">ë¬´ì§€ê°œ</button>
                                <button class="tag-btn" data-value="ë³„ì´ ë¹›ë‚˜ëŠ”">ë³„ë¹›</button>
                                <button class="tag-btn" data-value="ë³´ë¦„ë‹¬">ë³´ë¦„ë‹¬</button>
                                <button class="tag-btn" data-value="ì´ˆìŠ¹ë‹¬">ì´ˆìŠ¹ë‹¬</button>
                                <button class="tag-btn" data-value="ì¼ì¶œ">ì¼ì¶œ</button>
                                <button class="tag-btn" data-value="ì¼ëª°">ì¼ëª°</button>
                                <button class="tag-btn" data-value="í¸ì§€/ë©”ì‹œì§€">í¸ì§€</button>
                                <button class="tag-btn" data-value="ì „í™”">ì „í™”</button>
                                <button class="tag-btn" data-value="ì‚¬ì§„/ì¶”ì–µ">ì‚¬ì§„</button>
                                <button class="tag-btn" data-value="ì¼ê¸°">ì¼ê¸°</button>
                                <button class="tag-btn" data-value="ë…¸ë˜">ë…¸ë˜</button>
                                <button class="tag-btn" data-value="ìŒì•…">ìŒì•…</button>
                                <button class="tag-btn" data-value="ë¼ë””ì˜¤">ë¼ë””ì˜¤</button>
                                <button class="tag-btn" data-value="ì˜í™”">ì˜í™”</button>
                                <button class="tag-btn" data-value="ì±…">ì±…</button>
                                <button class="tag-btn" data-value="ì•½ì†">ì•½ì†</button>
                                <button class="tag-btn" data-value="ë§Œë‚¨">ë§Œë‚¨</button>
                                <button class="tag-btn" data-value="ê¸°ë‹¤ë¦¼">ê¸°ë‹¤ë¦¼</button>
                                <button class="tag-btn" data-value="ì„¤ë ˜">ì„¤ë ˜</button>
                                <button class="tag-btn" data-value="ì»¤í”¼">ì»¤í”¼</button>
                                <button class="tag-btn" data-value="ì°¨">ì°¨</button>
                                <button class="tag-btn" data-value="ìˆ ">ìˆ </button>
                                <button class="tag-btn" data-value="ì™€ì¸">ì™€ì¸</button>
                                <button class="tag-btn" data-value="ì¼€ì´í¬">ì¼€ì´í¬</button>
                                <button class="tag-btn" data-value="ì„ ë¬¼">ì„ ë¬¼</button>
                                <button class="tag-btn" data-value="ê½ƒ">ê½ƒ</button>
                                <button class="tag-btn" data-value="ì¥ë¯¸">ì¥ë¯¸</button>
                                <button class="tag-btn" data-value="ë²šê½ƒ">ë²šê½ƒ</button>
                                <button class="tag-btn" data-value="ë‹¨í’">ë‹¨í’</button>
                                <button class="tag-btn" data-value="í–¥ê¸°">í–¥ê¸°</button>
                                <button class="tag-btn" data-value="í–¥ìˆ˜">í–¥ìˆ˜</button>
                                <button class="tag-btn" data-value="ì´›ë¶ˆ">ì´›ë¶ˆ</button>
                                <button class="tag-btn" data-value="ë¶ˆê½ƒë†€ì´">ë¶ˆê½ƒë†€ì´</button>
                                <button class="tag-btn" data-value="ê±°ìš¸">ê±°ìš¸</button>
                                <button class="tag-btn" data-value="ì°½ë¬¸">ì°½ë¬¸</button>
                                <button class="tag-btn" data-value="ìš°ì‚°">ìš°ì‚°</button>
                                <button class="tag-btn" data-value="ì‹œê³„">ì‹œê³„</button>
                                <button class="tag-btn" data-value="ë°˜ì§€">ë°˜ì§€</button>
                                <button class="tag-btn" data-value="íœ´ëŒ€í°">íœ´ëŒ€í°</button>
                                <button class="tag-btn" data-value="ê³ ì–‘ì´">ê³ ì–‘ì´</button>
                                <button class="tag-btn" data-value="ê°•ì•„ì§€">ê°•ì•„ì§€</button>
                                <button class="tag-btn" data-value="í•˜ëŠ˜">í•˜ëŠ˜</button>
                                <button class="tag-btn" data-value="ë‹¬">ë‹¬</button>
                                <button class="tag-btn" data-value="ë³„">ë³„</button>
                                <button class="tag-btn" data-value="ë„ì‹œì˜ ë¶ˆë¹›">ë„ì‹œì˜ ë¶ˆë¹›</button>
                                <button class="tag-btn" data-value="ë„¤ì˜¨ì‚¬ì¸">ë„¤ì˜¨ì‚¬ì¸</button>
                                <button class="tag-btn" data-value="ì˜¥ìƒ">ì˜¥ìƒ</button>
                                <button class="tag-btn" data-value="ë² ë€ë‹¤">ë² ë€ë‹¤</button>
                                <button class="tag-btn" data-value="ê³„ë‹¨">ê³„ë‹¨</button>
                                <button class="tag-btn" data-value="ì—˜ë¦¬ë² ì´í„°">ì—˜ë¦¬ë² ì´í„°</button>
                                <button class="tag-btn" data-value="ì°¨">ì°¨</button>
                                <button class="tag-btn" data-value="ë²„ìŠ¤">ë²„ìŠ¤</button>
                                <button class="tag-btn" data-value="ì§€í•˜ì² ">ì§€í•˜ì² </button>
                                <button class="tag-btn" data-value="ê¸°ì°¨">ê¸°ì°¨</button>
                                <button class="tag-btn" data-value="ë¹„í–‰ê¸°">ë¹„í–‰ê¸°</button>
                                <button class="tag-btn" data-value="ìì „ê±°">ìì „ê±°</button>
                                <button class="tag-btn" data-value="í”¼ì•„ë…¸">í”¼ì•„ë…¸</button>
                                <button class="tag-btn" data-value="ê¸°íƒ€">ê¸°íƒ€</button>
                                <button class="tag-btn" data-value="ë°”ì´ì˜¬ë¦°">ë°”ì´ì˜¬ë¦°</button>
                                <button class="tag-btn" data-value="ë“œëŸ¼">ë“œëŸ¼</button>
                                <button class="tag-btn custom-tag-btn" data-container="specialTags" onclick="showCustomTagInput('specialTags')" style="background: var(--accent); color: white; border: 2px dashed white;">â• ê¸°íƒ€(ì¶”ê°€)</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ğŸŒ ê°€ì‚¬ ì§€ì—­ (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)</label>
                        <div class="tag-container" id="regionTags">
                            <!-- ëŒ€ë¥™/ì§€ì—­ -->
                            <button class="tag-btn" data-value="ìœ ëŸ½">ìœ ëŸ½</button>
                            <button class="tag-btn" data-value="ì•„ì‹œì•„">ì•„ì‹œì•„</button>
                            <button class="tag-btn" data-value="ë¶ë¯¸">ë¶ë¯¸</button>
                            <button class="tag-btn" data-value="ë‚¨ë¯¸">ë‚¨ë¯¸</button>
                            <button class="tag-btn" data-value="ì•„í”„ë¦¬ì¹´">ì•„í”„ë¦¬ì¹´</button>
                            <button class="tag-btn" data-value="ì˜¤ì„¸ì•„ë‹ˆì•„">ì˜¤ì„¸ì•„ë‹ˆì•„</button>
                            
                            <!-- ì•„ì‹œì•„ êµ­ê°€ -->
                            <button class="tag-btn" data-value="í•œêµ­">í•œêµ­</button>
                            <button class="tag-btn" data-value="ì¼ë³¸">ì¼ë³¸</button>
                            <button class="tag-btn" data-value="ì¤‘êµ­">ì¤‘êµ­</button>
                            <button class="tag-btn" data-value="ëŒ€ë§Œ">ëŒ€ë§Œ</button>
                            <button class="tag-btn" data-value="í™ì½©">í™ì½©</button>
                            <button class="tag-btn" data-value="íƒœêµ­">íƒœêµ­</button>
                            <button class="tag-btn" data-value="ë² íŠ¸ë‚¨">ë² íŠ¸ë‚¨</button>
                            <button class="tag-btn" data-value="ì¸ë„ë„¤ì‹œì•„">ì¸ë„ë„¤ì‹œì•„</button>
                            <button class="tag-btn" data-value="í•„ë¦¬í•€">í•„ë¦¬í•€</button>
                            <button class="tag-btn" data-value="ì‹±ê°€í¬ë¥´">ì‹±ê°€í¬ë¥´</button>
                            <button class="tag-btn" data-value="ë§ë ˆì´ì‹œì•„">ë§ë ˆì´ì‹œì•„</button>
                            <button class="tag-btn" data-value="ì¸ë„">ì¸ë„</button>
                            
                            <!-- ìœ ëŸ½ êµ­ê°€ -->
                            <button class="tag-btn" data-value="í”„ë‘ìŠ¤">í”„ë‘ìŠ¤</button>
                            <button class="tag-btn" data-value="ì˜êµ­">ì˜êµ­</button>
                            <button class="tag-btn" data-value="ë…ì¼">ë…ì¼</button>
                            <button class="tag-btn" data-value="ì´íƒˆë¦¬ì•„">ì´íƒˆë¦¬ì•„</button>
                            <button class="tag-btn" data-value="ìŠ¤í˜ì¸">ìŠ¤í˜ì¸</button>
                            <button class="tag-btn" data-value="ë„¤ëœë€ë“œ">ë„¤ëœë€ë“œ</button>
                            <button class="tag-btn" data-value="ë²¨ê¸°ì—">ë²¨ê¸°ì—</button>
                            <button class="tag-btn" data-value="ìŠ¤ìœ„ìŠ¤">ìŠ¤ìœ„ìŠ¤</button>
                            <button class="tag-btn" data-value="ì˜¤ìŠ¤íŠ¸ë¦¬ì•„">ì˜¤ìŠ¤íŠ¸ë¦¬ì•„</button>
                            <button class="tag-btn" data-value="ê·¸ë¦¬ìŠ¤">ê·¸ë¦¬ìŠ¤</button>
                            <button class="tag-btn" data-value="í¬ë¥´íˆ¬ê°ˆ">í¬ë¥´íˆ¬ê°ˆ</button>
                            <button class="tag-btn" data-value="ìŠ¤ì›¨ë´">ìŠ¤ì›¨ë´</button>
                            <button class="tag-btn" data-value="ë…¸ë¥´ì›¨ì´">ë…¸ë¥´ì›¨ì´</button>
                            <button class="tag-btn" data-value="ë´ë§ˆí¬">ë´ë§ˆí¬</button>
                            <button class="tag-btn" data-value="í•€ë€ë“œ">í•€ë€ë“œ</button>
                            <button class="tag-btn" data-value="ëŸ¬ì‹œì•„">ëŸ¬ì‹œì•„</button>
                            <button class="tag-btn" data-value="ì²´ì½”">ì²´ì½”</button>
                            <button class="tag-btn" data-value="í´ë€ë“œ">í´ë€ë“œ</button>
                            
                            <!-- ë¶ë¯¸ êµ­ê°€ -->
                            <button class="tag-btn" data-value="ë¯¸êµ­">ë¯¸êµ­</button>
                            <button class="tag-btn" data-value="ìºë‚˜ë‹¤">ìºë‚˜ë‹¤</button>
                            <button class="tag-btn" data-value="ë©•ì‹œì½”">ë©•ì‹œì½”</button>
                            
                            <!-- í•œêµ­ ì§€ì—­ -->
                            <button class="tag-btn" data-value="ì„œìš¸">ì„œìš¸</button>
                            <button class="tag-btn" data-value="ë¶€ì‚°">ë¶€ì‚°</button>
                            <button class="tag-btn" data-value="ì¸ì²œ">ì¸ì²œ</button>
                            <button class="tag-btn" data-value="ëŒ€êµ¬">ëŒ€êµ¬</button>
                            <button class="tag-btn" data-value="ëŒ€ì „">ëŒ€ì „</button>
                            <button class="tag-btn" data-value="ê´‘ì£¼">ê´‘ì£¼</button>
                            <button class="tag-btn" data-value="ìš¸ì‚°">ìš¸ì‚°</button>
                            <button class="tag-btn" data-value="ê²½ê¸°ë„">ê²½ê¸°ë„</button>
                            <button class="tag-btn" data-value="ê°•ì›ë„">ê°•ì›ë„</button>
                            <button class="tag-btn" data-value="ì¶©ì²­ë„">ì¶©ì²­ë„</button>
                            <button class="tag-btn" data-value="ì „ë¼ë„">ì „ë¼ë„</button>
                            <button class="tag-btn" data-value="ê²½ìƒë„">ê²½ìƒë„</button>
                            <button class="tag-btn" data-value="ì œì£¼ë„">ì œì£¼ë„</button>
                            
                            <!-- ì£¼ìš” ë„ì‹œ -->
                            <button class="tag-btn" data-value="ë‰´ìš•">ë‰´ìš•</button>
                            <button class="tag-btn" data-value="ë¡œìŠ¤ì•¤ì ¤ë ˆìŠ¤">ë¡œìŠ¤ì•¤ì ¤ë ˆìŠ¤</button>
                            <button class="tag-btn" data-value="íŒŒë¦¬">íŒŒë¦¬</button>
                            <button class="tag-btn" data-value="ëŸ°ë˜">ëŸ°ë˜</button>
                            <button class="tag-btn" data-value="ë„ì¿„">ë„ì¿„</button>
                            <button class="tag-btn" data-value="ë² ì´ì§•">ë² ì´ì§•</button>
                            <button class="tag-btn" data-value="ìƒí•˜ì´">ìƒí•˜ì´</button>
                            <button class="tag-btn" data-value="ë°©ì½•">ë°©ì½•</button>
                            <button class="tag-btn" data-value="ì‹±ê°€í¬ë¥´">ì‹±ê°€í¬ë¥´</button>
                            <button class="tag-btn" data-value="í™ì½©">í™ì½©</button>
                            <button class="tag-btn" data-value="ì‹œë“œë‹ˆ">ì‹œë“œë‹ˆ</button>
                            <button class="tag-btn" data-value="ë©œë²„ë¥¸">ë©œë²„ë¥¸</button>
                            <button class="tag-btn" data-value="ë² ë¥¼ë¦°">ë² ë¥¼ë¦°</button>
                            <button class="tag-btn" data-value="ë¡œë§ˆ">ë¡œë§ˆ</button>
                            <button class="tag-btn" data-value="ë§ˆë“œë¦¬ë“œ">ë§ˆë“œë¦¬ë“œ</button>
                            <button class="tag-btn" data-value="ì•”ìŠ¤í…Œë¥´ë‹´">ì•”ìŠ¤í…Œë¥´ë‹´</button>
                            <button class="tag-btn" data-value="ë°”ë¥´ì…€ë¡œë‚˜">ë°”ë¥´ì…€ë¡œë‚˜</button>
                            <button class="tag-btn" data-value="ë¹„ì—”ë‚˜">ë¹„ì—”ë‚˜</button>
                            <button class="tag-btn" data-value="í”„ë¼í•˜">í”„ë¼í•˜</button>
                            <button class="tag-btn" data-value="ë¶€ë‹¤í˜ìŠ¤íŠ¸">ë¶€ë‹¤í˜ìŠ¤íŠ¸</button>
                            <button class="tag-btn" data-value="ë¦¬ìŠ¤ë³¸">ë¦¬ìŠ¤ë³¸</button>
                            <button class="tag-btn" data-value="ì•„í…Œë„¤">ì•„í…Œë„¤</button>
                            <button class="tag-btn" data-value="ëª¨ìŠ¤í¬ë°”">ëª¨ìŠ¤í¬ë°”</button>
                            <button class="tag-btn" data-value="ìŠ¤í†¡í™€ë¦„">ìŠ¤í†¡í™€ë¦„</button>
                            <button class="tag-btn" data-value="ì˜¤ìŠ¬ë¡œ">ì˜¤ìŠ¬ë¡œ</button>
                            <button class="tag-btn" data-value="ì½”íœí•˜ê²">ì½”íœí•˜ê²</button>
                            <button class="tag-btn" data-value="í—¬ì‹±í‚¤">í—¬ì‹±í‚¤</button>
                            <button class="tag-btn custom-tag-btn" data-container="regionTags" onclick="showCustomTagInput('regionTags')" style="background: var(--accent); color: white; border: 2px dashed white;">â• ê¸°íƒ€(ì¶”ê°€)</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ğŸ“ ì¶”ê°€ í‚¤ì›Œë“œ (ì„ íƒì‚¬í•­)</label>
                        <input type="text" id="additionalKeywords" placeholder="ì˜ˆ: ì»¤í”¼í–¥, ì°½ë¬¸, ì˜¤ë˜ëœ ë…¸ë˜...">
                    </div>

                    <div class="form-group">
                        <label>ğŸ“ ê°€ì‚¬ ê¸¸ì´ (ì„ íƒì‚¬í•­)</label>
                        <div class="tag-container" id="lyricsLengthTags">
                            <button type="button" class="tag-btn length-btn" data-value="short" onclick="selectLyricsLength('short', this, event)">ì§§ê²Œ (150-200ì)</button>
                            <button type="button" class="tag-btn length-btn" data-value="normal" onclick="selectLyricsLength('normal', this, event)">ë³´í†µ (200-300ì)</button>
                            <button type="button" class="tag-btn length-btn" data-value="long" onclick="selectLyricsLength('long', this, event)">ê¸¸ê²Œ (300-450ì)</button>
                            <button type="button" class="tag-btn length-btn" data-value="very-long" onclick="selectLyricsLength('very-long', this, event)">ë§¤ìš° ê¸¸ê²Œ (450-600ì)</button>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 5px;">ğŸ’¡ ê°€ì‚¬ ê¸¸ì´ë¥¼ ì„ íƒí•˜ì§€ ì•Šìœ¼ë©´ <span style="color: var(--accent); font-weight: bold;">ì œí•œ ì—†ìŒ</span>ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ <span style="color: var(--accent);">â€¢ ì„ íƒëœ í•­ëª©ì„ ë‹¤ì‹œ í´ë¦­í•˜ë©´ í•´ì œë©ë‹ˆë‹¤</span></p>
                    </div>
                </div>

                <!-- Common: Genre & Mood Selection -->
                <div id="commonOptions">
                    <div class="form-group">
                        <label>ğŸ¸ ì¥ë¥´ ì„ íƒ (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)</label>
                        <div class="tag-container" id="genreTags">
                            <button class="tag-btn" data-value="K-Pop">K-Pop</button>
                            <button class="tag-btn" data-value="Ballad">ë°œë¼ë“œ</button>
                            <button class="tag-btn" data-value="R&B">R&B</button>
                            <button class="tag-btn" data-value="Hip-Hop">í™í•©</button>
                            <button class="tag-btn" data-value="Rock">ë¡</button>
                            <button class="tag-btn" data-value="EDM">EDM</button>
                            <button class="tag-btn" data-value="Indie">ì¸ë””</button>
                            <button class="tag-btn" data-value="Alt-Pop">Alt-Pop</button>
                            <button class="tag-btn" data-value="Pop Rock">íŒ ë½</button>
                            <button class="tag-btn" data-value="Electro Pop">ì¼ë ‰íŠ¸ë¡œíŒ</button>
                            <button class="tag-btn" data-value="Dance Pop">ëŒ„ìŠ¤íŒ</button>
                            <button class="tag-btn" data-value="Jazz">ì¬ì¦ˆ</button>
                            <button class="tag-btn" data-value="Soul">ì†Œìš¸</button>
                            <button class="tag-btn" data-value="Funk">í‘í¬</button>
                            <button class="tag-btn" data-value="Country">ì»¨íŠ¸ë¦¬</button>
                            <button class="tag-btn" data-value="Folk">í¬í¬</button>
                            <button class="tag-btn" data-value="Acoustic">ì–´ì¿ ìŠ¤í‹±</button>
                            <button class="tag-btn" data-value="Trap">íŠ¸ë©</button>
                            <button class="tag-btn" data-value="House">í•˜ìš°ìŠ¤</button>
                            <button class="tag-btn" data-value="Techno">í…Œí¬ë…¸</button>
                            <button class="tag-btn" data-value="Ambient">ì•°ë¹„ì–¸íŠ¸</button>
                            <button class="tag-btn" data-value="Lo-Fi">ë¡œíŒŒì´</button>
                            <button class="tag-btn" data-value="Synthwave">ì‹ ìŠ¤ì›¨ì´ë¸Œ</button>
                            <button class="tag-btn" data-value="City Pop">ì‹œí‹°íŒ</button>
                            <button class="tag-btn" data-value="Trot">íŠ¸ë¡œíŠ¸</button>
                            <button class="tag-btn" data-value="Ballad Rock">ë°œë¼ë“œ ë¡</button>
                            <button class="tag-btn" data-value="Emo">ì´ëª¨</button>
                            <button class="tag-btn" data-value="Punk">í‘í¬</button>
                            <button class="tag-btn" data-value="Metal">ë©”íƒˆ</button>
                            <button class="tag-btn" data-value="Reggae">ë ˆê²Œ</button>
                            <button class="tag-btn" data-value="Latin">ë¼í‹´</button>
                            <button class="tag-btn" data-value="Bossa Nova">ë³´ì‚¬ë…¸ë°”</button>
                            <button class="tag-btn" data-value="Samba">ì‚¼ë°”</button>
                            <button class="tag-btn" data-value="Salsa">ì‚´ì‚¬</button>
                            <button class="tag-btn" data-value="Blues">ë¸”ë£¨ìŠ¤</button>
                            <button class="tag-btn" data-value="Gospel">ê°€ìŠ¤í </button>
                            <button class="tag-btn" data-value="Disco">ë””ìŠ¤ì½”</button>
                            <button class="tag-btn" data-value="Swing">ìŠ¤ìœ™</button>
                            <button class="tag-btn" data-value="Bebop">ë¹„ë°¥</button>
                            <button class="tag-btn" data-value="Smooth Jazz">ìŠ¤ë¬´ìŠ¤ ì¬ì¦ˆ</button>
                            <button class="tag-btn" data-value="Fusion">í“¨ì „</button>
                            <button class="tag-btn" data-value="Progressive Rock">í”„ë¡œê·¸ë ˆì‹œë¸Œ ë¡</button>
                            <button class="tag-btn" data-value="Post Rock">í¬ìŠ¤íŠ¸ ë¡</button>
                            <button class="tag-btn" data-value="Grunge">ê·¸ëŸ°ì§€</button>
                            <button class="tag-btn" data-value="Alternative Rock">ì–¼í„°ë„ˆí‹°ë¸Œ ë¡</button>
                            <button class="tag-btn" data-value="Indie Rock">ì¸ë”” ë¡</button>
                            <button class="tag-btn" data-value="Soft Rock">ì†Œí”„íŠ¸ ë¡</button>
                            <button class="tag-btn" data-value="Hard Rock">í•˜ë“œ ë¡</button>
                            <button class="tag-btn" data-value="Heavy Metal">í—¤ë¹„ ë©”íƒˆ</button>
                            <button class="tag-btn" data-value="Death Metal">ë°ìŠ¤ ë©”íƒˆ</button>
                            <button class="tag-btn" data-value="Nu Metal">ëˆ„ ë©”íƒˆ</button>
                            <button class="tag-btn" data-value="Pop Punk">íŒ í‘í¬</button>
                            <button class="tag-btn" data-value="Emo Rock">ì´ëª¨ ë¡</button>
                            <button class="tag-btn" data-value="Screamo">ìŠ¤í¬ë¦¬ëª¨</button>
                            <button class="tag-btn" data-value="Hardcore">í•˜ë“œì½”ì–´</button>
                            <button class="tag-btn" data-value="Dubstep">ë¥ìŠ¤í…</button>
                            <button class="tag-btn" data-value="Drum and Bass">ë“œëŸ¼ ì•¤ ë² ì´ìŠ¤</button>
                            <button class="tag-btn" data-value="Trance">íŠ¸ëœìŠ¤</button>
                            <button class="tag-btn" data-value="Progressive House">í”„ë¡œê·¸ë ˆì‹œë¸Œ í•˜ìš°ìŠ¤</button>
                            <button class="tag-btn" data-value="Deep House">ë”¥ í•˜ìš°ìŠ¤</button>
                            <button class="tag-btn" data-value="Tech House">í…Œí¬ í•˜ìš°ìŠ¤</button>
                            <button class="tag-btn" data-value="Future House">í“¨ì²˜ í•˜ìš°ìŠ¤</button>
                            <button class="tag-btn" data-value="Big Room">ë¹…ë£¸</button>
                            <button class="tag-btn" data-value="Future Bass">í“¨ì²˜ ë² ì´ìŠ¤</button>
                            <button class="tag-btn" data-value="Chillstep">ì¹ ìŠ¤í…</button>
                            <button class="tag-btn" data-value="Melodic Dubstep">ë©œë¡œë”• ë¥ìŠ¤í…</button>
                            <button class="tag-btn" data-value="Drill">ë“œë¦´</button>
                            <button class="tag-btn" data-value="Cloud Rap">í´ë¼ìš°ë“œ ë©</button>
                            <button class="tag-btn" data-value="Mumble Rap">ë©ˆë¸” ë©</button>
                            <button class="tag-btn" data-value="Conscious Hip-Hop">ì»¨ì…”ìŠ¤ í™í•©</button>
                            <button class="tag-btn" data-value="Old School Hip-Hop">ì˜¬ë“œìŠ¤ì¿¨ í™í•©</button>
                            <button class="tag-btn" data-value="New Jack Swing">ë‰´ì­ìŠ¤ìœ™</button>
                            <button class="tag-btn" data-value="Neo Soul">ë„¤ì˜¤ ì†Œìš¸</button>
                            <button class="tag-btn" data-value="Contemporary R&B">ì»¨í…œí¬ëŸ¬ë¦¬ R&B</button>
                            <button class="tag-btn" data-value="Alternative R&B">ì–¼í„°ë„ˆí‹°ë¸Œ R&B</button>
                            <button class="tag-btn" data-value="Soul Pop">ì†Œìš¸ íŒ</button>
                            <button class="tag-btn" data-value="Indie Pop">ì¸ë”” íŒ</button>
                            <button class="tag-btn" data-value="Synth Pop">ì‹ ìŠ¤ íŒ</button>
                            <button class="tag-btn" data-value="Dream Pop">ë“œë¦¼ íŒ</button>
                            <button class="tag-btn" data-value="Shoegaze">ìŠˆê²Œì´ì¦ˆ</button>
                            <button class="tag-btn" data-value="Chill Pop">ì¹  íŒ</button>
                            <button class="tag-btn" data-value="Tropical House">íŠ¸ë¡œí”¼ì»¬ í•˜ìš°ìŠ¤</button>
                            <button class="tag-btn" data-value="Afrobeat">ì•„í”„ë¡œë¹„íŠ¸</button>
                            <button class="tag-btn" data-value="Reggaeton">ë ˆê²Œí†¤</button>
                            <button class="tag-btn" data-value="Kizomba">í‚¤ì¢€ë°”</button>
                            <button class="tag-btn" data-value="Flamenco">í”Œë¼ë©©ì½”</button>
                            <button class="tag-btn" data-value="Celtic">ì¼ˆí‹±</button>
                            <button class="tag-btn" data-value="Bluegrass">ë¸”ë£¨ê·¸ë˜ìŠ¤</button>
                            <button class="tag-btn" data-value="Country Pop">ì»¨íŠ¸ë¦¬ íŒ</button>
                            <button class="tag-btn" data-value="Country Rock">ì»¨íŠ¸ë¦¬ ë¡</button>
                            <button class="tag-btn" data-value="Folk Rock">í¬í¬ ë¡</button>
                            <button class="tag-btn" data-value="Indie Folk">ì¸ë”” í¬í¬</button>
                            <button class="tag-btn" data-value="Singer-Songwriter">ì‹±ì–´ì†¡ë¼ì´í„°</button>
                            <button class="tag-btn" data-value="Acoustic Pop">ì–´ì¿ ìŠ¤í‹± íŒ</button>
                            <button class="tag-btn" data-value="Unplugged">ì–¸í”ŒëŸ¬ê·¸ë“œ</button>
                            <button class="tag-btn" data-value="Classical">í´ë˜ì‹</button>
                            <button class="tag-btn" data-value="Orchestral">ì˜¤ì¼€ìŠ¤íŠ¸ë¼</button>
                            <button class="tag-btn" data-value="Cinematic">ì‹œë„¤ë§ˆí‹±</button>
                            <button class="tag-btn" data-value="Epic">ì—í”½</button>
                            <button class="tag-btn" data-value="New Age">ë‰´ì—ì´ì§€</button>
                            <button class="tag-btn" data-value="World Music">ì›”ë“œ ë®¤ì§</button>
                            <button class="tag-btn" data-value="Ethnic">ì—ìŠ¤ë‹‰</button>
                            <button class="tag-btn" data-value="Traditional">ì „í†µ</button>
                            <button class="tag-btn custom-tag-btn" data-container="genreTags" onclick="showCustomTagInput('genreTags')" style="background: var(--accent); color: white; border: 2px dashed white;">â• ê¸°íƒ€(ì¶”ê°€)</button>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ğŸ’« ë¶„ìœ„ê¸° / ê°ì • (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)</label>
                        <div class="tag-container" id="moodTags">
                            <button class="tag-btn" data-value="Emotional">ê°ì„±ì </button>
                            <button class="tag-btn" data-value="Upbeat">ì‹ ë‚˜ëŠ”</button>
                            <button class="tag-btn" data-value="Melancholic">ìš°ìš¸í•œ</button>
                            <button class="tag-btn" data-value="Romantic">ë¡œë§¨í‹±</button>
                            <button class="tag-btn" data-value="Powerful">íŒŒì›Œí’€</button>
                            <button class="tag-btn" data-value="Dreamy">ëª½í™˜ì </button>
                            <button class="tag-btn" data-value="Nostalgic">í–¥ìˆ˜ì </button>
                            <button class="tag-btn" data-value="Epic">ì„œì‚¬ì </button>
                            <button class="tag-btn" data-value="Addictive">ì¤‘ë…ì„±</button>
                            <button class="tag-btn" data-value="Comforting">ìœ„ë¡œ</button>
                            <button class="tag-btn" data-value="Happy">í–‰ë³µí•œ</button>
                            <button class="tag-btn" data-value="Sad">ìŠ¬í”ˆ</button>
                            <button class="tag-btn" data-value="Angry">ë¶„ë…¸í•œ</button>
                            <button class="tag-btn" data-value="Peaceful">í‰í™”ë¡œìš´</button>
                            <button class="tag-btn" data-value="Energetic">ì—ë„ˆì§€ ë„˜ì¹˜ëŠ”</button>
                            <button class="tag-btn" data-value="Calm">ì°¨ë¶„í•œ</button>
                            <button class="tag-btn" data-value="Intense">ê°•ë ¬í•œ</button>
                            <button class="tag-btn" data-value="Gentle">ë¶€ë“œëŸ¬ìš´</button>
                            <button class="tag-btn" data-value="Mysterious">ì‹ ë¹„ë¡œìš´</button>
                            <button class="tag-btn" data-value="Dark">ì–´ë‘ìš´</button>
                            <button class="tag-btn" data-value="Bright">ë°ì€</button>
                            <button class="tag-btn" data-value="Warm">ë”°ëœ»í•œ</button>
                            <button class="tag-btn" data-value="Cool">ì‹œì›í•œ</button>
                            <button class="tag-btn" data-value="Passionate">ì—´ì •ì ì¸</button>
                            <button class="tag-btn" data-value="Tender">ì• ì • ì–´ë¦°</button>
                            <button class="tag-btn" data-value="Bittersweet">ë‹¬ì½¤ìŒ‰ìŒ€í•œ</button>
                            <button class="tag-btn" data-value="Hopeful">í¬ë§ì ì¸</button>
                            <button class="tag-btn" data-value="Desperate">ì ˆë§ì ì¸</button>
                            <button class="tag-btn" data-value="Triumphant">ìŠ¹ë¦¬ê°</button>
                            <button class="tag-btn" data-value="Defeated">íŒ¨ë°°ê°</button>
                            <button class="tag-btn" data-value="Confident">ìì‹ ê° ìˆëŠ”</button>
                            <button class="tag-btn" data-value="Vulnerable">ì—°ì•½í•œ</button>
                            <button class="tag-btn" data-value="Rebellious">ë°˜í•­ì ì¸</button>
                            <button class="tag-btn" data-value="Obedient">ìˆœì¢…ì ì¸</button>
                            <button class="tag-btn" data-value="Playful">ì¥ë‚œìŠ¤ëŸ¬ìš´</button>
                            <button class="tag-btn" data-value="Serious">ì§„ì§€í•œ</button>
                            <button class="tag-btn" data-value="Funny">ì¬ë¯¸ìˆëŠ”</button>
                            <button class="tag-btn" data-value="Dramatic">ë“œë¼ë§ˆí‹±í•œ</button>
                            <button class="tag-btn" data-value="Minimal">ë¯¸ë‹ˆë©€í•œ</button>
                            <button class="tag-btn" data-value="Complex">ë³µì¡í•œ</button>
                            <button class="tag-btn" data-value="Simple">ë‹¨ìˆœí•œ</button>
                            <button class="tag-btn" data-value="Luxurious">ê³ ê¸‰ìŠ¤ëŸ¬ìš´</button>
                            <button class="tag-btn" data-value="Humble">ê²¸ì†í•œ</button>
                            <button class="tag-btn" data-value="Elegant">ìš°ì•„í•œ</button>
                            <button class="tag-btn" data-value="Rough">ê±°ì¹œ</button>
                            <button class="tag-btn" data-value="Smooth">ë¶€ë“œëŸ¬ìš´</button>
                            <button class="tag-btn" data-value="Polished">ì„¸ë ¨ëœ</button>
                            <button class="tag-btn" data-value="Wild">ì•¼ìƒì ì¸</button>
                            <button class="tag-btn" data-value="Tamed">ê¸¸ë“¤ì—¬ì§„</button>
                            <button class="tag-btn" data-value="Free">ììœ ë¡œìš´</button>
                            <button class="tag-btn" data-value="Trapped">ê°‡íŒ</button>
                            <button class="tag-btn" data-value="Liberating">í•´ë°©ê°</button>
                            <button class="tag-btn" data-value="Restrained">ì–µì œëœ</button>
                            <button class="tag-btn" data-value="Explosive">í­ë°œì ì¸</button>
                            <button class="tag-btn" data-value="Expansive">í™•ì¥ì ì¸</button>
                            <button class="tag-btn" data-value="Intimate">ì¹œë°€í•œ</button>
                            <button class="tag-btn" data-value="Distant">ê±°ë¦¬ê° ìˆëŠ”</button>
                            <button class="tag-btn" data-value="Close">ê°€ê¹Œìš´</button>
                            <button class="tag-btn" data-value="Far">ë¨¼</button>
                            <button class="tag-btn" data-value="Timeless">ì‹œëŒ€ë¥¼ ì´ˆì›”í•œ</button>
                            <button class="tag-btn" data-value="Modern">í˜„ëŒ€ì ì¸</button>
                            <button class="tag-btn" data-value="Classic">í´ë˜ì‹í•œ</button>
                            <button class="tag-btn" data-value="Futuristic">ë¯¸ë˜ì ì¸</button>
                            <button class="tag-btn" data-value="Retro">ë ˆíŠ¸ë¡œ</button>
                            <button class="tag-btn" data-value="Vintage">ë¹ˆí‹°ì§€</button>
                            <button class="tag-btn" data-value="Contemporary">ë™ì‹œëŒ€ì˜</button>
                            <button class="tag-btn custom-tag-btn" data-container="moodTags" onclick="showCustomTagInput('moodTags')" style="background: var(--accent); color: white; border: 2px dashed white;">â• ê¸°íƒ€(ì¶”ê°€)</button>
                        </div>
                    </div>

                    <!-- AI ê°€ì‚¬ ìƒì„± ë²„íŠ¼ -->
                    <div class="btn-group" style="margin-top: 25px;">
                        <button class="btn btn-primary" onclick="if(typeof window.generateAILyrics === 'function') { window.generateAILyrics(); } else { alert('âš ï¸ AI ê°€ì‚¬ ìƒì„± ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }" style="width: 100%; padding: 12px; font-size: 1rem;">
                            <i class="fas fa-robot"></i> AIë¡œ 4ê°œ ê°€ì‚¬ ìƒì„±í•˜ê¸°
                        </button>
                    </div>

                    <!-- AI Generated Results -->
                    <div id="aiGeneratedResults" style="display: none; margin-top: 25px;">
                        <div class="loading" id="aiLyricsLoading">
                            <div class="spinner"></div>
                            <p class="loading-text">ğŸ’¬ ChatGPTê°€ ê°€ì‚¬ë¥¼ ì°½ì‘ ì¤‘...</p>
                            <p class="loading-subtext">ChatGPTê°€ ì°½ì˜ì ì´ê³  ê°ì„±ì ì¸ ê°€ì‚¬ë¥¼ ìƒì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤</p>
                        </div>

                        <div id="aiLyricsOptions" style="display: none;">
                            <h4 style="margin: 20px 0 15px; color: var(--text-primary);">ğŸµ ìƒì„±ëœ ê°€ì‚¬ ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì„¸ìš”</h4>
                            <div class="lyrics-options-grid" id="lyricsOptionsGrid"></div>
                            
                            <div id="selectedLyricsEdit" style="display: none; margin-top: 20px;">
                                <h4 style="margin-bottom: 15px; color: var(--accent);">âœï¸ ì„ íƒí•œ ê°€ì‚¬ ìˆ˜ì •</h4>
                                
                                <!-- ìˆ˜ë…¸ ì§€ì‹œì–´ ë©”ë‰´ -->
                                <div class="suno-tags" id="step1SunoTags" style="margin-bottom: 20px; padding: 15px; background: var(--bg-card); border-radius: 8px; border: 1px solid var(--border);">
                                    <div class="suno-tags-title" style="margin-bottom: 10px; font-weight: 600; color: var(--accent);">ğŸ·ï¸ ìˆ˜ë…¸ ì§€ì‹œì–´ (í´ë¦­í•˜ì—¬ ì¶”ê°€)</div>
                                    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Intro]')" title="ì¸íŠ¸ë¡œ ì„¹ì…˜">[Intro]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Verse]')" title="ë²ŒìŠ¤ ì„¹ì…˜">[Verse]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Verse 1]')" title="ë²ŒìŠ¤ 1">[Verse 1]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Verse 2]')" title="ë²ŒìŠ¤ 2">[Verse 2]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Pre-Chorus]')" title="í”„ë¦¬ ì½”ëŸ¬ìŠ¤">[Pre-Chorus]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Chorus]')" title="ì½”ëŸ¬ìŠ¤ ì„¹ì…˜">[Chorus]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Bridge]')" title="ë¸Œë¦¿ì§€ ì„¹ì…˜">[Bridge]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Outro]')" title="ì•„ì›ƒíŠ¸ë¡œ ì„¹ì…˜">[Outro]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Instrumental]')" title="ì¸ìŠ¤íŠ¸ë£¨ë©˜íƒˆ">[Instrumental]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Tempo: 70 BPM]')" title="í…œí¬">[Tempo]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Vocal: soft]')" title="ë³´ì»¬ ìŠ¤íƒ€ì¼">[Vocal]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Instruments: piano]')" title="ì•…ê¸°">[Instruments]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Mod: emotional]')" title="ëª¨ë“œ/ë¶„ìœ„ê¸°">[Mod]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Breath: soft whisper]')" title="í˜¸í¡">[Breath]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Reverb: wide stereo]')" title="ë¦¬ë²„ë¸Œ">[Reverb]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Fade Out]')" title="í˜ì´ë“œ ì•„ì›ƒ">[Fade Out]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Fade In]')" title="í˜ì´ë“œ ì¸">[Fade In]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Volume: crescendo]')" title="ë³¼ë¥¨">[Volume]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Dynamics: soft]')" title="ë‹¤ì´ë‚˜ë¯¹ìŠ¤">[Dynamics]</span>
                                        <span class="suno-tag" onclick="insertDirectiveToLyrics('[Sound Effect: echo]')" title="ì‚¬ìš´ë“œ ì´í™íŠ¸">[Sound Effect]</span>
                                    </div>
                                    <div style="margin-top: 10px; padding: 10px; background: var(--bg-input); border-radius: 6px; font-size: 0.85rem; color: var(--text-secondary);">
                                        ğŸ’¡ <strong>ì‚¬ìš© ë°©ë²•:</strong> ì»¤ì„œë¥¼ ì›í•˜ëŠ” ìœ„ì¹˜ì— ë‘ê³  ì§€ì‹œì–´ë¥¼ í´ë¦­í•˜ë©´ í•´ë‹¹ ìœ„ì¹˜ì— ì¶”ê°€ë©ë‹ˆë‹¤.<br>
                                        ğŸ’¡ <strong>íŒ:</strong> ê° ì„¹ì…˜([Verse], [Chorus] ë“±) ì‹œì‘ ë¶€ë¶„ì— ì§€ì‹œì–´ë¥¼ ì¶”ê°€í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤.
                                    </div>
                                </div>
                                
                                <div class="form-group">
                                    <label>ì œëª©</label>
                                    <input type="text" id="editedTitle">
                                </div>
                                <div class="form-group">
                                    <label>ê°€ì‚¬ (ì§€ì‹œì–´ í¬í•¨)</label>
                                    <textarea id="editedLyrics" style="min-height: 300px; font-family: 'Consolas', 'Monaco', monospace; font-size: 0.9rem;"></textarea>
                                    <div style="margin-top: 5px; font-size: 0.8rem; color: var(--text-secondary);">
                                        ğŸ’¡ ì§€ì‹œì–´ëŠ” ê° ì¤„ì— í•˜ë‚˜ì”© ì…ë ¥í•˜ì„¸ìš”. ì˜ˆ: <code>[Tempo: 72 BPM]</code>
                                    </div>
                                </div>
                                <div class="btn-group">
                                    <button class="btn btn-secondary" onclick="backToOptions()">â† ë‹¤ì‹œ ì„ íƒ</button>
                                    <button class="btn btn-success" onclick="confirmSelectedLyrics()">âœ… ì´ ê°€ì‚¬ë¡œ í™•ì •</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="btn-group" style="justify-content: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border);">
                <button class="btn btn-primary" onclick="if(typeof window.goToNextStep === 'function') { window.goToNextStep(); } else { alert('âš ï¸ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì´ë™ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }" style="min-width: 200px;">
                    <i class="fas fa-arrow-right"></i> ë‹¤ìŒ ë‹¨ê³„ë¡œ
                </button>
            </div>
            <div class="step-footer">
                <p>ğŸµ Music Creator - AI ê°€ì‚¬ & ìˆ˜ë…¸ í”„ë¡¬í”„íŠ¸ & ë§ˆì¼€íŒ… ìë£Œ ìƒì„±ê¸°</p>
                <p>Powered by Google Gemini AI & ChatGPT âœ¨ | ë®¤ì§ëª¨ë¦¬ ì±„ë„</p>
            </div>
        </div>

        <!-- Panel 2: ìˆ˜ë…¸ ë³€í™˜ -->
        <div class="panel" id="panel2">
            <div class="two-column step2-layout">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">ğŸ¼</div>
                        <div>
                            <h2 class="card-title">ìˆ˜ë…¸ AI ê°€ì‚¬ ë³€í™˜ <span class="ai-badge">ğŸ’¬ ChatGPT</span></h2>
                            <p class="card-subtitle">AIê°€ ì§€ì¹¨ì„œ ê¸°ì¤€ìœ¼ë¡œ êµ¬ì¡° íƒœê·¸ì™€ ì§€ì‹œì–´ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤</p>
                        </div>
                        <button class="btn btn-small btn-save-step" onclick="saveCurrentProject(); showCopyIndicator('âœ… 2ë‹¨ê³„: ìˆ˜ë…¸ ë³€í™˜ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');" title="ì´ ë‹¨ê³„ ì €ì¥">
                            <i class="fas fa-save"></i> ì €ì¥
                        </button>
                    </div>

                    <!-- prettier-ignore -->
                    <div class="form-group">
                        <label style="display: flex; justify-content: space-between; align-items: center;">
                            <span>ğŸ“ ì œëª©</span>
                            <button class="btn btn-small btn-secondary" onclick="copyToClipboard('sunoTitle', 'ì œëª©', event)" title="ì œëª© ë³µì‚¬"><i class="fas fa-copy"></i> ë³µì‚¬</button>
                        </label>
                        <input type="text" id="sunoTitle" placeholder="ë…¸ë˜ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”" style="width: 100%;">
                    </div>


                    <div class="form-group lyrics-textarea-group">
                        <label style="display: flex; justify-content: space-between; align-items: center;">
                            <span>ìˆ˜ë…¸ìš© ê°€ì‚¬ (í¸ì§‘ ê°€ëŠ¥)</span>
                            <div style="display: flex; gap: 5px;">
                                <button class="btn btn-small btn-secondary" onclick="saveSunoLyricsHistory()" title="ì´ë ¥ì— ì €ì¥"><i class="fas fa-save"></i> ì €ì¥</button>
                                <button class="btn btn-small btn-secondary" onclick="copyToClipboard('sunoLyrics', 'ìˆ˜ë…¸ ê°€ì‚¬', event)" title="ê°€ì‚¬ ë³µì‚¬"><i class="fas fa-copy"></i> ë³µì‚¬</button>
                            </div>
                        </label>
                        <textarea id="sunoLyrics" class="step2-lyrics-textarea" style="min-height: 120px; overflow-y: auto; resize: none;" oninput="if(typeof window.autoResizeTextarea==='function')window.autoResizeTextarea(this);"></textarea>
                        
                        <!-- ìˆ˜ë…¸ ê°€ì‚¬ ì´ë ¥ -->
                        <div id="sunoLyricsHistorySection" style="margin-top: 15px; display: none;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <span style="font-weight: 600; color: var(--primary);"><i class="fas fa-history"></i> ìˆ˜ë…¸ ê°€ì‚¬ ì´ë ¥</span>
                                <button class="btn btn-small btn-danger" onclick="clearSunoLyricsHistory()" style="font-size: 0.75rem;"><i class="fas fa-trash"></i> ì „ì²´ ì‚­ì œ</button>
                            </div>
                            <div id="sunoLyricsHistoryList" style="max-height: 200px; overflow-y: auto; background: var(--bg-input); border-radius: 8px; padding: 10px;"></div>
                        </div>
                    </div>

                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">ğŸ¨</div>
                        <div>
                            <h2 class="card-title">ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ <span class="ai-badge">ğŸ’¬ ChatGPT</span></h2>
                            <p class="card-subtitle">ìˆ˜ë…¸ AI ìŠ¤íƒ€ì¼ë€ì— ì…ë ¥í•  í”„ë¡¬í”„íŠ¸ (1,000ì ì´ë‚´)</p>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>ğŸ”Š ìŒí–¥ ì„¤ì • (ë‹¨ì¼ ì„ íƒ)</label>
                        <div class="tag-container" id="audioFormatTags">
                            <button class="tag-btn" data-value="Stereo">ìŠ¤í…Œë ˆì˜¤</button>
                            <button class="tag-btn active" data-value="Wide Stereo">ì™€ì´ë“œ ìŠ¤í…Œë ˆì˜¤</button>
                            <button class="tag-btn" data-value="Mono">ëª¨ë…¸</button>
                            <button class="tag-btn" data-value="Surround">ì„œë¼ìš´ë“œ</button>
                            <button class="tag-btn" data-value="Binaural">ë°”ì´ë…¸ëŸ´</button>
                            <button class="tag-btn" data-value="3D Audio">3D ì˜¤ë””ì˜¤</button>
                            <button class="tag-btn" data-value="Spatial Audio">ê³µê°„ ì˜¤ë””ì˜¤</button>
                            <button class="tag-btn" data-value="Immersive">ëª°ì…í˜•</button>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 5px;">ìŒí–¥ í¬ë§· ì„¤ì • (ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ì— ë°˜ì˜ë¨)</p>
                    </div>

                    <div class="form-group">
                        <label>ğŸµ ì—°ì£¼ ì¥ì†Œ (ìŒí–¥ ë°˜ì˜, ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)</label>
                        <div class="tag-container" id="sunoVenueTags">
                            <button class="tag-btn" data-value="ì‹¤ì™¸">ì‹¤ì™¸</button>
                            <button class="tag-btn" data-value="ì•¼ì™¸">ì•¼ì™¸</button>
                            <button class="tag-btn" data-value="ê³µì›">ê³µì›</button>
                            <button class="tag-btn" data-value="í•´ë³€">í•´ë³€</button>
                            <button class="tag-btn" data-value="ì‚°">ì‚°</button>
                            <button class="tag-btn" data-value="ì‹¤ë‚´">ì‹¤ë‚´</button>
                            <button class="tag-btn" data-value="ìŠ¤íŠœë””ì˜¤">ìŠ¤íŠœë””ì˜¤</button>
                            <button class="tag-btn" data-value="í™ˆ ìŠ¤íŠœë””ì˜¤">í™ˆ ìŠ¤íŠœë””ì˜¤</button>
                            <button class="tag-btn" data-value="ê³µì—°ì¥">ê³µì—°ì¥</button>
                            <button class="tag-btn" data-value="ì½˜ì„œíŠ¸í™€">ì½˜ì„œíŠ¸í™€</button>
                            <button class="tag-btn" data-value="ë¼ì´ë¸Œ í•˜ìš°ìŠ¤">ë¼ì´ë¸Œ í•˜ìš°ìŠ¤</button>
                            <button class="tag-btn" data-value="í´ëŸ½">í´ëŸ½</button>
                            <button class="tag-btn" data-value="êµíšŒ">êµíšŒ</button>
                            <button class="tag-btn" data-value="ì„±ë‹¹">ì„±ë‹¹</button>
                            <button class="tag-btn" data-value="ê·¹ì¥">ê·¹ì¥</button>
                            <button class="tag-btn" data-value="ì˜¤í”ˆ ì—ì–´">ì˜¤í”ˆ ì—ì–´</button>
                            <button class="tag-btn" data-value="ì•¼ì™¸ ë¬´ëŒ€">ì•¼ì™¸ ë¬´ëŒ€</button>
                            <button class="tag-btn" data-value="ì•„ë ˆë‚˜">ì•„ë ˆë‚˜</button>
                            <button class="tag-btn" data-value="ìŠ¤íƒ€ë””ì›€">ìŠ¤íƒ€ë””ì›€</button>
                            <button class="tag-btn" data-value="ì¹´í˜">ì¹´í˜</button>
                            <button class="tag-btn" data-value="ë°”">ë°”</button>
                            <button class="tag-btn" data-value="ë ˆìŠ¤í† ë‘">ë ˆìŠ¤í† ë‘</button>
                            <button class="tag-btn" data-value="ê±°ë¦¬">ê±°ë¦¬</button>
                            <button class="tag-btn" data-value="ì§€í•˜ì² ">ì§€í•˜ì² </button>
                            <button class="tag-btn" data-value="ì§€í•˜ë„">ì§€í•˜ë„</button>
                            <button class="tag-btn custom-tag-btn" data-container="sunoVenueTags" onclick="showCustomTagInput('sunoVenueTags')" style="background: var(--accent); color: white; border: 2px dashed white;">â• ê¸°íƒ€(ì¶”ê°€)</button>
                        </div>
                        <p style="color: var(--text-secondary); font-size: 0.75rem; margin-top: 5px;">ê°€ì‚¬ ì‘ì„± ë‹¨ê³„ì—ì„œ ì„ íƒí•œ ì—°ì£¼ ì¥ì†Œê°€ ìë™ìœ¼ë¡œ ë°˜ì˜ë©ë‹ˆë‹¤ (ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ì— ë°˜ì˜ë¨)</p>
                    </div>

                    <div class="form-group">
                        <label>ë³´ì»¬ ìŠ¤íƒ€ì¼ (ë³µìˆ˜ ì„ íƒ ê°€ëŠ¥)</label>
                        <div class="tag-container" id="vocalStyle">
                            <button class="tag-btn" data-value="Female Vocal, emotional, comforting tone">ğŸ‘© ì—¬ì„± (ê°ì„±)</button>
                            <button class="tag-btn" data-value="Female Vocal, high range, airy tone">ğŸ‘©â€ğŸ¤ ì—¬ì„± (ê³ ìŒ)</button>
                            <button class="tag-btn" data-value="Female Vocal, soft whisper, intimate">ğŸ‘©â€ğŸ¦° ì—¬ì„± (ì†ì‚­ì„)</button>
                            <button class="tag-btn" data-value="Female Vocal, powerful belt, dramatic">ğŸ‘©â€ğŸ’¼ ì—¬ì„± (íŒŒì›Œí’€)</button>
                            <button class="tag-btn" data-value="Male Vocal, low husky, powerful high notes">ğŸ‘¨ ë‚¨ì„± (ì €ìŒ)</button>
                            <button class="tag-btn" data-value="Male Vocal, mid-range, warm tone">ğŸ‘¨â€ğŸ¤ ë‚¨ì„± (ì¤‘ìŒ)</button>
                            <button class="tag-btn" data-value="Male Vocal, high range, falsetto">ğŸ‘¨â€ğŸ¨ ë‚¨ì„± (ê³ ìŒ)</button>
                            <button class="tag-btn" data-value="Male Vocal, raspy, rock style">ğŸ¸ ë‚¨ì„± (ë½)</button>
                            <button class="tag-btn" data-value="Duet, male and female harmony">ğŸ‘« ë“€ì—£ (í•˜ëª¨ë‹ˆ)</button>
                            <button class="tag-btn" data-value="Duet, male and female call and response">ğŸ’‘ ë“€ì—£ (ì½œì•¤ë¦¬ìŠ¤í°ìŠ¤)</button>
                            <button class="tag-btn" data-value="Duet, male and female alternating verses">ğŸ¤ ë“€ì—£ (êµëŒ€)</button>
                            <button class="tag-btn" data-value="Harmony, layered vocals, background vocals">ğŸµ í•˜ëª¨ë‹ˆ (ë ˆì´ì–´ë“œ)</button>
                            <button class="tag-btn" data-value="Choir, multiple voices, rich texture">ğŸ‘¥ ì½”ëŸ¬ìŠ¤ (í•©ì°½)</button>
                            <button class="tag-btn" data-value="Rap, spoken word, rhythmic">ğŸ¤ ë©/ìŠ¤í¬í°</button>
                            <button class="tag-btn" data-value="Whisper, breathy, intimate">ğŸ’¨ ì†ì‚­ì„ (ë¸Œë¦¬ì‹œ)</button>
                            <button class="tag-btn custom-tag-btn" data-container="vocalStyle" onclick="showCustomTagInput('vocalStyle')" style="background: var(--accent); color: white; border: 2px dashed white;">â• ê¸°íƒ€(ì¶”ê°€)</button>
                        </div>
                        <div style="margin-top: 10px; font-size: 0.85rem; color: var(--text-secondary);">
                            ğŸ’¡ ì—¬ëŸ¬ ë³´ì»¬ ìŠ¤íƒ€ì¼ì„ ì„ íƒí•˜ë©´ ë“€ì—£ì´ë‚˜ í•˜ëª¨ë‹ˆë¡œ ìƒì„±ë©ë‹ˆë‹¤.
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label>íŒŒíŠ¸ë³„ ë³´ì»¬ ìŠ¤íƒ€ì¼ ì§€ì • (ì„ íƒì‚¬í•­)</label>
                        <div class="vocal-part-assignment" style="background: var(--card-bg); padding: 15px; border-radius: 8px; margin-top: 10px;">
                            <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 10px; margin-bottom: 10px;">
                                <select id="vocalPartSelect" class="form-control" style="width: 100%;">
                                    <option value="">íŒŒíŠ¸ ì„ íƒ...</option>
                                    <option value="Intro">Intro</option>
                                    <option value="Verse 1">Verse 1</option>
                                    <option value="Verse 2">Verse 2</option>
                                    <option value="Pre-Chorus">Pre-Chorus</option>
                                    <option value="Chorus">Chorus</option>
                                    <option value="Bridge">Bridge</option>
                                    <option value="Outro">Outro</option>
                                </select>
                                <select id="vocalStyleSelect" class="form-control" style="width: 100%;">
                                    <option value="">ë³´ì»¬ ìŠ¤íƒ€ì¼ ì„ íƒ...</option>
                                    <option value="Female Vocal, emotional, comforting tone">ğŸ‘© ì—¬ì„± (ê°ì„±)</option>
                                    <option value="Female Vocal, high range, airy tone">ğŸ‘©â€ğŸ¤ ì—¬ì„± (ê³ ìŒ)</option>
                                    <option value="Female Vocal, soft whisper, intimate">ğŸ‘©â€ğŸ¦° ì—¬ì„± (ì†ì‚­ì„)</option>
                                    <option value="Female Vocal, powerful belt, dramatic">ğŸ‘©â€ğŸ’¼ ì—¬ì„± (íŒŒì›Œí’€)</option>
                                    <option value="Male Vocal, low husky, powerful high notes">ğŸ‘¨ ë‚¨ì„± (ì €ìŒ)</option>
                                    <option value="Male Vocal, mid-range, warm tone">ğŸ‘¨â€ğŸ¤ ë‚¨ì„± (ì¤‘ìŒ)</option>
                                    <option value="Male Vocal, high range, falsetto">ğŸ‘¨â€ğŸ¨ ë‚¨ì„± (ê³ ìŒ)</option>
                                    <option value="Male Vocal, raspy, rock style">ğŸ¸ ë‚¨ì„± (ë½)</option>
                                    <option value="Duet, male and female harmony">ğŸ‘« ë“€ì—£ (í•˜ëª¨ë‹ˆ)</option>
                                    <option value="Duet, male and female call and response">ğŸ’‘ ë“€ì—£ (ì½œì•¤ë¦¬ìŠ¤í°ìŠ¤)</option>
                                    <option value="Duet, male and female alternating verses">ğŸ¤ ë“€ì—£ (êµëŒ€)</option>
                                    <option value="Harmony, layered vocals, background vocals">ğŸµ í•˜ëª¨ë‹ˆ (ë ˆì´ì–´ë“œ)</option>
                                    <option value="Choir, multiple voices, rich texture">ğŸ‘¥ ì½”ëŸ¬ìŠ¤ (í•©ì°½)</option>
                                    <option value="Rap, spoken word, rhythmic">ğŸ¤ ë©/ìŠ¤í¬í°</option>
                                    <option value="Whisper, breathy, intimate">ğŸ’¨ ì†ì‚­ì„ (ë¸Œë¦¬ì‹œ)</option>
                                    <option value="__CUSTOM__">â• ê¸°íƒ€(ì¶”ê°€)</option>
                                </select>
                            </div>
                            <div id="customVocalStyleInput" style="display: none; margin-top: 10px;">
                                <input type="text" id="customVocalStyleText" placeholder="ë³´ì»¬ ìŠ¤íƒ€ì¼ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: Female Vocal, soft, dreamy)" style="width: 100%; padding: 8px; border: 1px solid var(--border); border-radius: 6px; margin-bottom: 5px;">
                                <button class="btn btn-small btn-primary" onclick="addCustomVocalStyle()" style="width: 100%;">ì¶”ê°€</button>
                            </div>
                            <button class="btn btn-small btn-primary" onclick="assignVocalToPart()" style="width: 100%;">â• íŒŒíŠ¸ì— ë³´ì»¬ ìŠ¤íƒ€ì¼ ì§€ì •</button>
                            <div id="vocalPartAssignments" style="margin-top: 10px; max-height: 150px; overflow-y: auto;">
                                <!-- ì§€ì •ëœ ë³´ì»¬ ìŠ¤íƒ€ì¼ì´ ì—¬ê¸°ì— í‘œì‹œë¨ -->
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-tachometer-alt"></i> í…œí¬ (BPM)</label>
                        <div class="tempo-slider-container">
                            <div class="tempo-slider-wrapper">
                                <input type="range" id="tempoSlider" min="40" max="200" value="80" step="1" class="tempo-slider">
                                <div class="tempo-display">
                                    <span id="tempoValue">80</span> BPM
                                </div>
                            </div>
                            <div class="tempo-presets">
                                <button type="button" class="tempo-preset-btn" data-tempo="60">ğŸŒ ë§¤ìš° ëŠë¦¼ (60)</button>
                                <button type="button" class="tempo-preset-btn" data-tempo="70">ğŸ¢ ëŠë¦¼ (70)</button>
                                <button type="button" class="tempo-preset-btn" data-tempo="90">ğŸš¶ ë³´í†µ (90)</button>
                                <button type="button" class="tempo-preset-btn" data-tempo="120">ğŸƒ ë¹ ë¦„ (120)</button>
                                <button type="button" class="tempo-preset-btn" data-tempo="140">âš¡ ë§¤ìš° ë¹ ë¦„ (140)</button>
                                <button type="button" class="tempo-preset-btn" data-tempo="160">ğŸš€ ì´ˆê³ ì† (160)</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-guitar"></i> ì•…ê¸° êµ¬ì„± (ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)</label>
                        <div class="instrument-scroll-container">
                            <div class="tag-container" id="instrumentTags">
                            <!-- ê±´ë°˜ ì•…ê¸° -->
                            <button class="tag-btn" data-value="Piano">í”¼ì•„ë…¸</button>
                            <button class="tag-btn" data-value="Grand Piano">ê·¸ëœë“œ í”¼ì•„ë…¸</button>
                            <button class="tag-btn" data-value="Electric Piano">ì¼ë ‰íŠ¸ë¦­ í”¼ì•„ë…¸</button>
                            <button class="tag-btn" data-value="Rhodes">ë¡œì¦ˆ</button>
                            <button class="tag-btn" data-value="Organ">ì˜¤ë¥´ê°„</button>
                            <button class="tag-btn" data-value="Hammond Organ">í•˜ëª¬ë“œ ì˜¤ë¥´ê°„</button>
                            <button class="tag-btn" data-value="Harpsichord">í•˜í”„ì‹œì½”ë“œ</button>
                            <button class="tag-btn" data-value="Clavinet">í´ë¼ë¹„ë„·</button>
                            <button class="tag-btn" data-value="Accordion">ì•„ì½”ë””ì–¸</button>
                            <button class="tag-btn" data-value="Melodica">ë©œë¡œë””ì¹´</button>
                            
                            <!-- ê¸°íƒ€ë¥˜ -->
                            <button class="tag-btn" data-value="Guitar">ê¸°íƒ€</button>
                            <button class="tag-btn" data-value="Acoustic Guitar">ì–´ì¿ ìŠ¤í‹± ê¸°íƒ€</button>
                            <button class="tag-btn" data-value="Electric Guitar">ì¼ë ‰íŠ¸ë¦­ ê¸°íƒ€</button>
                            <button class="tag-btn" data-value="Classical Guitar">í´ë˜ì‹ ê¸°íƒ€</button>
                            <button class="tag-btn" data-value="Bass Guitar">ë² ì´ìŠ¤ ê¸°íƒ€</button>
                            <button class="tag-btn" data-value="Ukulele">ìš°ì¿¨ë ë ˆ</button>
                            <button class="tag-btn" data-value="Mandolin">ë§ŒëŒë¦°</button>
                            <button class="tag-btn" data-value="Banjo">ë°´ì¡°</button>
                            <button class="tag-btn" data-value="Sitar">ì‹œíƒ€ë¥´</button>
                            
                            <!-- í˜„ì•…ê¸° -->
                            <button class="tag-btn" data-value="Strings">í˜„ì•…ê¸°</button>
                            <button class="tag-btn" data-value="Violin">ë°”ì´ì˜¬ë¦°</button>
                            <button class="tag-btn" data-value="Viola">ë¹„ì˜¬ë¼</button>
                            <button class="tag-btn" data-value="Cello">ì²¼ë¡œ</button>
                            <button class="tag-btn" data-value="Double Bass">ë”ë¸” ë² ì´ìŠ¤</button>
                            <button class="tag-btn" data-value="Harp">í•˜í”„</button>
                            <button class="tag-btn" data-value="String Ensemble">í˜„ì•… ì•™ìƒë¸”</button>
                            <button class="tag-btn" data-value="Orchestra">ì˜¤ì¼€ìŠ¤íŠ¸ë¼</button>
                            <button class="tag-btn" data-value="Chamber Orchestra">ì‹¤ë‚´ì•…</button>
                            
                            <!-- ê´€ì•…ê¸° -->
                            <button class="tag-btn" data-value="Flute">í”Œë£¨íŠ¸</button>
                            <button class="tag-btn" data-value="Saxophone">ìƒ‰ì†Œí°</button>
                            <button class="tag-btn" data-value="Trumpet">íŠ¸ëŸ¼í«</button>
                            <button class="tag-btn" data-value="Trombone">íŠ¸ë¡¬ë³¸</button>
                            <button class="tag-btn" data-value="French Horn">í˜¸ë¥¸</button>
                            <button class="tag-btn" data-value="Clarinet">í´ë¼ë¦¬ë„·</button>
                            <button class="tag-btn" data-value="Oboe">ì˜¤ë³´ì—</button>
                            <button class="tag-btn" data-value="Bassoon">ë°”ìˆœ</button>
                            <button class="tag-btn" data-value="Harmonica">í•˜ëª¨ë‹ˆì¹´</button>
                            <button class="tag-btn" data-value="Brass">ë¸Œë¼ìŠ¤</button>
                            <button class="tag-btn" data-value="Woodwind">ìš°ë“œìœˆë“œ</button>
                            
                            <!-- íƒ€ì•…ê¸° -->
                            <button class="tag-btn" data-value="Drums">ë“œëŸ¼</button>
                            <button class="tag-btn" data-value="Drum Kit">ë“œëŸ¼ í‚¤íŠ¸</button>
                            <button class="tag-btn" data-value="Drum Machine">ë“œëŸ¼ ë¨¸ì‹ </button>
                            <button class="tag-btn" data-value="808">808</button>
                            <button class="tag-btn" data-value="909">909</button>
                            <button class="tag-btn" data-value="Percussion">í¼ì»¤ì…˜</button>
                            <button class="tag-btn" data-value="Timpani">íŒ€íŒŒë‹ˆ</button>
                            <button class="tag-btn" data-value="Cymbals">ì‹¬ë²Œì¦ˆ</button>
                            <button class="tag-btn" data-value="Tambourine">íƒ¬ë²„ë¦°</button>
                            <button class="tag-btn" data-value="Xylophone">ì‹¤ë¡œí°</button>
                            <button class="tag-btn" data-value="Marimba">ë§ˆë¦¼ë°”</button>
                            <button class="tag-btn" data-value="Vibraphone">ë¹„ë¸Œë¼í°</button>
                            <button class="tag-btn" data-value="Bells">ë²¨</button>
                            
                            <!-- ì‹ ìŠ¤/ì¼ë ‰íŠ¸ë¡œë‹‰ -->
                            <button class="tag-btn" data-value="Synth">ì‹ ìŠ¤</button>
                            <button class="tag-btn" data-value="Synthesizer">ì‹ ì‹œì‚¬ì´ì €</button>
                            <button class="tag-btn" data-value="Analog Synth">ì•„ë‚ ë¡œê·¸ ì‹ ìŠ¤</button>
                            <button class="tag-btn" data-value="Digital Synth">ë””ì§€í„¸ ì‹ ìŠ¤</button>
                            <button class="tag-btn" data-value="Pad">íŒ¨ë“œ</button>
                            <button class="tag-btn" data-value="Lead">ë¦¬ë“œ</button>
                            <button class="tag-btn" data-value="Bass Synth">ë² ì´ìŠ¤ ì‹ ìŠ¤</button>
                            <button class="tag-btn" data-value="Electronic">ì¼ë ‰íŠ¸ë¡œë‹‰</button>
                            <button class="tag-btn" data-value="Sampler">ìƒ˜í”ŒëŸ¬</button>
                            <button class="tag-btn" data-value="Sequencer">ì‹œí€€ì„œ</button>
                            <button class="tag-btn" data-value="Arpeggiator">ì•„ë¥´í˜ì§€ì—ì´í„°</button>
                            <button class="tag-btn" data-value="Modular">ëª¨ë“ˆëŸ¬</button>
                            
                            <!-- ë² ì´ìŠ¤ -->
                            <button class="tag-btn" data-value="Bass">ë² ì´ìŠ¤</button>
                            <button class="tag-btn" data-value="Electric Bass">ì¼ë ‰íŠ¸ë¦­ ë² ì´ìŠ¤</button>
                            <button class="tag-btn" data-value="Acoustic Bass">ì–´ì¿ ìŠ¤í‹± ë² ì´ìŠ¤</button>
                            <button class="tag-btn" data-value="Synth Bass">ì‹ ìŠ¤ ë² ì´ìŠ¤</button>
                            <button class="tag-btn" data-value="Sub Bass">ì„œë¸Œ ë² ì´ìŠ¤</button>
                            
                            <!-- ë°´ë“œ êµ¬ì„± -->
                            <button class="tag-btn" data-value="Jazz Trio">ì¬ì¦ˆ íŠ¸ë¦¬ì˜¤</button>
                            <button class="tag-btn" data-value="Jazz Quartet">ì¬ì¦ˆ ì½°ë¥´í…Ÿ</button>
                            <button class="tag-btn" data-value="Big Band">ë¹… ë°´ë“œ</button>
                            <button class="tag-btn" data-value="Rock Band">ë¡ ë°´ë“œ</button>
                            <button class="tag-btn" data-value="Punk Band">í‘í¬ ë°´ë“œ</button>
                            <button class="tag-btn" data-value="Metal Band">ë©”íƒˆ ë°´ë“œ</button>
                            <button class="tag-btn" data-value="Electronic Band">ì¼ë ‰íŠ¸ë¡œë‹‰ ë°´ë“œ</button>
                            
                            <!-- ìŠ¤íƒ€ì¼ë³„ -->
                            <button class="tag-btn" data-value="Ambient">ì•°ë¹„ì–¸íŠ¸</button>
                            <button class="tag-btn" data-value="Lo-Fi">ë¡œíŒŒì´</button>
                            <button class="tag-btn" data-value="House">í•˜ìš°ìŠ¤</button>
                            <button class="tag-btn" data-value="Techno">í…Œí¬ë…¸</button>
                            <button class="tag-btn" data-value="Trance">íŠ¸ëœìŠ¤</button>
                            <button class="tag-btn" data-value="Dubstep">ë¥ìŠ¤í…</button>
                            <button class="tag-btn" data-value="Drum and Bass">ë“œëŸ¼ ì•¤ ë² ì´ìŠ¤</button>
                            <button class="tag-btn" data-value="Trap">íŠ¸ë©</button>
                            <button class="tag-btn" data-value="Hip-Hop">í™í•©</button>
                            <button class="tag-btn" data-value="R&B">R&B</button>
                            <button class="tag-btn" data-value="Soul">ì†Œìš¸</button>
                            <button class="tag-btn" data-value="Funk">í‘í¬</button>
                            <button class="tag-btn" data-value="Disco">ë””ìŠ¤ì½”</button>
                            <button class="tag-btn" data-value="Reggae">ë ˆê²Œ</button>
                            <button class="tag-btn" data-value="Latin">ë¼í‹´</button>
                            <button class="tag-btn" data-value="World Music">ì›”ë“œ ë®¤ì§</button>
                            <button class="tag-btn custom-tag-btn" data-container="instrumentTags" onclick="showCustomTagInput('instrumentTags')" style="background: var(--accent); color: white; border: 2px dashed white;">â• ê¸°íƒ€(ì¶”ê°€)</button>
                            </div>
                        </div>
                    </div>

                    <div class="form-group style-textarea-group">
                        <label style="display: flex; justify-content: space-between; align-items: center;">
                            <span>ìƒì„±ëœ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸</span>
                            <div style="display: flex; gap: 5px;">
                                <button class="btn btn-small btn-secondary" onclick="saveStylePromptHistory()" title="ì´ë ¥ì— ì €ì¥"><i class="fas fa-save"></i> ì €ì¥</button>
                                <button class="btn btn-small btn-secondary" onclick="copyToClipboard('stylePrompt', 'ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸', event)" title="ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ ë³µì‚¬"><i class="fas fa-copy"></i> ë³µì‚¬</button>
                            </div>
                        </label>
                        
                        <!-- í”„ë¡¬í”„íŠ¸ ì‘ì„± ê³¼ì • ì„¤ëª… -->
                        <div id="stylePromptProcessInfo" style="margin-bottom: 15px; padding: 15px; background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(59, 130, 246, 0.05)); border: 1px solid rgba(139, 92, 246, 0.2); border-radius: 10px; font-size: 0.85rem;">
                            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 12px; font-weight: 600; color: var(--accent);">
                                <i class="fas fa-info-circle"></i>
                                <span>ğŸ“ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ ì‘ì„± ê³¼ì •</span>
                            </div>
                            <div style="color: var(--text-secondary); line-height: 1.8;">
                                <div style="margin-bottom: 10px;">
                                    <strong style="color: var(--text-primary);">1ï¸âƒ£ ìë™ ìƒì„± (1ë‹¨ê³„â†’2ë‹¨ê³„ ì „í™˜ ì‹œ)</strong>
                                    <ul style="margin: 5px 0 0 20px; padding: 0;">
                                        <li>ì„ íƒí•œ ê°€ì‚¬ë¥¼ ChatGPTê°€ ë¶„ì„í•˜ì—¬ ìë™ ìƒì„±</li>
                                        <li>1ë‹¨ê³„ ì„ íƒì‚¬í•­ ë°˜ì˜: ì¥ë¥´, ë¶„ìœ„ê¸°, ì£¼ì œ, ì‹œê°„ëŒ€, ì œì‘ ì§€ì¹¨ì„œ</li>
                                        <li>ê°€ì‚¬ì˜ ê°ì • í†¤ê³¼ ë¶„ìœ„ê¸°ë¥¼ ë¶„ì„í•˜ì—¬ ìŒì•… ìŠ¤íƒ€ì¼ ë§¤ì¹­</li>
                                    </ul>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <strong style="color: var(--text-primary);">2ï¸âƒ£ ìˆ˜ë™ ìƒì„± ("AIë¡œ í”„ë¡¬í”„íŠ¸ ìƒì„±" ë²„íŠ¼ í´ë¦­ ì‹œ)</strong>
                                    <ul style="margin: 5px 0 0 20px; padding: 0;">
                                        <li><strong>1ë‹¨ê³„ ì„ íƒì‚¬í•­ ë°˜ì˜:</strong> ì¥ë¥´, ë¶„ìœ„ê¸°, ì£¼ì œ, ì‹œê°„ëŒ€, íŠ¹ë³„ ìš”ì†Œ, ì§€ì—­, ì œì‘ ì§€ì¹¨ì„œ</li>
                                        <li><strong>2ë‹¨ê³„ ì„ íƒì‚¬í•­ ë°˜ì˜:</strong> ì•…ê¸° êµ¬ì„±, ë³´ì»¬ ìŠ¤íƒ€ì¼, í…œí¬, ìŒí–¥ í¬ë§·, ì—°ì£¼ ì¥ì†Œ, íŒŒíŠ¸ë³„ ë³´ì»¬ ì§€ì •</li>
                                        <li><strong>í˜„ì¬ ê°€ì‚¬ ë¶„ì„:</strong> ìˆ˜ë…¸ìš© ê°€ì‚¬ì˜ ê°ì • í†¤ê³¼ ë¶„ìœ„ê¸° ë°˜ì˜</li>
                                        <li><strong>ì—°ì£¼ ì¥ì†Œ ë°˜ì˜:</strong> ì„ íƒí•œ ì¥ì†Œì˜ ìŒí–¥ íŠ¹ì„±(ë¦¬ë²„ë¸Œ, ì—ì½”, ê³µê°„ê°) ë°˜ì˜</li>
                                    </ul>
                                </div>
                                <div style="margin-bottom: 10px;">
                                    <strong style="color: var(--text-primary);">3ï¸âƒ£ ìƒì„± ê·œì¹™</strong>
                                    <ul style="margin: 5px 0 0 20px; padding: 0;">
                                        <li>âœ… <strong>100% ì˜ì–´ë§Œ ì‚¬ìš©</strong> (í•œêµ­ì–´ ì œê±°)</li>
                                        <li>âœ… <strong>ìµœëŒ€ 1,000ì ì œí•œ</strong> (ì´ˆê³¼ ì‹œ ìë™ ì˜ë¦¼)</li>
                                        <li>âœ… <strong>ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ì„¤ëª…í˜• ë¬¸êµ¬</strong> í˜•ì‹</li>
                                        <li>âœ… <strong>ì•„í‹°ìŠ¤íŠ¸ ì´ë¦„ì´ë‚˜ íŠ¹ì • ì•„í‹°ìŠ¤íŠ¸ ì–¸ê¸‰ ê¸ˆì§€</strong></li>
                                        <li>âœ… <strong>ìŒì•… ìŠ¤íƒ€ì¼, ì•…ê¸°, ë³´ì»¬ íŠ¹ì„±, ë¶„ìœ„ê¸°, ê³µê°„ê° ì¤‘ì‹¬</strong></li>
                                    </ul>
                                </div>
                                <div style="padding: 10px; background: rgba(139, 92, 246, 0.1); border-radius: 6px; margin-top: 10px;">
                                    <strong style="color: var(--accent);">ğŸ’¡ ìƒì„± ì˜ˆì‹œ:</strong>
                                    <div style="margin-top: 5px; font-family: monospace; font-size: 0.8rem; color: var(--text-primary);">
                                        "K-Pop Ballad, emotional, melancholic, Korean vocals, soft piano, warm strings, 80 BPM, intimate atmosphere, studio quality, gentle reverb, wide stereo, cinematic, heartfelt, nostalgic undertones"
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <textarea id="stylePrompt" style="min-height: 400px; max-height: 600px; height: 400px; overflow-y: auto;" onchange="updateStylePromptTranslation()" oninput="debounceUpdateStylePromptTranslation()"></textarea>
                        
                        <!-- ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ í•œê¸€ í•´ì„ -->
                        <div id="stylePromptTranslationSection" style="margin-top: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <span style="font-weight: 600; color: var(--accent);"><i class="fas fa-language"></i> í•œê¸€ í•´ì„</span>
                                <button class="btn btn-small btn-secondary" onclick="generateStylePromptTranslation()" title="í•´ì„ ìƒˆë¡œê³ ì¹¨"><i class="fas fa-sync-alt"></i> ìƒˆë¡œê³ ì¹¨</button>
                            </div>
                            <div id="stylePromptTranslation" style="padding: 15px; background: var(--bg-input); border-radius: 8px; border: 1px solid var(--border); min-height: 80px; color: var(--text-primary); line-height: 1.8; font-size: 0.9rem;">
                                <div style="color: var(--text-secondary); text-align: center; padding: 20px;">
                                    <i class="fas fa-spinner fa-spin"></i> í•œê¸€ í•´ì„ ìƒì„± ì¤‘...
                                </div>
                            </div>
                        </div>
                        
                        <!-- ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ ì´ë ¥ -->
                        <div id="stylePromptHistorySection" style="margin-top: 15px; display: none;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                <span style="font-weight: 600; color: var(--accent);"><i class="fas fa-history"></i> ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ ì´ë ¥</span>
                                <button class="btn btn-small btn-danger" onclick="clearStylePromptHistory()" style="font-size: 0.75rem;"><i class="fas fa-trash"></i> ì „ì²´ ì‚­ì œ</button>
                            </div>
                            <div id="stylePromptHistoryList" style="max-height: 200px; overflow-y: auto; background: var(--bg-input); border-radius: 8px; padding: 10px;"></div>
                        </div>
                    </div>

                    <button class="btn btn-secondary" onclick="generateStylePromptAI()">âœ¨ AIë¡œ í”„ë¡¬í”„íŠ¸ ìƒì„±</button>
                </div>
            </div>
            
            <div class="btn-group" style="justify-content: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid var(--border);">
                <button class="btn btn-secondary" onclick="goToStep(1)" style="min-width: 120px;">
                    â† ì´ì „
                </button>
                <button class="btn btn-primary" onclick="goToStep2To3()" style="min-width: 200px;">
                    <i class="fas fa-arrow-right"></i> ë‹¤ìŒ ë‹¨ê³„ë¡œ
                </button>
            </div>
            <div class="step-footer">
                <p>ğŸµ Music Creator - AI ê°€ì‚¬ & ìˆ˜ë…¸ í”„ë¡¬í”„íŠ¸ & ë§ˆì¼€íŒ… ìë£Œ ìƒì„±ê¸°</p>
                <p>Powered by Google Gemini AI & ChatGPT âœ¨ | ë®¤ì§ëª¨ë¦¬ ì±„ë„</p>
            </div>
        </div>

        <!-- Panel 3: ë¶„ì„ & í‰ê°€ -->
        <div class="panel" id="panel3">
            <div class="loading" id="analysisLoading">
                <div class="spinner"></div>
                <p class="loading-text">ğŸ¤– Gemini & ChatGPTê°€ ê°€ì‚¬ë¥¼ ë™ì‹œ ë¶„ì„ ì¤‘...</p>
                <p class="loading-subtext">ë‘ AIì˜ ê´€ì ì—ì„œ êµ¬ì¡°, ê°ì •, ìš´ìœ¨, ì°½ì˜ì„±, ìƒì—…ì„±ì„ ì¢…í•© í‰ê°€í•©ë‹ˆë‹¤</p>
            </div>

            <div class="error-message" id="analysisError">
                <div class="error-icon">âš ï¸</div>
                <div class="error-title">API ì˜¤ë¥˜</div>
                <div class="error-desc" id="analysisErrorDesc">AI ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ë‘ AI ëª¨ë‘ ë¶„ì„ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.</div>
                <div class="error-details" id="analysisErrorDetails" style="display: none; margin-top: 10px; padding: 10px; background: rgba(255, 255, 255, 0.1); border-radius: 6px; font-size: 0.85rem;"></div>
                <div class="error-suggestions" style="margin-top: 15px; padding: 15px; background: rgba(255, 255, 255, 0.05); border-radius: 8px; font-size: 0.9rem;">
                    <strong style="display: block; margin-bottom: 10px;">ğŸ’¡ í•´ê²° ë°©ë²•:</strong>
                    <ul style="margin: 0; padding-left: 20px; line-height: 1.8;">
                        <li>API í‚¤ê°€ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”</li>
                        <li>ë„¤íŠ¸ì›Œí¬ ì—°ê²° ìƒíƒœë¥¼ í™•ì¸í•˜ì„¸ìš”</li>
                        <li>ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ë³´ì„¸ìš”</li>
                        <li>API ìš”ì²­ í•œë„ê°€ ì´ˆê³¼ë˜ì—ˆì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
                    </ul>
                </div>
                <div class="btn-group" style="margin-top: 20px; gap: 10px;">
                    <button class="btn btn-primary" onclick="retryAnalysis()" id="retryAnalysisBtn">
                        <i class="fas fa-redo"></i> ë‹¤ì‹œ ì‹œë„
                    </button>
                    <button class="btn btn-secondary" onclick="checkAPIKeys()">
                        <i class="fas fa-key"></i> API í‚¤ í™•ì¸
                    </button>
                </div>
            </div>

            <div id="analysisResult" style="display: none;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <div>
                        <h3>ğŸ” Gemini ì •ë°€ ë¶„ì„</h3>
                        <p>2ë‹¨ê³„ì—ì„œ ìƒì„±ëœ ê°€ì‚¬ì™€ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ë¥¼ ì •ë°€ ë¶„ì„í•˜ê³  ê°œì„  ì‚¬í•­ì„ ì œì•ˆí•©ë‹ˆë‹¤.</p>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-primary" id="startAnalysisBtn" onclick="if(typeof window.startGeminiAnalysis === 'function') { window.startGeminiAnalysis(); } else { alert('âš ï¸ ë¶„ì„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }">
                            <i class="fas fa-magic"></i> ë¶„ì„ ì‹œì‘
                        </button>
                        <button class="btn btn-small btn-save-step" onclick="saveCurrentProject(); showCopyIndicator('âœ… 3ë‹¨ê³„: AI ë¶„ì„ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');" title="ì´ ë‹¨ê³„ ì €ì¥">
                            <i class="fas fa-save"></i> ì €ì¥
                        </button>
                    </div>
                </div>

                <!-- ë¶„ì„ ëŒ€ìƒ í‘œì‹œ -->
                <div class="card" style="margin-bottom: 20px;">
                    <div class="card-header">
                        <div class="card-icon">ğŸ“‹</div>
                        <div>
                            <h2 class="card-title">ë¶„ì„ ëŒ€ìƒ</h2>
                            <p class="card-subtitle">2ë‹¨ê³„ì—ì„œ ìƒì„±ëœ ê°€ì‚¬ì™€ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸</p>
                        </div>
                    </div>
                    <div style="padding: 20px;">
                        <div style="margin-bottom: 15px;">
                            <h4 style="margin-bottom: 10px; color: var(--text-primary);">ğŸ“ ìˆ˜ë…¸ ê°€ì‚¬ (ì§€ì‹œì–´ í¬í•¨)</h4>
                            <div id="analysisTargetLyrics" style="background: var(--bg-input); padding: 15px; border-radius: 8px; white-space: pre-wrap; font-family: monospace; font-size: 0.9rem; line-height: 1.6; max-height: 300px; overflow-y: auto; color: var(--text-secondary);"></div>
                        </div>
                        <div>
                            <h4 style="margin-bottom: 10px; color: var(--text-primary);">ğŸ¨ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸</h4>
                            <div id="analysisTargetStyle" style="background: var(--bg-input); padding: 15px; border-radius: 8px; white-space: pre-wrap; font-family: monospace; font-size: 0.9rem; line-height: 1.6; max-height: 150px; overflow-y: auto; color: var(--text-secondary);"></div>
                        </div>
                    </div>
                </div>

                <!-- Gemini ë¶„ì„ ê²°ê³¼ -->
                <div class="card" id="geminiAnalysisCard" style="display: none; margin-bottom: 20px;">
                    <div class="card-header">
                        <div class="card-icon">ğŸ¤–</div>
                        <div>
                            <h2 class="card-title">Gemini ë¶„ì„ ê²°ê³¼</h2>
                            <p class="card-subtitle">ì •ë°€ ë¶„ì„ ë° ê°œì„  ì‚¬í•­ ì œì•ˆ</p>
                        </div>
                        <span class="ai-status" id="geminiStatus">ë¶„ì„ ì¤‘...</span>
                    </div>
                    <div id="geminiAnalysisResult" style="padding: 20px;">
                        <!-- ë¶„ì„ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë¨ -->
                    </div>
                </div>

                <div class="btn-group" style="justify-content: center;">
                    <button class="btn btn-secondary" onclick="if(typeof window.goToStep === 'function') { window.goToStep(2); } else { alert('âš ï¸ ë‹¨ê³„ ì´ë™ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }">â† ì´ì „</button>
                    <button class="btn btn-primary" id="nextStepBtn" onclick="if(typeof window.goToStep4AndApplyImprovements === 'function') { window.goToStep4AndApplyImprovements(); } else { alert('âš ï¸ ê°œì„ ì•ˆ ë°˜ì˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }">ğŸ”§ ê°œì„ ì•ˆ ë°˜ì˜ â†’</button>
                </div>
                <div class="step-footer">
                    <p>ğŸµ Music Creator - AI ê°€ì‚¬ & ìˆ˜ë…¸ í”„ë¡¬í”„íŠ¸ & ë§ˆì¼€íŒ… ìë£Œ ìƒì„±ê¸°</p>
                    <p>Powered by Google Gemini AI & ChatGPT âœ¨ | ë®¤ì§ëª¨ë¦¬ ì±„ë„</p>
                </div>
            </div>
        </div>

        <!-- Panel 4: ê°œì„ ì•ˆ ë°˜ì˜ ë° í™•ì • -->
        <div class="panel" id="panel4">
            <div class="loading" id="improvementLoading">
                <div class="spinner"></div>
                <p class="loading-text">ğŸ’¬ ChatGPTê°€ Geminiì˜ ê°œì„ ì•ˆì„ ë°˜ì˜ ì¤‘ì…ë‹ˆë‹¤...</p>
                <p class="loading-subtext">ì œì•ˆëœ ê°œì„  ì‚¬í•­ì„ ë°”íƒ•ìœ¼ë¡œ ìµœì¢… ê°€ì‚¬ì™€ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ë¥¼ í™•ì •í•©ë‹ˆë‹¤</p>
            </div>

            <div class="card" id="improvementCard" style="display: none;">
                <div class="card-header">
                    <div class="card-icon">âœ…</div>
                    <div>
                        <h2 class="card-title">ìµœì¢… í™•ì • <span class="ai-badge">ğŸ’¬ ChatGPT</span></h2>
                        <p class="card-subtitle">Geminiì˜ ê°œì„ ì•ˆì´ ë°˜ì˜ëœ ìµœì¢… ê°€ì‚¬ì™€ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸</p>
                    </div>
                    <button class="btn btn-small btn-save-step" onclick="saveCurrentProject(); showCopyIndicator('âœ… 4ë‹¨ê³„: ìµœì¢… í™•ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');" title="ì´ ë‹¨ê³„ ì €ì¥">
                        <i class="fas fa-save"></i> ì €ì¥
                    </button>
                </div>
                
                <!-- Gemini ì œì•ˆ ì‚¬í•­ ì„ íƒ -->
                <div class="card" style="margin-bottom: 20px; background: var(--bg-input); max-width: 100%; box-sizing: border-box; overflow: hidden;">
                    <div class="card-header" style="padding: 12px 15px;">
                        <div class="card-icon">ğŸ¤–</div>
                        <div style="flex: 1;">
                            <h3 style="margin: 0; font-size: 1rem;">Gemini ì œì•ˆ ì‚¬í•­</h3>
                            <p style="margin: 0; font-size: 0.85rem; color: var(--text-secondary);">3ë‹¨ê³„ì—ì„œ ë¶„ì„ëœ ê°œì„  ì‚¬í•­ - ì ìš©í•  í•­ëª©ì„ ì„ íƒí•˜ì„¸ìš”</p>
                        </div>
                        <div style="display: flex; gap: 8px;">
                            <button class="btn btn-small btn-secondary" onclick="if(typeof window.selectAllImprovements === 'function') { window.selectAllImprovements(); } else { alert('âš ï¸ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }" style="font-size: 0.75rem;">ì „ì²´ ì„ íƒ</button>
                            <button class="btn btn-small btn-secondary" onclick="if(typeof window.deselectAllImprovements === 'function') { window.deselectAllImprovements(); } else { alert('âš ï¸ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }" style="font-size: 0.75rem;">ì „ì²´ í•´ì œ</button>
                        </div>
                    </div>
                    <div id="geminiSuggestionsSummary" style="padding: 15px; font-size: 0.9rem; color: var(--text-secondary); overflow-x: hidden; max-width: 100%; box-sizing: border-box;">
                        <!-- Gemini ì œì•ˆ ì‚¬í•­ì´ ì—¬ê¸°ì— í‘œì‹œë¨ -->
                    </div>
                    <div style="padding: 15px; border-top: 1px solid var(--border); background: var(--bg-card);">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                            <span style="font-weight: 600; color: var(--text-primary);">
                                ì„ íƒëœ ê°œì„ ì•ˆ: <span id="selectedImprovementsCount">0</span>ê°œ
                            </span>
                            <div style="display: flex; gap: 8px;">
                                <button class="btn btn-primary btn-small" onclick="if(typeof window.applySelectedImprovements === 'function') { window.applySelectedImprovements(); } else { alert('âš ï¸ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }" id="applySelectedBtn">
                                    âœ… ì„ íƒí•œ í•­ëª©ë§Œ ì ìš©
                                </button>
                                <button class="btn btn-success btn-small" onclick="if(typeof window.applyAllImprovements === 'function') { window.applyAllImprovements(); } else { alert('âš ï¸ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }" id="applyAllBtn">
                                    âœ… ì „ì²´ ì ìš©
                                </button>
                            </div>
                        </div>
                        <p style="font-size: 0.8rem; color: var(--text-secondary); margin: 0;">
                            ğŸ’¡ ê°œì„ ì•ˆì„ ì„ íƒí•œ í›„ "ì„ íƒí•œ í•­ëª©ë§Œ ì ìš©" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”. ë˜ëŠ” "ì „ì²´ ì ìš©"ìœ¼ë¡œ ëª¨ë“  ê°œì„ ì•ˆì„ í•œ ë²ˆì— ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                        </p>
                    </div>
                </div>

                <!-- í™•ì •ëœ ê°€ì‚¬ -->
                <div class="card" style="margin-bottom: 20px; border: 2px solid var(--success);">
                    <div class="card-header">
                        <div class="card-icon">ğŸ“</div>
                        <div>
                            <h2 class="card-title">í™•ì •ëœ ê°€ì‚¬ (ì§€ì‹œì–´ í¬í•¨)</h2>
                            <p class="card-subtitle">ChatGPTê°€ ê°œì„ ì•ˆì„ ë°˜ì˜í•˜ì—¬ í™•ì •í•œ ìµœì¢… ê°€ì‚¬</p>
                        </div>
                    </div>
                    <div style="padding: 20px;">
                        <textarea id="finalizedLyrics" style="width: 100%; min-height: 400px; padding: 15px; background: var(--bg-input); color: var(--text-primary); border: 1px solid var(--border); border-radius: 8px; font-family: monospace; font-size: 0.9rem; line-height: 1.6; resize: vertical;" readonly></textarea>
                        <div style="margin-top: 10px; display: flex; gap: 10px;">
                            <button class="btn btn-success" onclick="copyToClipboard('finalizedLyrics', 'ê°€ì‚¬', event)">ğŸ“‹ ê°€ì‚¬ ë³µì‚¬</button>
                            <button class="btn btn-secondary" id="editFinalizedLyricsBtn" onclick="toggleEditFinalizedLyrics()">âœï¸ ìˆ˜ì •í•˜ê¸°</button>
                        </div>
                    </div>
                </div>

                <!-- í™•ì •ëœ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ -->
                <div class="card" style="margin-bottom: 20px; border: 2px solid var(--success);">
                    <div class="card-header">
                        <div class="card-icon">ğŸ¨</div>
                        <div>
                            <h2 class="card-title">í™•ì •ëœ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸</h2>
                            <p class="card-subtitle">ChatGPTê°€ ê°œì„ ì•ˆì„ ë°˜ì˜í•˜ì—¬ í™•ì •í•œ ìµœì¢… ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸</p>
                        </div>
                    </div>
                    <div style="padding: 20px;">
                        <textarea id="finalizedStyle" style="width: 100%; min-height: 200px; padding: 15px; background: var(--bg-input); color: var(--text-primary); border: 1px solid var(--border); border-radius: 8px; font-family: monospace; font-size: 0.9rem; line-height: 1.6; resize: vertical;" readonly></textarea>
                        <div style="margin-top: 10px; display: flex; gap: 10px;">
                            <button class="btn btn-success" onclick="copyToClipboard('finalizedStyle', 'ìŠ¤íƒ€ì¼', event)">ğŸ“‹ ìŠ¤íƒ€ì¼ ë³µì‚¬</button>
                            <button class="btn btn-secondary" id="editFinalizedStyleBtn" onclick="toggleEditFinalizedStyle()">âœï¸ ìˆ˜ì •í•˜ê¸°</button>
                        </div>
                    </div>
                </div>

                <!-- ì¬ìƒì„± ì˜µì…˜ -->
                <div class="card" style="margin-bottom: 20px; border: 2px dashed var(--border);">
                    <div class="card-header" style="padding: 12px 15px;">
                        <div class="card-icon">ğŸ”„</div>
                        <div>
                            <h3 style="margin: 0; font-size: 1rem;">ì¬ìƒì„± ì˜µì…˜</h3>
                            <p style="margin: 0; font-size: 0.85rem; color: var(--text-secondary);">ê²°ê³¼ê°€ ë§ˆìŒì— ë“¤ì§€ ì•Šìœ¼ë©´ ë‹¤ì‹œ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
                        </div>
                    </div>
                    <div style="padding: 15px;">
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <button class="btn btn-secondary" onclick="regenerateFinalizedContent()" id="regenerateBtn">
                                ğŸ”„ ë‹¤ì‹œ ìƒì„±
                            </button>
                            <button class="btn btn-secondary" onclick="showRegenerationHistory()" id="historyBtn">
                                ğŸ“œ ìƒì„± ì´ë ¥ ë³´ê¸°
                            </button>
                        </div>
                        <div id="regenerationHistory" style="display: none; margin-top: 15px; padding: 15px; background: var(--bg-input); border-radius: 8px;">
                            <!-- ìƒì„± ì´ë ¥ì´ ì—¬ê¸°ì— í‘œì‹œë¨ -->
                        </div>
                    </div>
                </div>

                <div class="btn-group" style="justify-content: center;">
                    <button class="btn btn-secondary" onclick="goToStep(3)">â† ì´ì „</button>
                    <button class="btn btn-primary" onclick="confirmFinalizedContent()">
                        âœ… í™•ì • ì™„ë£Œ â†’ 
                    </button>
                </div>
                <div class="step-footer">
                    <p>ğŸµ Music Creator - AI ê°€ì‚¬ & ìˆ˜ë…¸ í”„ë¡¬í”„íŠ¸ & ë§ˆì¼€íŒ… ìë£Œ ìƒì„±ê¸°</p>
                    <p>Powered by Google Gemini AI & ChatGPT âœ¨ | ë®¤ì§ëª¨ë¦¬ ì±„ë„</p>
                </div>
            </div>
        </div>

        <!-- Panel 5: ìµœì¢… ì¶œë ¥ -->
        <div class="panel" id="panel5">
            <!-- ë‹¨ê³„ í—¤ë” with ì €ì¥ ë²„íŠ¼ -->
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding: 15px 20px; background: linear-gradient(135deg, var(--accent-dark), var(--accent)); border-radius: 12px;">
                <div style="display: flex; align-items: center; gap: 12px;">
                    <span style="font-size: 1.8rem;">ğŸ¯</span>
                    <div>
                        <h2 style="margin: 0; color: white; font-size: 1.3rem;">5ë‹¨ê³„: ìµœì¢… ì¶œë ¥</h2>
                        <p style="margin: 5px 0 0 0; color: rgba(255,255,255,0.8); font-size: 0.85rem;">ìˆ˜ë…¸ AIì— ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ìµœì¢… ê²°ê³¼ë¬¼</p>
                    </div>
                </div>
                <button class="btn btn-small btn-save-step" onclick="saveCurrentProject(); showCopyIndicator('âœ… 5ë‹¨ê³„: ìµœì¢… ì¶œë ¥ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');" title="ì´ ë‹¨ê³„ ì €ì¥">
                    <i class="fas fa-save"></i> ì €ì¥
                </button>
            </div>

            <!-- ì¤‘ê°„ ë²„ì „ ìƒì„± ë° ë¶„ì„ ì„¹ì…˜ (ìœ„ë¡œ ì´ë™) -->
            <div class="card" style="margin-top: 20px; border: 2px solid var(--accent);">
                <div class="card-header">
                    <div class="card-icon">ğŸ”„</div>
                    <div>
                        <h2 class="card-title">ì¤‘ê°„ ë²„ì „ ìƒì„± ë° ë¶„ì„</h2>
                        <p class="card-subtitle">Sunoì—ì„œ ì¤‘ê°„ ë²„ì „ ìƒì„± â†’ ë¶„ì„ â†’ ìµœì¢… ê°€ì‚¬ ë°˜ì˜</p>
                    </div>
                </div>
                <div style="padding: 20px;">
                    <div style="margin-bottom: 20px; padding: 15px; background: var(--bg-input); border-radius: 8px;">
                        <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.6;">
                            ğŸ’¡ <strong>ì›Œí¬í”Œë¡œìš°:</strong><br>
                            1. ì•„ë˜ ê°€ì‚¬ì™€ ìŠ¤íƒ€ì¼ì„ ë³µì‚¬í•˜ì—¬ <a href="https://suno.com" target="_blank" style="color: var(--accent); text-decoration: underline;">Suno ì›¹ì‚¬ì´íŠ¸</a>ì—ì„œ ì¤‘ê°„ ë²„ì „ ìƒì„±<br>
                            2. Sunoì—ì„œ ìƒì„±ëœ ìŒì› ë‹¤ìš´ë¡œë“œ<br>
                            3. ì—¬ê¸°ì— ì—…ë¡œë“œí•˜ì—¬ ìŒì› ë¶„ì„<br>
                            4. <strong>"ë¶„ì„ ê²°ê³¼ë¥¼ ìµœì¢… ê°€ì‚¬ì— ë°˜ì˜"</strong> ë²„íŠ¼ í´ë¦­ â†’ ìµœì¢… ê°€ì‚¬ ìë™ í™•ì •<br>
                            <span style="color: var(--accent); font-weight: 600;">âœ¨ ë¶„ì„ í›„ ìµœì¢… ê°€ì‚¬ê°€ ìë™ìœ¼ë¡œ í™•ì •ë˜ë©°, "ìµœì í™” ê°€ì‚¬ ë‹¤ì‹œ ìƒì„±" ë²„íŠ¼ìœ¼ë¡œ ì¶”ê°€ ì¡°ì •ë„ ê°€ëŠ¥í•©ë‹ˆë‹¤.</span>
                        </p>
                    </div>
                    
                    <div style="margin-bottom: 20px; padding: 15px; background: linear-gradient(135deg, rgba(139, 92, 246, 0.1) 0%, rgba(59, 130, 246, 0.1) 100%); border-radius: 8px; border: 1px solid var(--accent);">
                        <div style="display: flex; align-items: start; gap: 10px; margin-bottom: 10px;">
                            <div style="font-size: 1.5rem;">ğŸ¯</div>
                            <div style="flex: 1;">
                                <h4 style="margin: 0 0 8px 0; color: var(--accent); font-weight: 600;">ìŒì› ë¶„ì„ì´ ë…¸ë˜ ì œì‘ì— ë„ì›€ì´ ë˜ëŠ” ì´ìœ </h4>
                                <div style="color: var(--text-secondary); font-size: 0.9rem; line-height: 1.7;">
                                    <strong>âœ… ì‹¤ì œ ìŒì› ê¸°ë°˜ í”¼ë“œë°±:</strong> Gemini AIê°€ ì‹¤ì œ ìŒì› íŒŒì¼ì„ ë¶„ì„í•˜ì—¬ ê°ê´€ì ì¸ í‰ê°€ë¥¼ ì œê³µí•©ë‹ˆë‹¤.<br>
                                    <strong>âœ… ë‹¤ê°ë„ ë¶„ì„:</strong> ìŒì§ˆ, êµ¬ì¡°, ë³´ì»¬, ì§€ì‹œì–´ íš¨ê³¼ë¥¼ ì¢…í•©ì ìœ¼ë¡œ ë¶„ì„í•©ë‹ˆë‹¤.<br>
                                    <strong>âœ… êµ¬ì²´ì  ê°œì„  ì œì•ˆ:</strong> ë¬¸ì œì ê³¼ ê°œì„ ì•ˆì„ ì¹´í…Œê³ ë¦¬ë³„ë¡œ ì œì‹œí•˜ë©°, ê°œì„ ëœ ê°€ì‚¬/ì§€ì‹œì–´ ì˜ˆì‹œë¥¼ ì œê³µí•©ë‹ˆë‹¤.<br>
                                    <strong>âœ… ìë™ ë°˜ì˜:</strong> ë¶„ì„ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ChatGPTê°€ ê°€ì‚¬ì™€ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ë¥¼ ìë™ìœ¼ë¡œ ì¬ìƒì„±í•©ë‹ˆë‹¤.<br>
                                    <br>
                                    <strong>ğŸ’¡ í™œìš© íŒ:</strong> ì¤‘ê°„ ì ê²€ìš©ìœ¼ë¡œ í™œìš©í•˜ê±°ë‚˜, íŠ¹ì • ì„¹ì…˜ì´ ì–´ìƒ‰í•  ë•Œ ê°œì„  ì œì•ˆì„ í™•ì¸í•˜ì„¸ìš”. ì—¬ëŸ¬ ë²ˆ ë°˜ë³µí•˜ë©° ì ì§„ì ìœ¼ë¡œ ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Sunoì— ë³µì‚¬í•  ê°€ì‚¬ì™€ ìŠ¤íƒ€ì¼ -->
                    <div style="margin-bottom: 20px; padding: 15px; background: var(--bg-card); border-radius: 8px; border: 1px solid var(--border);">
                        <div style="margin-bottom: 15px;">
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <label style="font-weight: 600; color: var(--text-primary);">ğŸ“ Suno ê°€ì‚¬ë€ì— ë³µì‚¬í•  ë‚´ìš©:</label>
                                <button class="btn btn-small btn-primary" onclick="copyToClipboard('finalLyrics', 'ê°€ì‚¬', event)" style="font-size: 0.8rem;">
                                    ğŸ“‹ ë³µì‚¬
                                </button>
                            </div>
                            <div id="intermediateLyricsPreview" style="padding: 10px; background: var(--bg-input); border-radius: 6px; font-size: 0.85rem; color: var(--text-secondary); max-height: 150px; overflow-y: auto; white-space: pre-wrap; font-family: 'Consolas', 'Monaco', monospace;"></div>
                        </div>
                        <div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                                <label style="font-weight: 600; color: var(--text-primary);">ğŸ¨ Suno ìŠ¤íƒ€ì¼ë€ì— ë³µì‚¬í•  ë‚´ìš©:</label>
                                <button class="btn btn-small btn-primary" onclick="copyToClipboard('finalStyle', 'ìŠ¤íƒ€ì¼', event)" style="font-size: 0.8rem;">
                                    ğŸ“‹ ë³µì‚¬
                                </button>
                            </div>
                            <div id="intermediateStylePreview" style="padding: 10px; background: var(--bg-input); border-radius: 6px; font-size: 0.85rem; color: var(--text-secondary); max-height: 100px; overflow-y: auto; white-space: pre-wrap; font-family: 'Consolas', 'Monaco', monospace;"></div>
                        </div>
                        <div style="margin-top: 15px; padding: 10px; background: var(--accent); color: white; border-radius: 6px; text-align: center; font-size: 0.9rem;">
                            <a href="https://suno.com" target="_blank" style="color: white; text-decoration: underline; font-weight: 600;">ğŸŒ Suno ì›¹ì‚¬ì´íŠ¸ì—ì„œ ìŒì› ìƒì„±í•˜ê¸°</a>
                        </div>
                    </div>
                    
                    <div class="btn-group" style="flex-direction: column; gap: 10px;">
                        <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid var(--border);">
                            <label style="display: block; margin-bottom: 10px; font-weight: 600;">Sunoì—ì„œ ë‹¤ìš´ë¡œë“œí•œ ìŒì› ì—…ë¡œë“œ ë° ë¶„ì„</label>
                            <div class="audio-upload-area" onclick="const fileInput = document.getElementById('intermediateAudioFileInput'); if(fileInput) { fileInput.click(); } else { alert('âš ï¸ íŒŒì¼ ì…ë ¥ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'); }" style="cursor: pointer; padding: 20px; border: 2px dashed var(--border); border-radius: 8px; text-align: center; background: var(--bg-input);">
                                <input type="file" id="intermediateAudioFileInput" accept="audio/*" style="display: none;" onchange="if(typeof window.handleIntermediateAudioUpload === 'function') { window.handleIntermediateAudioUpload(event); } else { alert('âš ï¸ ìŒì› ì—…ë¡œë“œ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }">
                                <div style="font-size: 2rem; margin-bottom: 10px;">ğŸµ</div>
                                <div style="color: var(--text-secondary);">í´ë¦­í•˜ì—¬ ìŒì› íŒŒì¼ ì—…ë¡œë“œ</div>
                                <div style="font-size: 0.8rem; color: var(--text-secondary); margin-top: 5px;">MP3, WAV, M4A ë“± ì§€ì›</div>
                            </div>
                            <button class="btn btn-primary" id="analyzeIntermediateAudioBtn" onclick="if(typeof window.analyzeIntermediateAudio === 'function') { window.analyzeIntermediateAudio(); } else { alert('âš ï¸ ìŒì› ë¶„ì„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\\n\\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5) í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.'); }" style="width: 100%; margin-top: 10px; display: none;">
                                ğŸ” ìŒì› ë¶„ì„ ë° ìµœì¢… ê°€ì‚¬ ë°˜ì˜
                            </button>
                            <div id="intermediateVersionProgress" style="display: none; margin-top: 15px; padding: 15px; background: var(--bg-card); border-radius: 8px; border: 1px solid var(--border);"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ì œëª© ì¹´ë“œ (ì•„ë˜ë¡œ ì´ë™) -->
            <div class="card" style="margin-top: 20px; margin-bottom: 20px;">
                <div class="card-header">
                    <div class="card-icon">ğŸµ</div>
                    <div style="flex: 1;">
                        <h2 class="card-title">ê³¡ ì œëª©</h2>
                        <p class="card-subtitle">ë…¸ë˜ ì œëª©</p>
                    </div>
                </div>
                <div class="output-box" id="finalTitle" style="font-size: 1.2rem; font-weight: 600; padding: 15px; text-align: center; min-height: 50px; display: flex; align-items: center; justify-content: center;">
                    <span id="finalTitleText">ì œëª© ì—†ìŒ</span>
                </div>
                <div class="btn-group">
                    <button class="btn btn-success" onclick="copyTitleToClipboard(event)">
                        <i class="fas fa-copy"></i> ì œëª© ë³µì‚¬
                    </button>
                </div>
            </div>

            <!-- ìµœì¢… ê°€ì‚¬ ë° ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ (ì•„ë˜ë¡œ ì´ë™) -->
            <div class="two-column" style="margin-top: 20px;">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">ğŸ“</div>
                        <div>
                            <h2 class="card-title">ìµœì¢… ê°€ì‚¬ (ìˆ˜ë…¸ìš©)</h2>
                            <p class="card-subtitle">ìˆ˜ë…¸ AI ê°€ì‚¬ë€ì— ë¶™ì—¬ë„£ê¸°</p>
                        </div>
                        <button class="btn btn-small btn-save-step" onclick="saveCurrentProject(); showCopyIndicator('âœ… 5ë‹¨ê³„: ìµœì¢… ì¶œë ¥ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');" title="ì´ ë‹¨ê³„ ì €ì¥">
                            <i class="fas fa-save"></i> ì €ì¥
                        </button>
                    </div>
                    <div class="output-box" id="finalLyrics"></div>
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="showFinalComparison()" title="4ë‹¨ê³„ í™•ì • ë²„ì „ê³¼ 5ë‹¨ê³„ ìµœì¢… ë²„ì „ ë¹„êµ">
                            ğŸ” 4ë‹¨ê³„ vs 5ë‹¨ê³„ ë¹„êµ
                        </button>
                        <button class="btn btn-success" onclick="copyToClipboard('finalLyrics', 'ê°€ì‚¬', event)">ğŸ“‹ ê°€ì‚¬ ë³µì‚¬</button>
                        <button class="btn btn-primary" onclick="if(typeof window.copySunoLyricsAndStyle === 'function') { window.copySunoLyricsAndStyle(); }" title="ê°€ì‚¬+ìŠ¤íƒ€ì¼ì„ í•œ ë²ˆì— í´ë¦½ë³´ë“œì— ë³µì‚¬ (Suno ë¶™ì—¬ë„£ê¸°ìš©)">
                            ğŸµ Sunoìš© í•œ ë²ˆì— ë³µì‚¬
                        </button>
                    </div>
                    <div id="finalLyricsStatus" style="display: none; margin-top: 10px; padding: 10px; background: var(--bg-input); border-radius: 8px; font-size: 0.9rem;"></div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">ğŸ¨</div>
                        <div>
                            <h2 class="card-title">ìµœì¢… ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸</h2>
                            <p class="card-subtitle">ìˆ˜ë…¸ AI ìŠ¤íƒ€ì¼ë€ì— ë¶™ì—¬ë„£ê¸°</p>
                        </div>
                    </div>
                    <div class="output-box" id="finalStyle"></div>
                    <div class="btn-group">
                        <button class="btn btn-success" onclick="copyToClipboard('finalStyle', 'ìŠ¤íƒ€ì¼', event)">ğŸ“‹ ìŠ¤íƒ€ì¼ ë³µì‚¬</button>
                    </div>
                </div>
            </div>

            <div class="card" style="margin-top: 20px;">
                <div class="card-header">
                    <div class="card-icon">ğŸ“Š</div>
                    <div>
                        <h2 class="card-title">ìµœì¢… í‰ê°€ ìš”ì•½</h2>
                        <p class="card-subtitle">AI ê°œì„  í›„ ë³€í™”</p>
                    </div>
                </div>

                <div class="eval-summary two-column">
                    <div class="eval-score-card eval-before">
                        <div class="eval-score-label">ê°œì„  ì „</div>
                        <div class="eval-score-row">
                            <span class="eval-score-value" id="beforeScore">0</span>
                            <span class="eval-score-unit">ì </span>
                        </div>
                        <div class="eval-progress-wrap" aria-hidden="true">
                            <div class="eval-progress-bar" role="presentation">
                                <div class="eval-progress-fill" id="beforeScoreBar" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>
                    <div class="eval-score-card eval-after">
                        <div class="eval-score-label">ê°œì„  í›„</div>
                        <div class="eval-score-row">
                            <span class="eval-score-value" id="afterScore">0</span>
                            <span class="eval-score-unit">ì </span>
                            <span class="eval-grade-badge" id="finalGrade">-</span>
                        </div>
                        <div class="eval-progress-wrap" aria-hidden="true">
                            <div class="eval-progress-bar" role="presentation">
                                <div class="eval-progress-fill eval-after-fill" id="afterScoreBar" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="margin-top: 15px; padding: 15px; background: var(--bg-input); border-radius: 10px;">
                    <h4 style="margin-bottom: 8px;">ğŸ¤– AI ìµœì¢… ì½”ë©˜íŠ¸</h4>
                    <p id="aiComment" style="color: var(--text-secondary); line-height: 1.6; font-size: 0.9rem;"></p>
                </div>
            </div>

            <div class="btn-group" style="justify-content: center; margin-top: 20px;">
                <button class="btn btn-secondary" onclick="goToStep(4)">â† ì´ì „</button>
                <button class="btn btn-primary" onclick="goToMarketingStep()" id="goToMarketingBtn"><i class="fas fa-arrow-right"></i> ë‹¤ìŒ ë‹¨ê³„ë¡œ</button>
            </div>
            <div class="step-footer">
                <p>ğŸµ Music Creator - AI ê°€ì‚¬ & ìˆ˜ë…¸ í”„ë¡¬í”„íŠ¸ & ë§ˆì¼€íŒ… ìë£Œ ìƒì„±ê¸°</p>
                <p>Powered by Google Gemini AI & ChatGPT âœ¨ | ë®¤ì§ëª¨ë¦¬ ì±„ë„</p>
            </div>
        </div>

        <!-- Panel 6: ë§ˆì¼€íŒ… ìë£Œ -->
        <div class="panel" id="panel6">
            <div class="loading" id="marketingLoading">
                <div class="spinner"></div>
                <p class="loading-text">ğŸ¤– Gemini AIê°€ ë§ˆì¼€íŒ… ìë£Œë¥¼ ìƒì„± ì¤‘ì…ë‹ˆë‹¤...</p>
                <p class="loading-subtext">ìœ íŠœë¸Œ, í‹±í†¡, í•´ì‹œíƒœê·¸, ì¸ë„¤ì¼, MV í”„ë¡¬í”„íŠ¸, ìë§‰ íŒŒì¼ ìƒì„± ì¤‘</p>
            </div>

            <div id="marketingResult" style="display: none;">
                <div class="card">
                    <div class="card-header">
                        <div class="card-icon">ğŸ“¢</div>
                        <div>
                            <h2 class="card-title">ë§ˆì¼€íŒ… ìë£Œ <span class="ai-badge">ğŸ¤– Gemini</span></h2>
                            <p class="card-subtitle">ë®¤ì§ëª¨ë¦¬ ì±„ë„ìš© ë§ˆì¼€íŒ… ì½˜í…ì¸ </p>
                        </div>
                        <button class="btn btn-small btn-save-step" onclick="saveCurrentProject(); showCopyIndicator('âœ… 6ë‹¨ê³„: ë§ˆì¼€íŒ… ìë£Œê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!');" title="ì´ ë‹¨ê³„ ì €ì¥">
                            <i class="fas fa-save"></i> ì €ì¥
                        </button>
                    </div>

                    <div class="marketing-tabs" role="tablist">
                        <button type="button" class="marketing-tab active" role="tab" data-tab="youtube" onclick="showMarketingTab('youtube')" aria-selected="true">ìœ íŠœë¸Œ ì„¤ëª…ë€</button>
                        <button type="button" class="marketing-tab" role="tab" data-tab="tiktok" onclick="showMarketingTab('tiktok')" aria-selected="false">í‹±í†¡ ì„¤ëª…ë€</button>
                        <button type="button" class="marketing-tab" role="tab" data-tab="hashtags" onclick="showMarketingTab('hashtags')" aria-selected="false">í•´ì‹œíƒœê·¸</button>
                        <button type="button" class="marketing-tab" role="tab" data-tab="thumbnails" onclick="showMarketingTab('thumbnails')" aria-selected="false">ì¸ë„¤ì¼ ë¬¸êµ¬</button>
                        <button type="button" class="marketing-tab" role="tab" data-tab="mv" onclick="showMarketingTab('mv')" aria-selected="false">MV í”„ë¡¬í”„íŠ¸</button>
                        <button type="button" class="marketing-tab" role="tab" data-tab="srt" onclick="showMarketingTab('srt')" aria-selected="false">SRT ìë§‰</button>
                        <button type="button" class="marketing-tab" role="tab" data-tab="upload" onclick="showMarketingTab('upload')" aria-selected="false">ì—…ë¡œë“œ ê°€ì´ë“œ</button>
                    </div>

                    <!-- YouTube -->
                    <div class="marketing-content active" id="marketing-youtube">
                        <div class="output-box" id="youtubeDesc"></div>
                        <div class="btn-group">
                            <button class="btn btn-success" onclick="copyToClipboard('youtubeDesc', 'ìœ íŠœë¸Œ ì„¤ëª…', event)"><i class="fas fa-copy"></i> ë³µì‚¬</button>
                        </div>
                    </div>

                    <!-- TikTok -->
                    <div class="marketing-content" id="marketing-tiktok">
                        <div class="output-box" id="tiktokDesc"></div>
                        <div class="btn-group">
                            <button class="btn btn-success" onclick="copyToClipboard('tiktokDesc', 'í‹±í†¡ ì„¤ëª…', event)"><i class="fas fa-copy"></i> ë³µì‚¬</button>
                        </div>
                    </div>

                    <!-- Hashtags -->
                    <div class="marketing-content" id="marketing-hashtags">
                        <div class="output-box" id="hashtagsContent"></div>
                        <div class="btn-group">
                            <button class="btn btn-success" onclick="copyToClipboard('hashtagsContent', 'í•´ì‹œíƒœê·¸', event)"><i class="fas fa-copy"></i> ë³µì‚¬</button>
                        </div>
                    </div>

                    <!-- Thumbnails -->
                    <div class="marketing-content" id="marketing-thumbnails">
                        <div class="thumbnail-grid" id="thumbnailsGrid"></div>
                    </div>

                    <!-- MV Prompts -->
                    <div class="marketing-content" id="marketing-mv">
                        <!-- MV Settings -->
                        <div class="mv-settings">
                            <h4>ë®¤ì§ë¹„ë””ì˜¤ ì„¤ì •</h4>
                            <div class="mv-settings-grid">
                                <div class="form-group">
                                    <label for="mvMinutes">ë…¸ë˜ ì´ ê¸¸ì´</label>
                                    <div class="time-input-group">
                                        <input type="number" id="mvMinutes" min="0" max="10" value="3" placeholder="ë¶„" oninput="if(typeof updateMVImageCount==='function')updateMVImageCount()" onchange="if(typeof updateMVImageCount==='function')updateMVImageCount()">
                                        <span>:</span>
                                        <input type="number" id="mvSeconds" min="0" max="59" value="30" placeholder="ì´ˆ" oninput="if(typeof updateMVImageCount==='function')updateMVImageCount()" onchange="if(typeof updateMVImageCount==='function')updateMVImageCount()">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="mvInterval">ì´ë¯¸ì§€ë‹¹ ì´ˆ (ì¥ë©´ ì „í™˜ ê°„ê²©)</label>
                                    <select id="mvInterval" class="mv-interval-select" onchange="if(typeof updateMVImageCount==='function')updateMVImageCount()">
                                        <option value="2">2ì´ˆ (ë¹ ë¥¸ ì „í™˜)</option>
                                        <option value="4">4ì´ˆ</option>
                                        <option value="6">6ì´ˆ</option>
                                        <option value="8" selected>8ì´ˆ (ê¶Œì¥)</option>
                                        <option value="10">10ì´ˆ</option>
                                        <option value="15">15ì´ˆ (ëŠë¦° ì „í™˜)</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>ì˜ˆìƒ ì´ë¯¸ì§€ ìˆ˜</label>
                                    <div class="mv-calc-result" id="mvCalcResult">
                                        <span id="mvImageCount">27</span>ì¥
                                    </div>
                                </div>
                            </div>
                            <!-- MV í”„ë¡¬í”„íŠ¸ ìƒì„¸ ì„¤ì • -->
                            <div class="mv-detail-block">
                                <h4>MV í”„ë¡¬í”„íŠ¸ ìƒì„¸ ì„¤ì •</h4>
                                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px;">
                                    <div class="form-group">
                                        <label style="display: block; margin-bottom: 8px; font-size: 0.9rem; color: var(--text-primary); font-weight: 600;">â° ì‹œëŒ€</label>
                                        <select id="mvEra" class="mv-setting-select" onchange="saveMVSettings()">
                                            <option value="">ì„ íƒ ì•ˆ í•¨</option>
                                            <option value="modern">í˜„ëŒ€ (2020ë…„ëŒ€)</option>
                                            <option value="2010s">2010ë…„ëŒ€</option>
                                            <option value="2000s">2000ë…„ëŒ€</option>
                                            <option value="1990s">1990ë…„ëŒ€</option>
                                            <option value="1980s">1980ë…„ëŒ€</option>
                                            <option value="1970s">1970ë…„ëŒ€</option>
                                            <option value="1960s">1960ë…„ëŒ€</option>
                                            <option value="1950s">1950ë…„ëŒ€</option>
                                            <option value="vintage">ë¹ˆí‹°ì§€ (ë³µê³ í’)</option>
                                            <option value="future">ë¯¸ë˜</option>
                                            <option value="timeless">ì‹œëŒ€ ë¶ˆëª… (ì‹œëŒ€ì  íŠ¹ì„± ì—†ìŒ)</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label style="display: block; margin-bottom: 8px; font-size: 0.9rem; color: var(--text-primary); font-weight: 600;">ğŸŒ ë‚˜ë¼/ì§€ì—­</label>
                                        <select id="mvCountry" class="mv-setting-select" onchange="saveMVSettings()">
                                            <option value="">ì„ íƒ ì•ˆ í•¨</option>
                                            <option value="korea">í•œêµ­</option>
                                            <option value="japan">ì¼ë³¸</option>
                                            <option value="china">ì¤‘êµ­</option>
                                            <option value="usa">ë¯¸êµ­</option>
                                            <option value="uk">ì˜êµ­</option>
                                            <option value="france">í”„ë‘ìŠ¤</option>
                                            <option value="italy">ì´íƒˆë¦¬ì•„</option>
                                            <option value="spain">ìŠ¤í˜ì¸</option>
                                            <option value="germany">ë…ì¼</option>
                                            <option value="europe">ìœ ëŸ½ (ì¼ë°˜)</option>
                                            <option value="asia">ì•„ì‹œì•„ (ì¼ë°˜)</option>
                                            <option value="latin">ë¼í‹´ ì•„ë©”ë¦¬ì¹´</option>
                                            <option value="middle-east">ì¤‘ë™</option>
                                            <option value="africa">ì•„í”„ë¦¬ì¹´</option>
                                            <option value="generic">ì§€ì—­ ë¶ˆëª… (ì¼ë°˜ì  ë°°ê²½)</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label style="display: block; margin-bottom: 8px; font-size: 0.9rem; color: var(--text-primary); font-weight: 600;">ğŸ“ ì¥ì†Œ ìœ í˜• (ë°°ê²½, ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥)</label>
                                        <div class="tag-container mv-setting-tags" id="mvLocationTags" style="max-height: 200px; overflow-y: auto; padding: 10px; background: var(--bg-input); border-radius: 8px; border: 1px solid var(--border);">
                                            <button type="button" class="tag-btn" data-value="city">ë„ì‹œ (ë„ì‹¬, ê±°ë¦¬)</button>
                                            <button type="button" class="tag-btn" data-value="urban-night">ë„ì‹œ ì•¼ê²½ (ë„¤ì˜¨)</button>
                                            <button type="button" class="tag-btn" data-value="beach">í•´ë³€</button>
                                            <button type="button" class="tag-btn" data-value="mountain">ì‚°, ìì—°</button>
                                            <button type="button" class="tag-btn" data-value="forest">ìˆ²</button>
                                            <button type="button" class="tag-btn" data-value="desert">ì‚¬ë§‰</button>
                                            <button type="button" class="tag-btn" data-value="indoor">ì‹¤ë‚´ (ë°©, ìŠ¤íŠœë””ì˜¤)</button>
                                            <button type="button" class="tag-btn" data-value="rooftop">ì˜¥ìƒ</button>
                                            <button type="button" class="tag-btn" data-value="subway">ì§€í•˜ì² , ì§€í•˜</button>
                                            <button type="button" class="tag-btn" data-value="cafe">ì¹´í˜</button>
                                            <button type="button" class="tag-btn" data-value="restaurant">ë ˆìŠ¤í† ë‘</button>
                                            <button type="button" class="tag-btn" data-value="park">ê³µì›</button>
                                            <button type="button" class="tag-btn" data-value="bridge">ë‹¤ë¦¬</button>
                                            <button type="button" class="tag-btn" data-value="warehouse">ì°½ê³ , ê³µì¥</button>
                                            <button type="button" class="tag-btn" data-value="abandoned">ë²„ë ¤ì§„ ì¥ì†Œ</button>
                                            <button type="button" class="tag-btn" data-value="abstract">ì¶”ìƒì  ë°°ê²½</button>
                                            <button type="button" class="tag-btn" data-value="river">ê°•, ê°•ë³€</button>
                                            <button type="button" class="tag-btn" data-value="lake">í˜¸ìˆ˜</button>
                                            <button type="button" class="tag-btn" data-value="sea">ë°”ë‹¤, í•´ìƒ</button>
                                            <button type="button" class="tag-btn" data-value="sky">í•˜ëŠ˜, êµ¬ë¦„</button>
                                            <button type="button" class="tag-btn" data-value="street">ê±°ë¦¬, ê³¨ëª©</button>
                                            <button type="button" class="tag-btn" data-value="alley">ê³¨ëª©ê¸¸</button>
                                            <button type="button" class="tag-btn" data-value="building">ë¹Œë”©, ê±´ë¬¼</button>
                                            <button type="button" class="tag-btn" data-value="rooftop-night">ì˜¥ìƒ ì•¼ê²½</button>
                                            <button type="button" class="tag-btn" data-value="station">ì—­, í„°ë¯¸ë„</button>
                                            <button type="button" class="tag-btn" data-value="airport">ê³µí•­</button>
                                            <button type="button" class="tag-btn" data-value="car">ì°¨ ì•ˆ, ì´ë™ ìˆ˜ë‹¨</button>
                                            <button type="button" class="tag-btn" data-value="train">ê¸°ì°¨ ì•ˆ</button>
                                            <button type="button" class="tag-btn" data-value="bar">ë°”, í</button>
                                            <button type="button" class="tag-btn" data-value="club">í´ëŸ½, ë‚˜ì´íŠ¸</button>
                                            <button type="button" class="tag-btn" data-value="concert">ê³µì—°ì¥, ë¼ì´ë¸Œ</button>
                                            <button type="button" class="tag-btn" data-value="school">í•™êµ, êµì‹¤</button>
                                            <button type="button" class="tag-btn" data-value="library">ë„ì„œê´€</button>
                                            <button type="button" class="tag-btn" data-value="museum">ë¯¸ìˆ ê´€, ë°•ë¬¼ê´€</button>
                                            <button type="button" class="tag-btn" data-value="church">êµíšŒ, ì„±ë‹¹</button>
                                            <button type="button" class="tag-btn" data-value="temple">ì‚¬ì°°, ì ˆ</button>
                                            <button type="button" class="tag-btn" data-value="hospital">ë³‘ì›</button>
                                            <button type="button" class="tag-btn" data-value="hotel">í˜¸í…”, ë¡œë¹„</button>
                                            <button type="button" class="tag-btn" data-value="bedroom">ì¹¨ì‹¤, ì¹¨ëŒ€</button>
                                            <button type="button" class="tag-btn" data-value="kitchen">ì£¼ë°©</button>
                                            <button type="button" class="tag-btn" data-value="bathroom">ìš•ì‹¤</button>
                                            <button type="button" class="tag-btn" data-value="balcony">ë°œì½”ë‹ˆ, í…Œë¼ìŠ¤</button>
                                            <button type="button" class="tag-btn" data-value="garden">ì •ì›, ëœ°</button>
                                            <button type="button" class="tag-btn" data-value="farm">ë†ì¥, ë“¤íŒ</button>
                                            <button type="button" class="tag-btn" data-value="vineyard">í¬ë„ë°­</button>
                                            <button type="button" class="tag-btn" data-value="snow">ëˆˆ, ì„¤ì›</button>
                                            <button type="button" class="tag-btn" data-value="rain">ë¹„, ë¹—ì†</button>
                                            <button type="button" class="tag-btn" data-value="sunset">ì¼ëª°, ì„ì–‘</button>
                                            <button type="button" class="tag-btn" data-value="sunrise">ì¼ì¶œ</button>
                                            <button type="button" class="tag-btn" data-value="night-sky">ë°¤í•˜ëŠ˜, ë³„</button>
                                            <button type="button" class="tag-btn" data-value="underwater">ìˆ˜ì¤‘, ë¬¼ì†</button>
                                            <button type="button" class="tag-btn" data-value="stadium">ê²½ê¸°ì¥, ìŠ¤íƒ€ë””ì›€</button>
                                            <button type="button" class="tag-btn" data-value="parking">ì£¼ì°¨ì¥</button>
                                            <button type="button" class="tag-btn" data-value="bridge-night">ë‹¤ë¦¬ ì•¼ê²½</button>
                                            <button type="button" class="tag-btn" data-value="rooftop-pool">ë£¨í”„íƒ‘ í’€</button>
                                            <button type="button" class="tag-btn" data-value="rooftop-garden">ì˜¥ìƒ ì •ì›</button>
                                        </div>
                                        <p style="margin: 8px 0 0 0; font-size: 0.75rem; color: var(--text-secondary);">ì„ íƒí•œ ì¥ì†Œ ìœ í˜•ì´ ê° ì”¬ í”„ë¡¬í”„íŠ¸ ë°°ê²½ì— ë°˜ì˜ë©ë‹ˆë‹¤.</p>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label style="display: block; margin-bottom: 8px; font-size: 0.9rem; color: var(--text-primary); font-weight: 600;">ğŸ‘¥ ì¸ë¬¼ ìˆ˜</label>
                                        <select id="mvCharacterCount" class="mv-setting-select" onchange="updateCharacterInputs(); saveMVSettings();">
                                            <option value="1" selected>1ì¸</option>
                                            <option value="2">2ì¸</option>
                                            <option value="3">3ì¸ ì´ìƒ</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label style="display: block; margin-bottom: 8px; font-size: 0.9rem; color: var(--text-primary); font-weight: 600;">ğŸ’¡ ì¡°ëª…</label>
                                        <select id="mvLighting" class="mv-setting-select" onchange="saveMVSettings()">
                                            <option value="">ì„ íƒ ì•ˆ í•¨</option>
                                            <option value="natural">ìì—°ê´‘</option>
                                            <option value="soft">ë¶€ë“œëŸ¬ìš´ ì¡°ëª…</option>
                                            <option value="dramatic">ë“œë¼ë§ˆí‹±í•œ ì¡°ëª…</option>
                                            <option value="warm">ë”°ëœ»í•œ ì¡°ëª…</option>
                                            <option value="cool">ì°¨ê°€ìš´ ì¡°ëª…</option>
                                            <option value="neon">ë„¤ì˜¨ ì¡°ëª…</option>
                                            <option value="golden-hour">ê³¨ë“  ì•„ì›Œ</option>
                                            <option value="blue-hour">ë¸”ë£¨ ì•„ì›Œ</option>
                                            <option value="studio">ìŠ¤íŠœë””ì˜¤ ì¡°ëª…</option>
                                            <option value="cinematic">ì‹œë„¤ë§ˆí‹± ì¡°ëª…</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label style="display: block; margin-bottom: 8px; font-size: 0.9rem; color: var(--text-primary); font-weight: 600;">ğŸ“· ì¹´ë©”ë¼ ì›Œí¬</label>
                                        <select id="mvCameraWork" class="mv-setting-select" onchange="saveMVSettings()">
                                            <option value="">ì„ íƒ ì•ˆ í•¨</option>
                                            <option value="close-up">í´ë¡œì¦ˆì—…</option>
                                            <option value="wide-shot">ì™€ì´ë“œ ìƒ·</option>
                                            <option value="medium-shot">ë¯¸ë””ì—„ ìƒ·</option>
                                            <option value="dolly">ëŒë¦¬ ì´¬ì˜</option>
                                            <option value="tracking">íŠ¸ë˜í‚¹ ì´¬ì˜</option>
                                            <option value="pan">íŒ¬ ì´¬ì˜</option>
                                            <option value="tilt">í‹¸íŠ¸ ì´¬ì˜</option>
                                            <option value="handheld">í•¸ë“œí—¬ë“œ</option>
                                            <option value="steady-cam">ìŠ¤í…Œë””ìº </option>
                                            <option value="drone">ë“œë¡  ì´¬ì˜</option>
                                        </select>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label style="display: block; margin-bottom: 8px; font-size: 0.9rem; color: var(--text-primary); font-weight: 600;">ğŸ­ ë¶„ìœ„ê¸°</label>
                                        <select id="mvMood" class="mv-setting-select" onchange="saveMVSettings()">
                                            <option value="">ì„ íƒ ì•ˆ í•¨</option>
                                            <option value="romantic">ë¡œë§¨í‹±</option>
                                            <option value="melancholic">ë©œë‘ê¼´ë¦­</option>
                                            <option value="energetic">ì—ë„ˆì œí‹±</option>
                                            <option value="peaceful">í‰í™”ë¡œìš´</option>
                                            <option value="mysterious">ì‹ ë¹„ë¡œìš´</option>
                                            <option value="nostalgic">ë…¸ìŠ¤íƒ¤ì§€ì–´</option>
                                            <option value="dramatic">ë“œë¼ë§ˆí‹±</option>
                                            <option value="dreamy">ë“œë¦¬ë¯¸</option>
                                            <option value="intense">ê°•ë ¬í•œ</option>
                                            <option value="gentle">ë¶€ë“œëŸ¬ìš´</option>
                                        </select>
                                    </div>
                                </div>
                                
                                <!-- ì¸ë¬¼ ì •ë³´ ì…ë ¥ -->
                                <div id="mvCharacterInputs" style="margin-top: 20px;">
                                    <!-- ì¸ë¬¼ ì •ë³´ëŠ” JavaScriptë¡œ ë™ì  ìƒì„± -->
                                </div>
                                
                                <!-- ê¸°íƒ€ í•­ëª© ì…ë ¥ -->
                                <div style="margin-top: 20px; padding: 15px; background: var(--bg-card); border-radius: 8px; border: 1px solid var(--border);">
                                    <label style="display: block; margin-bottom: 10px; font-size: 0.9rem; color: var(--text-primary); font-weight: 600;">
                                        âœï¸ ê¸°íƒ€ í•­ëª© (ìˆ˜ê¸° ì‘ì„±)
                                    </label>
                                    <textarea 
                                        id="mvCustomSettings" 
                                        placeholder="ì˜ˆ: íŠ¹ë³„í•œ ë¶„ìœ„ê¸°, ìƒ‰ê°, ì¡°ëª…, ì†Œí’ˆ, ì˜ìƒ ìŠ¤íƒ€ì¼ ë“±ì„ ììœ ë¡­ê²Œ ì‘ì„±í•˜ì„¸ìš”.&#10;ì´ ë‚´ìš©ì€ í†µí•©/ë°°ê²½/ì¸ë¬¼ í”„ë¡¬í”„íŠ¸ì— ë°˜ì˜ë©ë‹ˆë‹¤."
                                        style="width: 100%; min-height: 100px; padding: 12px; background: var(--bg-input); border: 1px solid var(--border); border-radius: 6px; font-family: inherit; font-size: 0.9rem; color: var(--text-primary); resize: vertical;"
                                        onchange="saveMVSettings()"
                                        oninput="saveMVSettings()"
                                    ></textarea>
                                    <p style="margin: 8px 0 0 0; font-size: 0.75rem; color: var(--text-secondary);">
                                        ğŸ’¡ íŠ¹ë³„í•œ ìš”êµ¬ì‚¬í•­ì´ë‚˜ ì¶”ê°€ ì„¤ëª…ì„ ì‘ì„±í•˜ë©´ ëª¨ë“  í”„ë¡¬í”„íŠ¸ì— ë°˜ì˜ë©ë‹ˆë‹¤.
                                    </p>
                                </div>
                            </div>
                            <div class="btn-group">
                                <button class="btn btn-primary" id="mvGenerateBtn" onclick="handleMVGenerateClick(event)"><span class="mv-generate-btn-text">ğŸ¬ MV í”„ë¡¬í”„íŠ¸ ìƒì„±</span></button>
                            </div>
                        </div>

                        <!-- MV Loading (ë²„íŠ¼ í´ë¦­ ì‹œì—ë§Œ í‘œì‹œ) -->
                        <div class="loading mv-loading-box" id="mvLoading" style="display: none;">
                            <div class="spinner"></div>
                            <p class="loading-text">ğŸ¤– AIê°€ MV í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„± ì¤‘...</p>
                            <p class="loading-subtext">ê°€ì‚¬ ìŠ¤í† ë¦¬ì— ë§ëŠ” ì¥ë©´ì„ êµ¬ì„±í•˜ê³  ìˆìŠµë‹ˆë‹¤. ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš”.</p>
                        </div>

                        <!-- Scene Overview Editor (ì”¬ë³„ ê°œìš” ìˆ˜ì •) -->
                        <div id="mvSceneOverviewSection" style="display: none;">
                            <div style="background: var(--bg-card); border-radius: 10px; padding: 20px; margin-bottom: 20px; border: 2px solid var(--accent);">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                    <h3 style="margin: 0; color: var(--text-primary); font-size: 1.2rem;">
                                        ğŸ¬ ì”¬ë³„ ê°œìš” ìˆ˜ì • ë° í™•ì •
                                    </h3>
                                </div>
                                <p style="margin: 0 0 20px 0; color: var(--text-secondary); font-size: 0.9rem; line-height: 1.6;">
                                    ê° ì”¬ì˜ ë°°ê²½, ì¸ë¬¼, ì¥ì†Œ ë“±ì„ í™•ì¸í•˜ê³  ìˆ˜ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ìˆ˜ì • í›„ "ì €ì¥" ë²„íŠ¼ì„ í´ë¦­í•˜ê³ , ëª¨ë“  ì”¬ì„ í™•ì¸í•œ í›„ "í™•ì • ë° í”„ë¡¬í”„íŠ¸ ìƒì„±" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.
                                </p>
                                <div id="mvSceneOverviewContainer" style="max-height: 600px; overflow-y: auto; margin-bottom: 20px;"></div>
                                <div class="btn-group" style="justify-content: center;">
                                    <button class="btn btn-success" onclick="saveAndConfirmMVPrompts()" style="padding: 12px 24px; font-size: 1rem; font-weight: 600;">
                                        ğŸ’¾ ì €ì¥ ë° í™•ì •
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- MV Results -->
                        <div id="mvResultsSection" style="display: none;">
                            <div id="mvPromptsWarning" style="display: none;"></div>
                            <div class="mv-info-bar">
                                <span>ğŸ¬ ì´ <strong id="mvTotalImages">0</strong>ì¥ì˜ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸</span>
                                <span>â±ï¸ ë…¸ë˜ ê¸¸ì´: <strong id="mvTotalDuration">0:00</strong></span>
                                <span>ğŸ–¼ï¸ ì¥ë©´ ì „í™˜: <strong id="mvIntervalDisplay">8</strong>ì´ˆ</span>
                            </div>
                            
                            <!-- ì¸ë„¤ì¼/ë°°ê²½/ì¸ë¬¼ í”„ë¡¬í”„íŠ¸ ì„¹ì…˜ -->
                            <div style="margin-bottom: 30px; padding: 20px; background: var(--bg-card); border-radius: 10px; border: 2px solid var(--primary);">
                                <h3 style="margin: 0 0 20px 0; color: var(--text-primary); font-size: 1.1rem;">ğŸ–¼ï¸ ì¸ë„¤ì¼/ë°°ê²½/ì¸ë¬¼ í”„ë¡¬í”„íŠ¸</h3>
                                
                                <div style="display: grid; grid-template-columns: 1fr; gap: 15px;">
                                    <!-- ì¸ë„¤ì¼ í”„ë¡¬í”„íŠ¸ -->
                                    <div style="padding: 15px; background: var(--bg-input); border-radius: 8px; border: 1px solid var(--border);">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                            <label style="font-weight: 600; color: var(--text-primary); font-size: 0.95rem;">
                                                ğŸ¬ ì¸ë„¤ì¼ ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸
                                            </label>
                                            <div class="btn-group" style="gap: 6px;">
                                                <button type="button" class="btn btn-small btn-primary" onclick="regenerateMVPrompt('thumbnail')" style="padding: 6px 12px; font-size: 0.8rem;"><i class="fas fa-sync-alt"></i> ì¬ìƒì„±</button>
                                                <button type="button" class="btn btn-small btn-secondary" onclick="focusMVPromptTextarea('thumbnail')" style="padding: 6px 12px; font-size: 0.8rem;"><i class="fas fa-edit"></i> ìˆ˜ì •</button>
                                                <button type="button" id="copyMVThumbnailBtn" class="btn btn-small btn-success" onclick="copyMVPromptEn('thumbnail', event)" title="ì˜ì–´ í”„ë¡¬í”„íŠ¸ ë³µì‚¬ (Midjourneyìš©)" style="padding: 6px 12px; font-size: 0.8rem;"><i class="fas fa-copy"></i> ë³µì‚¬</button>
                                            </div>
                                        </div>
                                        <div style="margin-bottom: 5px;">
                                            <label style="font-size: 0.85rem; color: var(--text-secondary);">ì˜ì–´ í”„ë¡¬í”„íŠ¸</label>
                                        </div>
                                        <textarea 
                                            id="mvThumbnailPromptEn" 
                                            style="width: 100%; min-height: 80px; padding: 10px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 6px; font-family: monospace; font-size: 0.85rem; color: var(--text-primary); resize: vertical;"
                                            onchange="syncMVPromptTranslation('thumbnail', 'en')"
                                            placeholder="ì¸ë„¤ì¼ ì´ë¯¸ì§€ ì˜ì–´ í”„ë¡¬í”„íŠ¸..."
                                        ></textarea>
                                        <label style="display: block; margin-top: 8px; margin-bottom: 5px; font-size: 0.85rem; color: var(--text-secondary);">í•œê¸€ ë²ˆì—­ë³¸</label>
                                        <textarea 
                                            id="mvThumbnailPromptKo" 
                                            style="width: 100%; min-height: 80px; padding: 10px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 6px; font-family: inherit; font-size: 0.85rem; color: var(--text-primary); resize: vertical;"
                                            onchange="syncMVPromptTranslation('thumbnail', 'ko')"
                                            placeholder="ì¸ë„¤ì¼ ì´ë¯¸ì§€ í•œê¸€ í”„ë¡¬í”„íŠ¸..."
                                        ></textarea>
                                    </div>
                                    
                                    <!-- ë°°ê²½ í”„ë¡¬í”„íŠ¸ (ìƒì„¸) -->
                                    <div style="padding: 15px; background: var(--bg-input); border-radius: 8px; border: 1px solid var(--border);">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                            <label style="font-weight: 600; color: var(--text-primary); font-size: 0.95rem;">
                                                ğŸï¸ ë°°ê²½ í”„ë¡¬í”„íŠ¸ (ìƒì„¸)
                                            </label>
                                            <div class="btn-group" style="gap: 6px;">
                                                <button type="button" class="btn btn-small btn-primary" onclick="regenerateMVPrompt('background')" style="padding: 6px 12px; font-size: 0.8rem;"><i class="fas fa-sync-alt"></i> ì¬ìƒì„±</button>
                                                <button type="button" class="btn btn-small btn-secondary" onclick="focusMVPromptTextarea('background')" style="padding: 6px 12px; font-size: 0.8rem;"><i class="fas fa-edit"></i> ìˆ˜ì •</button>
                                                <button type="button" id="copyMVBackgroundBtn" class="btn btn-small btn-success" onclick="copyMVPromptEn('background', event)" title="ì˜ì–´ í”„ë¡¬í”„íŠ¸ ë³µì‚¬ (Midjourneyìš©)" style="padding: 6px 12px; font-size: 0.8rem;"><i class="fas fa-copy"></i> ë³µì‚¬</button>
                                            </div>
                                        </div>
                                        <div style="margin-bottom: 5px;">
                                            <label style="font-size: 0.85rem; color: var(--text-secondary);">ì˜ì–´ í”„ë¡¬í”„íŠ¸</label>
                                        </div>
                                        <textarea 
                                            id="mvBackgroundDetailPromptEn" 
                                            style="width: 100%; min-height: 80px; padding: 10px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 6px; font-family: monospace; font-size: 0.85rem; color: var(--text-primary); resize: vertical;"
                                            onchange="syncMVPromptTranslation('backgroundDetail', 'en')"
                                            placeholder="ë°°ê²½ ì˜ì–´ í”„ë¡¬í”„íŠ¸..."
                                        ></textarea>
                                        <label style="display: block; margin-top: 8px; margin-bottom: 5px; font-size: 0.85rem; color: var(--text-secondary);">í•œê¸€ ë²ˆì—­ë³¸</label>
                                        <textarea 
                                            id="mvBackgroundDetailPromptKo" 
                                            style="width: 100%; min-height: 80px; padding: 10px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 6px; font-family: inherit; font-size: 0.85rem; color: var(--text-primary); resize: vertical;"
                                            onchange="syncMVPromptTranslation('backgroundDetail', 'ko')"
                                            placeholder="ë°°ê²½ í•œê¸€ í”„ë¡¬í”„íŠ¸..."
                                        ></textarea>
                                    </div>
                                    
                                    <!-- ì¸ë¬¼ í”„ë¡¬í”„íŠ¸ (ìƒì„¸) -->
                                    <div style="padding: 15px; background: var(--bg-input); border-radius: 8px; border: 1px solid var(--border);">
                                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                            <label style="font-weight: 600; color: var(--text-primary); font-size: 0.95rem;">
                                                ğŸ‘¤ ì¸ë¬¼ í”„ë¡¬í”„íŠ¸ (ìƒì„¸)
                                            </label>
                                            <div class="btn-group" style="gap: 6px;">
                                                <button type="button" class="btn btn-small btn-primary" onclick="regenerateMVPrompt('character')" style="padding: 6px 12px; font-size: 0.8rem;"><i class="fas fa-sync-alt"></i> ì¬ìƒì„±</button>
                                                <button type="button" class="btn btn-small btn-secondary" onclick="focusMVPromptTextarea('character')" style="padding: 6px 12px; font-size: 0.8rem;"><i class="fas fa-edit"></i> ìˆ˜ì •</button>
                                                <button type="button" id="copyMVCharacterBtn" class="btn btn-small btn-success" onclick="copyMVPromptEn('character', event)" title="ì˜ì–´ í”„ë¡¬í”„íŠ¸ ë³µì‚¬ (Midjourneyìš©)" style="padding: 6px 12px; font-size: 0.8rem;"><i class="fas fa-copy"></i> ë³µì‚¬</button>
                                            </div>
                                        </div>
                                        <div style="margin-bottom: 5px;">
                                            <label style="font-size: 0.85rem; color: var(--text-secondary);">ì˜ì–´ í”„ë¡¬í”„íŠ¸</label>
                                        </div>
                                        <textarea 
                                            id="mvCharacterDetailPromptEn" 
                                            style="width: 100%; min-height: 80px; padding: 10px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 6px; font-family: monospace; font-size: 0.85rem; color: var(--text-primary); resize: vertical;"
                                            onchange="syncMVPromptTranslation('characterDetail', 'en')"
                                            placeholder="ì¸ë¬¼ ì˜ì–´ í”„ë¡¬í”„íŠ¸..."
                                        ></textarea>
                                        <label style="display: block; margin-top: 8px; margin-bottom: 5px; font-size: 0.85rem; color: var(--text-secondary);">í•œê¸€ ë²ˆì—­ë³¸</label>
                                        <textarea 
                                            id="mvCharacterDetailPromptKo" 
                                            style="width: 100%; min-height: 80px; padding: 10px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 6px; font-family: inherit; font-size: 0.85rem; color: var(--text-primary); resize: vertical;"
                                            onchange="syncMVPromptTranslation('characterDetail', 'ko')"
                                            placeholder="ì¸ë¬¼ í•œê¸€ í”„ë¡¬í”„íŠ¸..."
                                        ></textarea>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- ê°œë³„ ì”¬ í”„ë¡¬í”„íŠ¸ -->
                            <div style="margin-bottom: 20px;">
                                <h3 style="margin: 0 0 15px 0; color: var(--text-primary); font-size: 1.1rem;">ğŸ¬ ì”¬ë³„ ê°œë³„ í”„ë¡¬í”„íŠ¸</h3>
                                <div id="mvPromptsContainer"></div>
                            </div>
                            
                            <div class="btn-group">
                                <button class="btn btn-success" onclick="copyAllMVPrompts(event)">ğŸ“‹ ëª¨ë“  í”„ë¡¬í”„íŠ¸ ë³µì‚¬</button>
                                <button class="btn btn-secondary" onclick="downloadMVPrompts()"><i class="fas fa-download"></i> TXT ë‹¤ìš´ë¡œë“œ</button>
                            </div>
                        </div>
                    </div>

                    <!-- SRT -->
                    <div class="marketing-content" id="marketing-srt">
                        <div class="subtitle-section">
                            <div class="subtitle-header">
                                <span class="subtitle-title">ğŸ“„ SRT ìë§‰ ë¯¸ë¦¬ë³´ê¸°</span>
                            </div>
                            
                            <!-- SRT ìë§‰ ìƒì„± ì„¤ì • -->
                            <div style="margin-bottom: 20px; padding: 15px; background: var(--bg-input); border-radius: 10px; border: 1px solid var(--border);">
                                <h4 style="margin: 0 0 15px 0; color: var(--text-primary); font-size: 1rem;">âš™ï¸ ìë§‰ ìƒì„± ì„¤ì •</h4>
                                
                                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                                    <div class="form-group">
                                        <label style="display: block; margin-bottom: 8px; font-size: 0.9rem; color: var(--text-primary); font-weight: 600;">
                                            â±ï¸ ìë§‰ í‘œì‹œ ì‹œê°„ (ì´ˆ)
                                        </label>
                                        <input type="number" id="srtDisplayDuration" min="1" max="30" value="16" style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 6px; background: var(--bg-card); color: var(--text-primary); font-size: 1rem;">
                                        <p style="margin: 5px 0 0 0; font-size: 0.75rem; color: var(--text-secondary);">
                                            ğŸ’¡ ê° ìë§‰ì´ í‘œì‹œë  ì‹œê°„ (ê¸°ë³¸: 16ì´ˆ, ì´ë¯¸ì§€ 8ì´ˆ ëŒ€ë¹„ 2ë°°)
                                        </p>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label style="display: block; margin-bottom: 8px; font-size: 0.9rem; color: var(--text-primary); font-weight: 600;">
                                            ğŸ“ ìë§‰ë‹¹ í‘œì‹œí•  ì¤„ ìˆ˜
                                        </label>
                                        <select id="srtLinesPerSubtitle" style="width: 100%; padding: 10px; border: 1px solid var(--border); border-radius: 6px; background: var(--bg-card); color: var(--text-primary); font-size: 1rem;">
                                            <option value="1">1ì¤„ (í•œ ì¤„ì”© í‘œì‹œ)</option>
                                            <option value="2" selected>2ì¤„ (ë‘ ì¤„ì”© í‘œì‹œ)</option>
                                            <option value="3">3ì¤„ (ì„¸ ì¤„ì”© í‘œì‹œ)</option>
                                            <option value="4">4ì¤„ (ë„¤ ì¤„ì”© í‘œì‹œ)</option>
                                            <option value="5">5ì¤„ (ë‹¤ì„¯ ì¤„ì”© í‘œì‹œ)</option>
                                        </select>
                                        <p style="margin: 5px 0 0 0; font-size: 0.75rem; color: var(--text-secondary);">
                                            ğŸ’¡ ì—¬ëŸ¬ ì¤„ì„ í•˜ë‚˜ì˜ ìë§‰ìœ¼ë¡œ ë¬¶ì–´ í‘œì‹œ
                                        </p>
                                    </div>
                                </div>
                                
                                <button class="btn btn-primary" onclick="if(typeof window.generateSRTPreview === 'function') { window.generateSRTPreview(); } else { alert('âš ï¸ SRT ìë§‰ ìƒì„± í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'); }" style="width: 100%; padding: 12px; font-size: 1rem;">
                                    <i class="fas fa-magic"></i> SRT ìë§‰ ìƒì„±
                                </button>
                            </div>
                            
                            <div class="subtitle-preview" id="srtPreview"></div>
                        </div>
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="if(typeof window.copySRTContent === 'function') { window.copySRTContent(event); } else { alert('âš ï¸ SRT ìë§‰ ë³µì‚¬ í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'); }" title="SRT ìë§‰ ë‚´ìš© ë³µì‚¬">
                                <i class="fas fa-copy"></i> ğŸ“‹ ìë§‰ ë³µì‚¬
                            </button>
                            <button class="btn btn-success" onclick="if(typeof window.downloadSRT === 'function') { window.downloadSRT('mac'); } else { alert('âš ï¸ SRT ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'); }">ğŸ ë§¥ìš© SRT ë‹¤ìš´ë¡œë“œ</button>
                            <button class="btn btn-success" onclick="if(typeof window.downloadSRT === 'function') { window.downloadSRT('win'); } else { alert('âš ï¸ SRT ë‹¤ìš´ë¡œë“œ í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.'); }">ğŸªŸ ìœˆë„ìš°ìš© SRT ë‹¤ìš´ë¡œë“œ</button>
                        </div>
                    </div>

                    <!-- Upload Guide -->
                    <div class="marketing-content" id="marketing-upload">
                        <!-- ìë™ MV ì œì‘ ì‹œì‘ ì„¹ì…˜ -->
                        <div class="auto-mv-section" style="margin-bottom: 30px; padding: 25px; background: linear-gradient(135deg, var(--bg-card) 0%, var(--bg-secondary) 100%); border: 2px solid var(--accent); border-radius: 15px;">
                            <h3 style="margin-bottom: 15px; color: var(--text-primary); display: flex; align-items: center; gap: 10px;">
                                <span>ğŸ¬ ìë™ ë®¤ì§ë¹„ë””ì˜¤ ì œì‘ ì‹œì‘</span>
                            </h3>
                            <p style="color: var(--text-secondary); margin-bottom: 20px; font-size: 0.9rem; line-height: 1.6;">
                                ìˆ˜ë…¸ì—ì„œ ë‹¤ìš´ë¡œë“œí•œ ìŒì› íŒŒì¼ì„ ì—…ë¡œë“œí•˜ë©´, AIê°€ ìë™ìœ¼ë¡œ MV í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•˜ê³  ë‹¨ê³„ë³„ ê°€ì´ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤.
                            </p>
                            
                            <div class="form-group">
                                <label>ğŸ“ ìŒì› íŒŒì¼ ì—…ë¡œë“œ (MP3, WAV, M4A)</label>
                                <div class="file-upload-area" id="mvAudioUploadArea" style="cursor: pointer;" onclick="document.getElementById('mvAudioFileInput').click()">
                                    <input type="file" id="mvAudioFileInput" accept="audio/*" style="display: none;" onchange="handleMVAudioUpload(event)">
                                    <div class="file-upload-content">
                                        <div class="file-upload-icon">ğŸµ</div>
                                        <p class="file-upload-text" id="mvAudioUploadText">í´ë¦­í•˜ê±°ë‚˜ ë“œë˜ê·¸í•˜ì—¬ ìˆ˜ë…¸ ìŒì› íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
                                        <p class="file-upload-hint">ìµœëŒ€ 500MB, MP3, WAV, M4A í˜•ì‹ ì§€ì›</p>
                                    </div>
                                </div>
                            </div>

                            <!-- ì—…ë¡œë“œëœ íŒŒì¼ ì •ë³´ -->
                            <div id="mvAudioFileInfo" style="display: none; margin-top: 15px; padding: 15px; background: var(--bg-input); border-radius: 10px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <div>
                                        <strong id="mvAudioFileName" style="color: var(--text-primary);"></strong>
                                        <p id="mvAudioFileDetails" style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 5px;"></p>
                                    </div>
                                    <button class="btn btn-small btn-secondary" onclick="removeMVAudioFile()">
                                        <i class="fas fa-times"></i> ì œê±°
                                    </button>
                                </div>
                                <audio id="mvAudioPlayer" controls style="width: 100%; margin-top: 10px; display: none;"></audio>
                            </div>

                            <!-- ìë™ ì œì‘ ì‹œì‘ ë²„íŠ¼ -->
                            <div id="autoMVStartSection" style="display: none; margin-top: 20px;">
                                <div class="btn-group" style="flex-direction: column; gap: 10px;">
                                    <button class="btn btn-primary btn-large" onclick="startAutoMVProduction()" style="width: 100%; padding: 15px; font-size: 1.1rem;">
                                        <i class="fas fa-magic"></i> ìë™ MV ì œì‘ ì‹œì‘
                                    </button>
                                    <p style="font-size: 0.85rem; color: var(--text-secondary); text-align: center; margin-top: 5px;">
                                        ìŒì› ê¸¸ì´ë¥¼ ìë™ ê°ì§€í•˜ê³ , MV í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•˜ë©°, ë‹¨ê³„ë³„ ê°€ì´ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤.
                                    </p>
                                </div>
                            </div>

                            <!-- ì œì‘ ì§„í–‰ ìƒíƒœ -->
                            <div id="autoMVProgress" style="display: none; margin-top: 20px;">
                                <div class="progress-steps" style="flex-direction: column; gap: 15px;">
                                    <div class="progress-step" id="step1-progress">
                                        <div class="step-icon">1ï¸âƒ£</div>
                                        <div class="step-content">
                                            <strong>ìŒì› ë¶„ì„ ì¤‘...</strong>
                                            <p>ìŒì› ê¸¸ì´ì™€ íŠ¹ì„±ì„ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>
                                        </div>
                                        <div class="step-status" id="step1-status">â³</div>
                                    </div>
                                    <div class="progress-step" id="step2-progress">
                                        <div class="step-icon">2ï¸âƒ£</div>
                                        <div class="step-content">
                                            <strong>MV í”„ë¡¬í”„íŠ¸ ìƒì„±</strong>
                                            <p>ê°€ì‚¬ì— ë§ëŠ” ì¥ë©´ë³„ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.</p>
                                        </div>
                                        <div class="step-status" id="step2-status">â¸ï¸</div>
                                    </div>
                                    <div class="progress-step" id="step3-progress">
                                        <div class="step-icon">3ï¸âƒ£</div>
                                        <div class="step-content">
                                            <strong>ìë§‰ íƒ€ì´ë° ìƒì„±</strong>
                                            <p>ìŒì›ê³¼ ê°€ì‚¬ë¥¼ ë™ê¸°í™”í•˜ì—¬ ìë§‰ íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
                                        </div>
                                        <div class="step-status" id="step3-status">â¸ï¸</div>
                                    </div>
                                    <div class="progress-step" id="step4-progress">
                                        <div class="step-icon">4ï¸âƒ£</div>
                                        <div class="step-content">
                                            <strong>ì œì‘ ê°€ì´ë“œ ì¤€ë¹„</strong>
                                            <p>ìœ íŠœë¸Œ/í‹±í†¡ìš© ìµœì í™” ê°€ì´ë“œë¥¼ ì¤€ë¹„í•©ë‹ˆë‹¤.</p>
                                        </div>
                                        <div class="step-status" id="step4-status">â¸ï¸</div>
                                    </div>
                                </div>
                            </div>

                            <!-- ì œì‘ ì™„ë£Œ ê²°ê³¼ -->
                            <div id="autoMVResult" style="display: none; margin-top: 20px; padding: 20px; background: var(--success); border-radius: 10px; color: white;">
                                <h4 style="margin-bottom: 15px;">âœ… ìë™ ì œì‘ ì¤€ë¹„ ì™„ë£Œ!</h4>
                                <p style="margin-bottom: 15px; opacity: 0.9;">ëª¨ë“  ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ì•„ë˜ ë‹¨ê³„ë¥¼ ë”°ë¼ ë®¤ì§ë¹„ë””ì˜¤ë¥¼ ì œì‘í•˜ì„¸ìš”.</p>
                                <div class="btn-group" style="flex-wrap: wrap; gap: 10px;">
                                    <button class="btn btn-success" onclick="goToMVProductionGuide()">
                                        <i class="fas fa-video"></i> MV ì œì‘ ê°€ì´ë“œ ë³´ê¸°
                                    </button>
                                    <button class="btn btn-success" onclick="copyAllMVProductionData(event)">
                                        <i class="fas fa-copy"></i> ëª¨ë“  ìë£Œ ë³µì‚¬
                                    </button>
                                    <button class="btn btn-success" onclick="downloadMVProductionPackage()">
                                        <i class="fas fa-download"></i> ì œì‘ íŒ¨í‚¤ì§€ ë‹¤ìš´ë¡œë“œ
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div class="upload-guide-section">
                            <h3 style="margin-bottom: 20px; color: var(--text-primary); display: flex; align-items: center; gap: 10px;">
                                <span>ğŸ“‹ ì—…ë¡œë“œ ì¤€ë¹„ ì²´í¬ë¦¬ìŠ¤íŠ¸</span>
                                <button class="btn btn-small btn-secondary" onclick="resetUploadChecklist()" style="margin-left: auto;">
                                    <i class="fas fa-redo"></i> ì´ˆê¸°í™”
                                </button>
                            </h3>
                            
                            <div class="checklist-container">
                                <div class="checklist-category">
                                    <h4 style="margin-bottom: 15px; color: var(--accent);">1ï¸âƒ£ ìŒì› ì¤€ë¹„</h4>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="audio">
                                        <span>Sunoì—ì„œ ìŒì› ìƒì„± ì™„ë£Œ</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="audio">
                                        <span>ìŒì› íŒŒì¼ ë‹¤ìš´ë¡œë“œ (MP3/WAV)</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="audio">
                                        <span>ìŒì§ˆ í™•ì¸ ë° í•„ìš”ì‹œ ì¬ìƒì„±</span>
                                    </label>
                                </div>

                                <div class="checklist-category">
                                    <h4 style="margin-bottom: 15px; color: var(--accent);">2ï¸âƒ£ ë®¤ì§ë¹„ë””ì˜¤ ì œì‘</h4>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="video">
                                        <span>MV í”„ë¡¬í”„íŠ¸ í™•ì¸ ë° ë³µì‚¬</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="video">
                                        <span>AI ì´ë¯¸ì§€ ìƒì„± (Midjourney/Runway/DALL-E)</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="video">
                                        <span>ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ë° ì •ë¦¬</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="video">
                                        <span>ë¹„ë””ì˜¤ í¸ì§‘ (CapCut/Adobe Premiere/Final Cut)</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="video">
                                        <span>ìë§‰ ì¶”ê°€ (SRT íŒŒì¼ ì‚¬ìš©)</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="video">
                                        <span>ìµœì¢… ë¹„ë””ì˜¤ íŒŒì¼ ë‚´ë³´ë‚´ê¸° (MP4)</span>
                                    </label>
                                </div>

                                <div class="checklist-category">
                                    <h4 style="margin-bottom: 15px; color: var(--accent);">3ï¸âƒ£ ì¸ë„¤ì¼ ì œì‘</h4>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="thumbnail">
                                        <span>ì¸ë„¤ì¼ ë¬¸êµ¬ ì„ íƒ</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="thumbnail">
                                        <span>ì¸ë„¤ì¼ ì´ë¯¸ì§€ ìƒì„±/ì œì‘</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="thumbnail">
                                        <span>ì¸ë„¤ì¼ ìµœì í™” (1280x720 ê¶Œì¥)</span>
                                    </label>
                                </div>

                                <div class="checklist-category">
                                    <h4 style="margin-bottom: 15px; color: var(--accent);">4ï¸âƒ£ ìœ íŠœë¸Œ ì—…ë¡œë“œ</h4>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="youtube">
                                        <span>ì œëª© ì…ë ¥ (ê³¡ ì œëª© ì‚¬ìš©)</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="youtube">
                                        <span>ì„¤ëª…ë€ ì‘ì„± (ìƒì„±ëœ ì„¤ëª…ë€ ë³µì‚¬)</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="youtube">
                                        <span>í•´ì‹œíƒœê·¸ ì¶”ê°€</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="youtube">
                                        <span>ì¸ë„¤ì¼ ì—…ë¡œë“œ</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="youtube">
                                        <span>ìë§‰ íŒŒì¼ ì—…ë¡œë“œ (SRT)</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="youtube">
                                        <span>ê³µê°œ ì„¤ì • (ê³µê°œ/ë¹„ê³µê°œ)</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="youtube">
                                        <span>ì—…ë¡œë“œ ì™„ë£Œ</span>
                                    </label>
                                </div>

                                <div class="checklist-category">
                                    <h4 style="margin-bottom: 15px; color: var(--accent);">5ï¸âƒ£ í‹±í†¡ ì—…ë¡œë“œ</h4>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="tiktok">
                                        <span>ì„¤ëª…ë€ ì‘ì„± (ìƒì„±ëœ ì„¤ëª…ë€ ë³µì‚¬)</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="tiktok">
                                        <span>í•´ì‹œíƒœê·¸ ì¶”ê°€</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="tiktok">
                                        <span>ë¹„ë””ì˜¤ ì—…ë¡œë“œ</span>
                                    </label>
                                    <label class="checklist-item">
                                        <input type="checkbox" class="upload-checklist" data-category="tiktok">
                                        <span>ì—…ë¡œë“œ ì™„ë£Œ</span>
                                    </label>
                                </div>
                            </div>

                            <div class="upload-progress" style="margin-top: 30px; padding: 20px; background: var(--bg-secondary); border-radius: 10px;">
                                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                                    <span style="font-weight: 600;">ì§„í–‰ë¥ </span>
                                    <span id="uploadProgressPercent" style="font-size: 1.2rem; color: var(--accent); font-weight: 600;">0%</span>
                                </div>
                                <div style="background: var(--bg-input); border-radius: 10px; height: 20px; overflow: hidden;">
                                    <div id="uploadProgressBar" style="background: linear-gradient(90deg, var(--accent) 0%, var(--primary) 100%); height: 100%; width: 0%; transition: width 0.3s ease; border-radius: 10px;"></div>
                                </div>
                                <p id="uploadProgressText" style="margin-top: 10px; font-size: 0.85rem; color: var(--text-secondary); text-align: center;">ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ì™„ë£Œí•´ì£¼ì„¸ìš”</p>
                            </div>
                        </div>

                        <div class="upload-guide-section" style="margin-top: 30px;">
                            <h3 style="margin-bottom: 20px; color: var(--text-primary);">ğŸ› ï¸ ì¶”ì²œ ë„êµ¬ ë° ê°€ì´ë“œ</h3>
                            
                            <div class="tool-guide-grid">
                                <div class="tool-guide-card">
                                    <div class="tool-guide-header">
                                        <span class="tool-icon">ğŸ¨</span>
                                        <h4>AI ì´ë¯¸ì§€ ìƒì„±</h4>
                                    </div>
                                    <div class="tool-guide-content">
                                        <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 10px;">
                                            MV í”„ë¡¬í”„íŠ¸ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ ìƒì„±í•˜ì„¸ìš”:
                                        </p>
                                        <ul style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.8; margin-left: 20px;">
                                            <li><strong>Midjourney</strong>: ë””ìŠ¤ì½”ë“œ ë´‡ ì‚¬ìš©, ê³ í’ˆì§ˆ ì´ë¯¸ì§€</li>
                                            <li><strong>Runway</strong>: ì´ë¯¸ì§€â†’ë¹„ë””ì˜¤ ë³€í™˜ ê°€ëŠ¥</li>
                                            <li><strong>DALL-E 3</strong>: ChatGPT Plusì—ì„œ ì‚¬ìš©</li>
                                            <li><strong>Stable Diffusion</strong>: ë¬´ë£Œ ì˜¤í”ˆì†ŒìŠ¤</li>
                                        </ul>
                                        <button class="btn btn-small btn-primary" onclick="copyAllMVPrompts(event)" style="margin-top: 10px; width: 100%;">
                                            <i class="fas fa-copy"></i> ëª¨ë“  MV í”„ë¡¬í”„íŠ¸ ë³µì‚¬
                                        </button>
                                    </div>
                                </div>

                                <div class="tool-guide-card">
                                    <div class="tool-guide-header">
                                        <span class="tool-icon">âœ‚ï¸</span>
                                        <h4>ë¹„ë””ì˜¤ í¸ì§‘</h4>
                                    </div>
                                    <div class="tool-guide-content">
                                        <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 10px;">
                                            ì¶”ì²œ í¸ì§‘ ë„êµ¬:
                                        </p>
                                        <ul style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.8; margin-left: 20px;">
                                            <li><strong>CapCut</strong>: ë¬´ë£Œ, ëª¨ë°”ì¼/PC ì§€ì›, ìë§‰ ìë™ ìƒì„±</li>
                                            <li><strong>Adobe Premiere</strong>: ì „ë¬¸ê°€ìš©, ìœ ë£Œ</li>
                                            <li><strong>Final Cut Pro</strong>: ë§¥ ì „ìš©, ìœ ë£Œ</li>
                                            <li><strong>DaVinci Resolve</strong>: ë¬´ë£Œ ì „ë¬¸ í¸ì§‘ ë„êµ¬</li>
                                        </ul>
                                        <p style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 10px; font-style: italic;">
                                            ğŸ’¡ íŒ: CapCutì€ ìë§‰ ìë™ ìƒì„± ê¸°ëŠ¥ì´ ìˆì–´ SRT íŒŒì¼ ì—†ì´ë„ í¸ë¦¬í•©ë‹ˆë‹¤.
                                        </p>
                                    </div>
                                </div>

                                <div class="tool-guide-card">
                                    <div class="tool-guide-header">
                                        <span class="tool-icon">ğŸ“±</span>
                                        <h4>ë¹ ë¥¸ ì œì‘ ë°©ë²•</h4>
                                    </div>
                                    <div class="tool-guide-content">
                                        <p style="font-size: 0.85rem; color: var(--text-secondary); margin-bottom: 10px;">
                                            ê°€ì¥ ê°„ë‹¨í•œ ë°©ë²•:
                                        </p>
                                        <ol style="font-size: 0.85rem; color: var(--text-secondary); line-height: 1.8; margin-left: 20px;">
                                            <li><strong>Runway Gen-3</strong> ì‚¬ìš©: MV í”„ë¡¬í”„íŠ¸ë¡œ ì§ì ‘ ë¹„ë””ì˜¤ ìƒì„±</li>
                                            <li><strong>CapCut í…œí”Œë¦¿</strong> ì‚¬ìš©: ì´ë¯¸ì§€ ìŠ¬ë¼ì´ë“œì‡¼ ìë™ ìƒì„±</li>
                                            <li><strong>Canva</strong> ì‚¬ìš©: ì´ë¯¸ì§€ + ìŒì›ìœ¼ë¡œ ê°„ë‹¨í•œ ë¹„ë””ì˜¤ ì œì‘</li>
                                        </ol>
                                        <p style="font-size: 0.75rem; color: var(--accent); margin-top: 10px; font-weight: 600;">
                                            âš¡ ê°€ì¥ ë¹ ë¥¸ ë°©ë²•: Runway Gen-3ë¡œ í”„ë¡¬í”„íŠ¸ë§Œ ì…ë ¥í•˜ë©´ ë¹„ë””ì˜¤ ìë™ ìƒì„±!
                                        </p>
                                    </div>
                                </div>

                                <div class="tool-guide-card">
                                    <div class="tool-guide-header">
                                        <span class="tool-icon">ğŸ”—</span>
                                        <h4>ìœ ìš©í•œ ë§í¬</h4>
                                    </div>
                                    <div class="tool-guide-content">
                                        <div style="display: flex; flex-direction: column; gap: 8px;">
                                            <a href="https://www.midjourney.com" target="_blank" class="tool-link">
                                                <i class="fas fa-external-link-alt"></i> Midjourney
                                            </a>
                                            <a href="https://runwayml.com" target="_blank" class="tool-link">
                                                <i class="fas fa-external-link-alt"></i> Runway ML
                                            </a>
                                            <a href="https://www.capcut.com" target="_blank" class="tool-link">
                                                <i class="fas fa-external-link-alt"></i> CapCut
                                            </a>
                                            <a href="https://www.canva.com" target="_blank" class="tool-link">
                                                <i class="fas fa-external-link-alt"></i> Canva
                                            </a>
                                            <a href="https://studio.youtube.com" target="_blank" class="tool-link">
                                                <i class="fas fa-external-link-alt"></i> ìœ íŠœë¸Œ ìŠ¤íŠœë””ì˜¤
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="upload-guide-section" style="margin-top: 30px;">
                            <h3 style="margin-bottom: 20px; color: var(--text-primary);">ğŸ“¦ ì›í´ë¦­ ë³µì‚¬</h3>
                            <div class="btn-group" style="flex-wrap: wrap;">
                                <button class="btn btn-success" onclick="copyAllMarketingMaterials()">
                                    <i class="fas fa-copy"></i> ëª¨ë“  ë§ˆì¼€íŒ… ìë£Œ ë³µì‚¬
                                </button>
                                <button class="btn btn-primary" onclick="downloadAllMarketingFiles()">
                                    <i class="fas fa-download"></i> ëª¨ë“  íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                                </button>
                            </div>
                            <p style="font-size: 0.85rem; color: var(--text-secondary); margin-top: 10px; text-align: center;">
                                ëª¨ë“  ë§ˆì¼€íŒ… ìë£Œë¥¼ í•œ ë²ˆì— ë³µì‚¬í•˜ê±°ë‚˜ íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="btn-group" style="justify-content: center;">
                    <button class="btn btn-secondary" onclick="goToStep(5)">â† ì´ì „</button>
                    <button class="btn btn-primary" onclick="resetAll()">ğŸ”„ ìƒˆë¡œ ì‹œì‘í•˜ê¸°</button>
                </div>
                <div class="step-footer">
                    <p>ğŸµ Music Creator - AI ê°€ì‚¬ & ìˆ˜ë…¸ í”„ë¡¬í”„íŠ¸ & ë§ˆì¼€íŒ… ìë£Œ ìƒì„±ê¸°</p>
                    <p>Powered by Google Gemini AI & ChatGPT âœ¨ | ë®¤ì§ëª¨ë¦¬ ì±„ë„</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Guidelines Modal -->
    <div class="modal-overlay" id="guidelinesModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ“‹ ë®¤ì§ëª¨ë¦¬ ì œì‘ ì§€ì¹¨ì„œ</h3>
                <button class="modal-close" onclick="closeGuidelinesModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <p style="color: var(--text-secondary); margin-bottom: 15px; font-size: 0.9rem;">
                    ì´ ì§€ì¹¨ì„œëŠ” AIê°€ ê°€ì‚¬, í”„ë¡¬í”„íŠ¸, ë§ˆì¼€íŒ… ìë£Œ ìƒì„± ì‹œ ì°¸ì¡°í•©ë‹ˆë‹¤. ìˆ˜ì • í›„ ì €ì¥í•˜ë©´ ëª¨ë“  ìƒì„± ê³¼ì •ì— ë°˜ì˜ë©ë‹ˆë‹¤.
                </p>
                <textarea id="guidelinesText" style="min-height: 400px; font-size: 0.85rem;"></textarea>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="resetGuidelines()">ğŸ”„ ê¸°ë³¸ê°’ ë³µì›</button>
                <button class="btn btn-primary" onclick="saveGuidelines(); closeGuidelinesModal();">ğŸ’¾ ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- Project Reference Modal -->
    <div class="modal-overlay" id="projectReferenceModal">
        <div class="modal" style="max-width: 700px;">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ’¾ ì €ì¥ëœ í”„ë¡œì íŠ¸ì—ì„œ ì°¸ì¡°</h3>
                <button class="modal-close" onclick="closeProjectReferenceModal()">Ã—</button>
            </div>
            <div class="modal-body">
                <p style="color: var(--text-secondary); margin-bottom: 15px; font-size: 0.9rem;">
                    ì €ì¥ëœ í”„ë¡œì íŠ¸ë¥¼ ì„ íƒí•˜ë©´ í•´ë‹¹ í”„ë¡œì íŠ¸ì˜ ê°€ì‚¬ì™€ ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸ë¥¼ ì°¸ê³ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
                
                <div class="form-group">
                    <label>í”„ë¡œì íŠ¸ ì„ íƒ</label>
                    <div id="projectReferenceList" style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border); border-radius: 8px; padding: 10px;">
                        <!-- í”„ë¡œì íŠ¸ ëª©ë¡ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ë¡œë“œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
                
                <div id="selectedProjectPreview" style="display: none; margin-top: 20px; padding: 15px; background: var(--bg-secondary); border-radius: 8px;">
                    <h4 style="margin-bottom: 10px; font-size: 1rem;">ì„ íƒëœ í”„ë¡œì íŠ¸ ì •ë³´</h4>
                    <div style="margin-bottom: 10px;">
                        <strong>ì œëª©:</strong> <span id="previewProjectTitle">-</span>
                    </div>
                    <div style="margin-bottom: 10px;">
                        <strong>ì¥ë¥´:</strong> <span id="previewProjectGenres">-</span>
                    </div>
                    <div style="margin-bottom: 15px;">
                        <strong>ì €ì¥ì¼:</strong> <span id="previewProjectDate">-</span>
                    </div>
                    
                    <div style="margin-bottom: 10px;">
                        <strong>ì°¸ê³ í•  ë‚´ìš©:</strong>
                        <div style="margin-top: 5px; display: flex; gap: 10px; flex-wrap: wrap;">
                            <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                <input type="checkbox" id="referenceProjectLyrics" checked>
                                <span>ê°€ì‚¬</span>
                            </label>
                            <label style="display: flex; align-items: center; gap: 5px; cursor: pointer;">
                                <input type="checkbox" id="referenceProjectStyle" checked>
                                <span>ìŠ¤íƒ€ì¼ í”„ë¡¬í”„íŠ¸</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeProjectReferenceModal()">ì·¨ì†Œ</button>
                <button class="btn btn-primary" onclick="applyProjectReference()" id="applyProjectReferenceBtn" disabled>ì ìš©</button>
            </div>
        </div>
    </div>

    <!-- API Settings Modal -->
    <div class="modal-overlay" id="apiSettingsModal" style="display: none;">
        <div class="modal api-settings-modal-inner">
            <div class="modal-header">
                <h3 class="modal-title">API í‚¤ ì„¤ì •</h3>
                <button type="button" class="modal-close" onclick="closeAPISettings()" aria-label="ë‹«ê¸°"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div class="api-key-notice">
                    <p>API í‚¤ ì•ˆë‚´</p>
                    <p>
                        â€¢ <strong>Gemini API í‚¤</strong>: <a href="https://aistudio.google.com/apikey" target="_blank" rel="noopener">Google AI Studio</a>ì—ì„œ ë¬´ë£Œë¡œ ë°œê¸‰<br>
                        â€¢ <strong>OpenAI API í‚¤</strong>: <a href="https://platform.openai.com/api-keys" target="_blank" rel="noopener">OpenAI Platform</a>ì—ì„œ ë°œê¸‰ (ìœ ë£Œ)<br>
                        â€¢ API í‚¤ëŠ” ì•”í˜¸í™”ë˜ì–´ ë¸Œë¼ìš°ì €ì— ì €ì¥ë˜ë©° ì™¸ë¶€ë¡œ ì „ì†¡ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>
                        â€¢ <strong class="api-notice-security">ë³´ì•ˆì„ ìœ„í•´ API í‚¤ëŠ” ì†ŒìŠ¤ ì½”ë“œì— í¬í•¨ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</strong>
                    </p>
                </div>

                <div class="form-group">
                    <label for="geminiKeyInput">Gemini API í‚¤</label>
                    <input type="text" id="geminiKeyInput" placeholder="AIzaSy... í˜•ì‹ì˜ API í‚¤" oninput="validateGeminiKey(this)" onblur="validateGeminiKey(this)">
                    <p>Google AI Studioì—ì„œ ë°œê¸‰ë°›ì€ í‚¤ ì…ë ¥</p>
                    <div id="geminiKeyError" class="api-key-msg api-key-error" style="display: none;"></div>
                    <div id="geminiKeySuccess" class="api-key-msg api-key-success" style="display: none;">âœ… ì˜¬ë°”ë¥¸ í˜•ì‹ì˜ API í‚¤ì…ë‹ˆë‹¤.</div>
                </div>

                <div class="form-group">
                    <label for="openaiKeyInput">OpenAI API í‚¤</label>
                    <input type="text" id="openaiKeyInput" placeholder="sk-... í˜•ì‹ì˜ API í‚¤" oninput="validateOpenAIKey(this)" onblur="validateOpenAIKey(this)">
                    <p>OpenAI Platformì—ì„œ ë°œê¸‰ë°›ì€ í‚¤ ì…ë ¥</p>
                    <div id="openaiKeyError" class="api-key-msg api-key-error" style="display: none;"></div>
                    <div id="openaiKeySuccess" class="api-key-msg api-key-success" style="display: none;">âœ… ì˜¬ë°”ë¥¸ í˜•ì‹ì˜ API í‚¤ì…ë‹ˆë‹¤.</div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="resetAPIKeys()">ê¸°ë³¸ê°’</button>
                <button type="button" class="btn btn-secondary" onclick="testAPIConnection()">ì—°ê²° í…ŒìŠ¤íŠ¸</button>
                <button type="button" class="btn btn-primary" onclick="saveAPIKeys()">ì €ì¥</button>
            </div>
        </div>
    </div>

    <!-- ë‹¨ê³„ ìˆœì„œ ì„¤ì • ì•ˆë‚´ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="stepOrderHelpModal" style="display: none;">
        <div class="modal" style="max-width: 500px;">
            <div class="modal-header">
                <h3 class="modal-title">ğŸ“‹ ë‹¨ê³„ ìˆœì„œ ë³€ê²½ ì•ˆë‚´</h3>
                <button class="modal-close" onclick="document.getElementById('stepOrderHelpModal').style.display='none'">Ã—</button>
            </div>
            <div class="modal-body">
                <p style="color: var(--text-secondary); margin-bottom: 15px; line-height: 1.6;">
                    ê° ë‹¨ê³„ ë©”ë‰´ì˜ <strong style="color: var(--accent);">â‹®â‹®</strong> ì•„ì´ì½˜ì„ ë“œë˜ê·¸í•˜ì—¬ ì›í•˜ëŠ” ìˆœì„œë¡œ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
                <div style="background: var(--bg-secondary); padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <strong style="color: var(--text-primary); display: block; margin-bottom: 10px;">ì‚¬ìš© ë°©ë²•:</strong>
                    <ol style="color: var(--text-secondary); line-height: 1.8; margin-left: 20px;">
                        <li>ê° ë‹¨ê³„ ë©”ë‰´ ì™¼ìª½ì˜ <strong>â‹®â‹®</strong> ì•„ì´ì½˜ì— ë§ˆìš°ìŠ¤ë¥¼ ì˜¬ë¦½ë‹ˆë‹¤</li>
                        <li>ì•„ì´ì½˜ì„ í´ë¦­í•œ ìƒíƒœë¡œ ë“œë˜ê·¸í•©ë‹ˆë‹¤</li>
                        <li>ì›í•˜ëŠ” ìœ„ì¹˜ì—ì„œ ë†“ìœ¼ë©´ ìˆœì„œê°€ ë³€ê²½ë©ë‹ˆë‹¤</li>
                        <li>ë³€ê²½ëœ ìˆœì„œëŠ” ìë™ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤</li>
                    </ol>
                </div>
                <div style="background: rgba(16, 185, 129, 0.1); border: 1px solid rgba(16, 185, 129, 0.3); padding: 12px; border-radius: 8px;">
                    <p style="color: var(--success); margin: 0; font-size: 0.9rem;">
                        ğŸ’¡ íŒ: ë‹¨ê³„ ë ˆì´ë¸”ì„ í´ë¦­í•˜ë©´ í•´ë‹¹ ë‹¨ê³„ë¡œ ì´ë™í•˜ê³ , ë“œë˜ê·¸ í•¸ë“¤ì„ ì‚¬ìš©í•˜ë©´ ìˆœì„œë¥¼ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="document.getElementById('stepOrderHelpModal').style.display='none'">í™•ì¸</button>
            </div>
        </div>
    </div>

    </div><!-- End Main Wrapper -->

    <script>
        // ì—ëŸ¬ í•¸ë“¤ëŸ¬ ì¶”ê°€
        window.addEventListener('error', function(e) {
            console.error('JavaScript ì—ëŸ¬:', e.error);
            console.error('ì—ëŸ¬ íŒŒì¼:', e.filename);
            console.error('ì—ëŸ¬ ë¼ì¸:', e.lineno);
            console.error('ì—ëŸ¬ ë©”ì‹œì§€:', e.message);
        });
        
        // ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ í™•ì¸
        window.addEventListener('load', function() {
            console.log('âœ… ëª¨ë“  ë¦¬ì†ŒìŠ¤ ë¡œë“œ ì™„ë£Œ');
            console.log('âœ… app.js ë¡œë“œ í™•ì¸ ì¤‘...');
            
            // ì£¼ìš” í•¨ìˆ˜ë“¤ì´ ì •ì˜ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
            const functions = ['toggleSidebar', 'saveCurrentProject', 'loadProjectList'];
            functions.forEach(funcName => {
                if (typeof window[funcName] === 'function') {
                    console.log('âœ…', funcName, 'í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥');
                } else {
                    console.error('âŒ', funcName, 'í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                }
            });
            
            // DOM ìš”ì†Œ í™•ì¸
            const elements = ['sidebar', 'sidebarToggle', 'mainWrapper'];
            elements.forEach(elemId => {
                const elem = document.getElementById(elemId);
                if (elem) {
                    console.log('âœ…', elemId, 'ìš”ì†Œ ì¡´ì¬');
                } else {
                    console.error('âŒ', elemId, 'ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
                }
            });
            
            // í”„ë¡œì íŠ¸ ëª©ë¡ ë¡œë“œ (ì•± ì‹œì‘ ì‹œ) - ì—¬ëŸ¬ ë²ˆ ì‹œë„
            const tryLoadProjectList = () => {
                const projectListEl = document.getElementById('projectList');
                if (!projectListEl) {
                    console.warn('âš ï¸ projectList ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return false;
                }
                
                if (typeof window.loadProjectList === 'function') {
                    console.log('ğŸ”„ í”„ë¡œì íŠ¸ ëª©ë¡ ë¡œë“œ ì‹œë„ (window.load ì´ë²¤íŠ¸)');
                    try {
                        window.loadProjectList();
                        return true;
                    } catch (e) {
                        console.error('loadProjectList ì‹¤í–‰ ì˜¤ë¥˜:', e);
                        return false;
                    }
                } else {
                    console.warn('âš ï¸ loadProjectList í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return false;
                }
            };
            
            // ì‚¬ì´ë“œë°” ë“œë˜ê·¸ ê¸°ëŠ¥ ì´ˆê¸°í™”
            setTimeout(() => {
                if (typeof window.initSidebarDrag === 'function') {
                    window.initSidebarDrag();
                    console.log('âœ… ì‚¬ì´ë“œë°” ë“œë˜ê·¸ ê¸°ëŠ¥ ì´ˆê¸°í™” ì™„ë£Œ');
                }
            }, 1000);
            
            // íƒœê·¸ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì´ˆê¸°í™”
            setTimeout(() => {
                if (typeof window.initializeTagButtons === 'function') {
                    window.initializeTagButtons();
                    console.log('âœ… íƒœê·¸ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì´ˆê¸°í™” ì™„ë£Œ');
                }
            }, 500);
            
            // API ì„ íƒ ì´ˆê¸°í™”
            setTimeout(() => {
                const savedAPI = localStorage.getItem('selectedAPI') || 'openai';
                const apiSelector = document.getElementById('apiSelector');
                if (apiSelector) {
                    apiSelector.value = savedAPI;
                    if (typeof window.changeAPI === 'function') {
                        window.changeAPI(savedAPI);
                    } else if (typeof window.handleAPIChange === 'function') {
                        window.handleAPIChange(savedAPI);
                    }
                }
            }, 500);
            
            // ê´€ë¦¬ì ë©”ë‰´ í† ê¸€
            window.toggleAdminMenu = function(event) {
                if (event) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                const menuContent = document.getElementById('headerMenuContent');
                if (menuContent) {
                    const isVisible = menuContent.style.display !== 'none';
                    menuContent.style.display = isVisible ? 'none' : 'block';
                    
                    if (!isVisible) {
                        setTimeout(() => {
                            document.addEventListener('click', function closeMenu(e) {
                                if (!menuContent.contains(e.target) && !e.target.closest('.header-menu-dropdown')) {
                                    menuContent.style.display = 'none';
                                    document.removeEventListener('click', closeMenu);
                                }
                            });
                        }, 100);
                    }
                }
            };
            window.toggleHeaderMenu = window.toggleAdminMenu;
            window.closeAdminMenu = function() {
                const menuContent = document.getElementById('headerMenuContent');
                if (menuContent) menuContent.style.display = 'none';
            };
            
            // ì¦‰ì‹œ ì‹œë„
            setTimeout(() => {
                if (!tryLoadProjectList()) {
                    // 1ì´ˆ í›„ ì¬ì‹œë„
                    setTimeout(() => {
                        if (!tryLoadProjectList()) {
                            // 2ì´ˆ í›„ ìµœì¢… ì‹œë„
                            setTimeout(() => {
                                tryLoadProjectList();
                            }, 1000);
                        }
                    }, 1000);
                }
            }, 300);
        });
    </script>
    <!-- ì„ì‹œ í”„ë¡œì íŠ¸ ë¡œë“œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ë¨¼ì € ì •ì˜ (app.js ë¡œë“œ ì „) -->
    <script>
        // loadProjectList í•¨ìˆ˜ë¥¼ ë¨¼ì € ì „ì—­ìœ¼ë¡œ ì •ì˜í•˜ì—¬ ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ í˜¸ì¶œ ê°€ëŠ¥í•˜ë„ë¡
        (function() {
            // í”„ë¡œì íŠ¸ ë°ì´í„° ë¡œë“œ í•¨ìˆ˜
            function loadProjectListTemporary() {
                try {
                    const projectListEl = document.getElementById('projectList');
                    if (!projectListEl) {
                        console.error('projectList ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        return;
                    }
                    
                    // localStorageì—ì„œ ëª¨ë“  í”„ë¡œì íŠ¸ ë°ì´í„° ìˆ˜ì§‘
                    let allProjects = [];
                    const foundKeys = [];
                    
                    // ëª¨ë“  localStorage í‚¤ë¥¼ í™•ì¸í•˜ì—¬ í”„ë¡œì íŠ¸ ë°ì´í„° ì°¾ê¸°
                    for (let i = 0; i < localStorage.length; i++) {
                        const key = localStorage.key(i);
                        if (!key) continue;
                        
                        try {
                            const data = localStorage.getItem(key);
                            if (!data) continue;
                            
                            // JSON ë°°ì—´ì¸ì§€ í™•ì¸
                            if (data.trim().startsWith('[')) {
                                const parsed = JSON.parse(data);
                                if (Array.isArray(parsed) && parsed.length > 0) {
                                    // í”„ë¡œì íŠ¸ ê°ì²´ì¸ì§€ í™•ì¸ (idì™€ titleì´ ìˆëŠ”ì§€)
                                    const firstItem = parsed[0];
                                    if (firstItem && typeof firstItem === 'object' && firstItem.id && firstItem.title) {
                                        allProjects = allProjects.concat(parsed);
                                        foundKeys.push(key);
                                        console.log(`âœ… ${key} í‚¤ì—ì„œ ${parsed.length}ê°œ í”„ë¡œì íŠ¸ ë°œê²¬`);
                                    }
                                }
                            }
                            // ë‹¨ì¼ í”„ë¡œì íŠ¸ ê°ì²´ì¸ì§€ í™•ì¸
                            else if (data.trim().startsWith('{')) {
                                const parsed = JSON.parse(data);
                                if (parsed && typeof parsed === 'object' && parsed.id && parsed.title) {
                                    allProjects.push(parsed);
                                    foundKeys.push(key);
                                    console.log(`âœ… ${key} í‚¤ì—ì„œ ë‹¨ì¼ í”„ë¡œì íŠ¸ ë°œê²¬`);
                                }
                            }
                        } catch (e) {
                            // JSON íŒŒì‹± ì‹¤íŒ¨ëŠ” ë¬´ì‹œ
                        }
                    }
                    
                    // ì¤‘ë³µ ì œê±° (ê°™ì€ idë¥¼ ê°€ì§„ í”„ë¡œì íŠ¸ëŠ” ê°€ì¥ ìµœì‹  ê²ƒë§Œ ìœ ì§€)
                    const projectMap = new Map();
                    allProjects.forEach(project => {
                        if (!project.id) return;
                        
                        const existing = projectMap.get(project.id);
                        if (!existing) {
                            projectMap.set(project.id, project);
                        } else {
                            // ë” ìµœì‹  í”„ë¡œì íŠ¸ë¡œ êµì²´
                            const existingDate = new Date(existing.savedAt || existing.createdAt || 0);
                            const newDate = new Date(project.savedAt || project.createdAt || 0);
                            if (newDate > existingDate) {
                                projectMap.set(project.id, project);
                            }
                        }
                    });
                    
                    const projects = Array.from(projectMap.values());
                    
                    if (projects.length === 0) {
                        projectListEl.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text-secondary);">ì €ì¥ëœ í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.<br><br><small style="color: var(--text-secondary);">í”„ë¡œì íŠ¸ë¥¼ ì €ì¥í•˜ë©´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</small></div>';
                        console.warn('âš ï¸ í”„ë¡œì íŠ¸ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        return;
                    }
                    
                    console.log(`âœ… ì´ ${projects.length}ê°œ í”„ë¡œì íŠ¸ ë°œê²¬ (${foundKeys.length}ê°œ í‚¤ì—ì„œ)`);
                    
                    // ê²€ìƒ‰ì–´ í•„í„°ë§
                    const searchInput = document.getElementById('projectSearch');
                    let filteredProjects = projects;
                    if (searchInput && searchInput.value.trim()) {
                        const searchTerm = searchInput.value.trim().toLowerCase();
                        filteredProjects = projects.filter(project => {
                            const title = (project.title || '').toLowerCase();
                            const genres = (project.genres || []).join(' ').toLowerCase();
                            return title.includes(searchTerm) || genres.includes(searchTerm);
                        });
                    }
                    
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // ì •ë ¬ ì˜µì…˜ ì ìš© (í•­ìƒ ì •ë ¬ ë“œë¡­ë‹¤ìš´ì˜ ê°’ì„ ìš°ì„  ì ìš©)
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    const sortSelect = document.getElementById('projectSort');
                    // ì •ë ¬ ë“œë¡­ë‹¤ìš´ì´ ì—†ê±°ë‚˜ ê°’ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ ì‚¬ìš©
                    const sortValue = sortSelect && sortSelect.value ? sortSelect.value : 'savedAt-desc';
                    const [sortField, sortOrder] = sortValue.split('-');
                    
                    // í•œê¸€ ì œëª© ë¶„ë¦¬ í—¬í¼ í•¨ìˆ˜
                    function getKoreanTitle(fullTitle) {
                        if (!fullTitle) return '';
                        const match = fullTitle.match(/^(.+?)\s*\(([^)]+)\)\s*$/);
                        return match ? match[1].trim() : fullTitle.trim();
                    }
                    
                    // ì •ë ¬ ì ìš© (í•­ìƒ ì ìš©)
                    filteredProjects.sort((a, b) => {
                        let valueA, valueB;
                        
                        if (sortField === 'savedAt' || sortField === 'createdAt') {
                            valueA = new Date(a[sortField] || a.createdAt || a.savedAt || 0);
                            valueB = new Date(b[sortField] || b.createdAt || b.savedAt || 0);
                        } else if (sortField === 'title') {
                            // í•œê¸€ ì œëª©ë§Œ ì‚¬ìš©í•˜ì—¬ ì •ë ¬
                            valueA = getKoreanTitle(a.title || '').toLowerCase();
                            valueB = getKoreanTitle(b.title || '').toLowerCase();
                        } else if (sortField === 'genre') {
                            valueA = (a.genres || []).join(', ').toLowerCase();
                            valueB = (b.genres || []).join(', ').toLowerCase();
                        } else if (sortField === 'step') {
                            // ì§„í–‰ ë‹¨ê³„ë¥¼ ìˆ«ìë¡œ ë³€í™˜ (ì˜ˆ: "6ë‹¨ê³„" -> 6)
                            const stepA = a.lastStep || '';
                            const stepB = b.lastStep || '';
                            valueA = parseInt(stepA.toString().replace(/[^0-9]/g, '')) || 0;
                            valueB = parseInt(stepB.toString().replace(/[^0-9]/g, '')) || 0;
                        } else {
                            // ê¸°ë³¸ê°’: ìˆ˜ì •ì¼ì‹œ ìµœì‹ ìˆœ
                            valueA = new Date(a.savedAt || a.createdAt || a.updatedAt || 0);
                            valueB = new Date(b.savedAt || b.createdAt || b.updatedAt || 0);
                        }
                        
                        if (sortOrder === 'asc') {
                            return valueA > valueB ? 1 : valueA < valueB ? -1 : 0;
                        } else {
                            return valueA < valueB ? 1 : valueA > valueB ? -1 : 0;
                        }
                    });
                    
                    console.log(`âœ… ì •ë ¬ ì ìš© ì™„ë£Œ: ${sortValue} (${sortField}-${sortOrder})`);
                    
                    if (filteredProjects.length === 0) {
                        projectListEl.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--text-secondary);">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                        return;
                    }
                    
                    function escapeHtml(text) {
                        if (!text) return '';
                        const div = document.createElement('div');
                        div.textContent = text;
                        return div.innerHTML;
                    }
                    
                    function formatDate(date) {
                        if (!date) return '';
                        const d = new Date(date);
                        if (isNaN(d.getTime())) return '';
                        return d.toLocaleDateString('ko-KR', { 
                            year: 'numeric', 
                            month: 'long', 
                            day: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit',
                            hour12: true
                        });
                    }
                    
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    // ì •ë ¬ ê¸°ì¤€ì— ë”°ë¼ í‘œì‹œí•  ì •ë³´ ê²°ì •
                    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                    
                    // ì •ë ¬ ë“œë¡­ë‹¤ìš´ì´ ìˆìœ¼ë©´ í•­ìƒ ì •ë ¬ ëª¨ë“œ í™œì„±í™” (ê¸°ë³¸ê°’ í¬í•¨)
                    // ì •ë ¬ ëª¨ë“œì—ì„œëŠ” í•œê¸€ ì œëª© + ì„ íƒí•œ ì •ë ¬ ê¸°ì¤€ ì •ë³´ë§Œ í‘œì‹œ
                    const isSortMode = true; // í•­ìƒ ì •ë ¬ ëª¨ë“œë¡œ ë™ì‘
                    
                    // í•œê¸€ ì œëª©ê³¼ ì˜ì–´ ì œëª© ë¶„ë¦¬ í•¨ìˆ˜
                    function splitTitle(fullTitle) {
                        if (!fullTitle) return { korean: 'ì œëª© ì—†ìŒ', english: '' };
                        
                        // "í•œê¸€ì œëª© (English Title)" í˜•ì‹ íŒŒì‹±
                        const match = fullTitle.match(/^(.+?)\s*\(([^)]+)\)\s*$/);
                        if (match) {
                            return {
                                korean: match[1].trim(),
                                english: match[2].trim()
                            };
                        }
                        
                        // ê´„í˜¸ê°€ ì—†ìœ¼ë©´ ì „ì²´ë¥¼ í•œê¸€ ì œëª©ìœ¼ë¡œ ê°„ì£¼
                        return {
                            korean: fullTitle.trim(),
                            english: ''
                        };
                    }
                    
                    let html = '';
                    filteredProjects.forEach(project => {
                        // ì œëª© ë¶„ë¦¬
                        const titleParts = splitTitle(project.title);
                        const koreanTitle = titleParts.korean;
                        const englishTitle = titleParts.english;
                        
                        // ì‘ì„±ì¼ì‹œì™€ ìˆ˜ì •ì¼ì‹œ êµ¬ë¶„
                        const createdAt = project.createdAt || null;
                        const savedAt = project.savedAt || project.updatedAt || null;
                        const savedDate = savedAt || createdAt || Date.now();
                        
                        const createdDateStr = formatDate(createdAt);
                        const savedDateStr = formatDate(savedAt || savedDate);
                        
                        // ì¥ë¥´ ì •ë³´
                        const genresStr = project.genres && project.genres.length > 0 
                            ? project.genres.join(', ') 
                            : '';
                        
                        // ì§„í–‰ ë‹¨ê³„
                        const stepStr = project.lastStep ? project.lastStep : '';
                        
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        // ì •ë ¬ ëª¨ë“œì— ë”°ë¼ í‘œì‹œí•  ì •ë³´ ê²°ì •
                        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                        let showCreatedDate = false;
                        let showSavedDate = false;
                        let showGenres = false;
                        let showStep = false;
                        let showEnglishTitle = false;
                        
                        if (isSortMode) {
                            // ì •ë ¬ ëª¨ë“œ: í•œê¸€ ì œëª© + ì„ íƒí•œ ì •ë ¬ ê¸°ì¤€ ì •ë³´ë§Œ í‘œì‹œ
                            switch (sortField) {
                                case 'createdAt':
                                    showCreatedDate = true;
                                    break;
                                case 'savedAt':
                                    showSavedDate = true;
                                    break;
                                case 'genre':
                                    showGenres = true;
                                    break;
                                case 'step':
                                    showStep = true;
                                    break;
                                case 'title':
                                    // ì œëª© ì •ë ¬ ì‹œì—ëŠ” ì œëª©ë§Œ í‘œì‹œ
                                    break;
                            }
                        } else {
                            // ê¸°ë³¸ ëª¨ë“œ: ëª¨ë“  ì •ë³´ í‘œì‹œ (ì˜ì–´ ì œëª© ì œì™¸)
                            showCreatedDate = !!createdDateStr;
                            showSavedDate = !!(savedDateStr && savedAt);
                            showGenres = !!genresStr;
                            showStep = !!stepStr;
                        }
                        
                        html += `
                            <div class="project-item" onclick="loadProjectTemporary('${project.id}')" style="padding: 12px 15px; margin-bottom: 10px; background: var(--bg-card); border-radius: 8px; border: 1px solid var(--border); cursor: pointer; transition: all 0.2s; min-height: 50px; word-wrap: break-word; overflow-wrap: break-word; width: 100%; box-sizing: border-box; display: flex; align-items: center;" onmouseover="this.style.background='var(--bg-input)'" onmouseout="this.style.background='var(--bg-card)'">
                                <div style="flex: 1; min-width: 0; padding-right: 0; word-wrap: break-word; overflow-wrap: break-word; width: 100%; max-width: 100%; box-sizing: border-box; overflow: hidden; text-align: left; display: flex; flex-direction: column; justify-content: center;">
                                    <div style="font-weight: 600; color: var(--text-primary); margin-bottom: ${isSortMode && !showCreatedDate && !showSavedDate && !showGenres && !showStep ? '0' : '4px'}; line-height: 1.4; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 100%; text-align: left;">${escapeHtml(koreanTitle)}</div>
                                    ${showCreatedDate && createdDateStr ? `<div style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 2px; line-height: 1.3; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; text-align: left;"><span style="opacity: 0.7;">ğŸ“… ì‘ì„±ì¼ì‹œ:</span> <span>${createdDateStr}</span></div>` : ''}
                                    ${showSavedDate && savedDateStr && savedAt ? `<div style="font-size: 0.75rem; color: var(--text-secondary); margin-bottom: 2px; line-height: 1.3; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; text-align: left;"><span style="opacity: 0.7;">âœï¸ ìˆ˜ì •ì¼ì‹œ:</span> <span>${savedDateStr}</span></div>` : ''}
                                    ${showGenres && genresStr ? `<div style="font-size: 0.75rem; color: var(--accent); margin-top: 2px; line-height: 1.3; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; text-align: left;"><span style="opacity: 0.8;">ğŸµ ì¥ë¥´:</span> ${escapeHtml(genresStr)}</div>` : ''}
                                    ${showStep && stepStr ? `<div style="font-size: 0.75rem; color: var(--text-secondary); margin-top: 2px; line-height: 1.3; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; text-align: left;"><span style="opacity: 0.7;">ğŸ“ ì§„í–‰ ë‹¨ê³„:</span> ${escapeHtml(stepStr)}</div>` : ''}
                                </div>
                            </div>
                        `;
                    });
                    
                    projectListEl.innerHTML = html;
                    console.log(`âœ… ${filteredProjects.length}ê°œ í”„ë¡œì íŠ¸ í‘œì‹œ ì™„ë£Œ (ì„ì‹œ ìŠ¤í¬ë¦½íŠ¸)`);
                } catch (error) {
                    console.error('í”„ë¡œì íŠ¸ ë¡œë“œ ì˜¤ë¥˜:', error);
                    const projectListEl = document.getElementById('projectList');
                    if (projectListEl) {
                        projectListEl.innerHTML = '<div style="padding: 20px; text-align: center; color: var(--error);">í”„ë¡œì íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.<br>ì˜¤ë¥˜: ' + error.message + '</div>';
                    }
                }
            }
            
            // ì „ì—­ í•¨ìˆ˜ë¡œ ë“±ë¡ (ë‹¤ë¥¸ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ í˜¸ì¶œ ê°€ëŠ¥í•˜ë„ë¡)
            window.loadProjectList = loadProjectListTemporary;
            window.loadProjectListTemporary = loadProjectListTemporary;
            
            // í”„ë¡œì íŠ¸ ê²€ìƒ‰ í•„í„°ë§
            window.filterProjects = function() {
                loadProjectListTemporary();
            };
            
            // í”„ë¡œì íŠ¸ ì •ë ¬
            window.sortProjects = function() {
                loadProjectListTemporary();
            };
            
            // ì „ì—­ í”„ë¡œì íŠ¸ ìƒíƒœ ì €ì¥
            window.currentProject = null;
            window.currentProjectId = null;
            
            // í”„ë¡œì íŠ¸ ë¡œë“œ í•¨ìˆ˜ (ì™„ì „ êµ¬í˜„)
            window.loadProjectTemporary = function(projectId) {
                try {
                    // localStorageì—ì„œ ëª¨ë“  í”„ë¡œì íŠ¸ ë°ì´í„° ì°¾ê¸°
                    let foundProject = null;
                    
                    for (let i = 0; i < localStorage.length; i++) {
                        const key = localStorage.key(i);
                        if (!key) continue;
                        
                        try {
                            const data = localStorage.getItem(key);
                            if (!data) continue;
                            
                            if (data.trim().startsWith('[')) {
                                const parsed = JSON.parse(data);
                                if (Array.isArray(parsed)) {
                                    const project = parsed.find(p => p && p.id === projectId);
                                    if (project) {
                                        foundProject = project;
                                        break;
                                    }
                                }
                            } else if (data.trim().startsWith('{')) {
                                const parsed = JSON.parse(data);
                                if (parsed && parsed.id === projectId) {
                                    foundProject = parsed;
                                    break;
                                }
                            }
                        } catch (e) {
                            // ë¬´ì‹œ
                        }
                    }
                    
                    if (!foundProject) {
                        alert('í”„ë¡œì íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\ní”„ë¡œì íŠ¸ ID: ' + projectId);
                        return;
                    }
                    
                    // app.jsì˜ loadProject í•¨ìˆ˜ê°€ ìˆìœ¼ë©´ ìš°ì„  ì‚¬ìš©
                    if (typeof window.loadProject === 'function') {
                        window.loadProject(projectId);
                        return;
                    }
                    
                    // í”„ë¡œì íŠ¸ ë°ì´í„°ë¥¼ UIì— ë¡œë“œ
                    console.log('âœ… í”„ë¡œì íŠ¸ ë¡œë“œ ì‹œì‘:', foundProject.title || 'ì œëª© ì—†ìŒ');
                    window.currentProject = foundProject;
                    window.currentProjectId = projectId;
                    
                    // í”„ë¡œì íŠ¸ ë°ì´í„° êµ¬ì¡° í™•ì¸ (data ê°ì²´ ë˜ëŠ” ì§ì ‘ ì†ì„±)
                    const projectData = foundProject.data || foundProject;
                    
                    // 1ë‹¨ê³„: ê°€ì‚¬ ì‘ì„±
                    const title = foundProject.title || projectData.songTitle || projectData.title;
                    if (title) {
                        const titleEl = document.getElementById('songTitle');
                        if (titleEl) titleEl.value = title;
                    }
                    
                    const originalLyrics = projectData.originalLyrics || foundProject.originalLyrics || foundProject.lyrics || '';
                    if (originalLyrics) {
                        const lyricsEl = document.getElementById('originalLyrics');
                        if (lyricsEl) lyricsEl.value = originalLyrics;
                    }
                    
                    const manualStylePrompt = projectData.manualStylePrompt || foundProject.manualStylePrompt || projectData.stylePrompt || foundProject.stylePrompt || '';
                    if (manualStylePrompt) {
                        const styleEl = document.getElementById('manualStylePrompt');
                        if (styleEl) styleEl.value = manualStylePrompt;
                    }
                    
                    // 2ë‹¨ê³„: ìˆ˜ë…¸ ë³€í™˜
                    const sunoLyrics = projectData.sunoLyrics || foundProject.sunoLyrics || '';
                    if (sunoLyrics) {
                        const sunoEl = document.getElementById('sunoLyrics');
                        if (sunoEl) sunoEl.value = sunoLyrics;
                    }
                    
                    const stylePrompt = projectData.stylePrompt || foundProject.stylePrompt || '';
                    if (stylePrompt) {
                        const stylePromptEl = document.getElementById('stylePrompt');
                        if (stylePromptEl) stylePromptEl.value = stylePrompt;
                    }
                    
                    // 3ë‹¨ê³„: AI ë¶„ì„ ê²°ê³¼
                    if (projectData.analysisScores || projectData.feedbacks) {
                        // ë¶„ì„ ê²°ê³¼ í‘œì‹œ
                        const analysisResult = document.getElementById('analysisResult');
                        const analysisLoading = document.getElementById('analysisLoading');
                        if (analysisResult && analysisLoading) {
                            analysisLoading.style.display = 'none';
                            analysisResult.style.display = 'block';
                            
                            // ë¶„ì„ ëŒ€ìƒ í‘œì‹œ
                            const analysisTargetLyrics = document.getElementById('analysisTargetLyrics');
                            if (analysisTargetLyrics && sunoLyrics) {
                                analysisTargetLyrics.textContent = sunoLyrics;
                            }
                            
                            const analysisTargetStyle = document.getElementById('analysisTargetStyle');
                            if (analysisTargetStyle && stylePrompt) {
                                analysisTargetStyle.textContent = stylePrompt;
                            }
                            
                            // Gemini ë¶„ì„ ê²°ê³¼ í‘œì‹œ
                            if (projectData.feedbacks && projectData.feedbacks.length > 0) {
                                const geminiAnalysisCard = document.getElementById('geminiAnalysisCard');
                                const geminiAnalysisResult = document.getElementById('geminiAnalysisResult');
                                if (geminiAnalysisCard && geminiAnalysisResult) {
                                    geminiAnalysisCard.style.display = 'block';
                                    
                                    let feedbackHtml = '';
                                    projectData.feedbacks.forEach((feedback, index) => {
                                        feedbackHtml += `
                                            <div style="margin-bottom: 15px; padding: 15px; background: var(--bg-input); border-radius: 8px; border-left: 4px solid var(--accent);">
                                                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                                                    <span style="font-size: 1.5rem;">${feedback.icon || 'ğŸ’¡'}</span>
                                                    <h4 style="margin: 0; color: var(--text-primary);">${feedback.title || 'í”¼ë“œë°±'}</h4>
                                                </div>
                                                <p style="margin: 0; color: var(--text-secondary); line-height: 1.6; font-size: 0.9rem;">${feedback.desc || ''}</p>
                                            </div>
                                        `;
                                    });
                                    geminiAnalysisResult.innerHTML = feedbackHtml;
                                }
                            }
                        }
                    }
                    
                    // 4ë‹¨ê³„: ê°œì„ ì•ˆ ë°˜ì˜ ë° í™•ì • (ìš°ì„ ìˆœìœ„: finalizedLyrics > finalLyrics)
                    const finalLyrics = projectData.finalizedLyrics || foundProject.finalizedLyrics || projectData.finalLyrics || foundProject.finalLyrics || '';
                    const finalStyle = projectData.finalizedStyle || foundProject.finalizedStyle || projectData.finalStyle || foundProject.finalStyle || '';
                    
                    if (finalLyrics || finalStyle || projectData.improvements) {
                        const improvementCard = document.getElementById('improvementCard');
                        const improvementLoading = document.getElementById('improvementLoading');
                        if (improvementCard && improvementLoading) {
                            improvementLoading.style.display = 'none';
                            improvementCard.style.display = 'block';
                            
                            // í™•ì •ëœ ê°€ì‚¬
                            if (finalLyrics) {
                                const finalizedLyricsEl = document.getElementById('finalizedLyrics');
                                if (finalizedLyricsEl) finalizedLyricsEl.value = finalLyrics;
                            }
                            
                            // í™•ì •ëœ ìŠ¤íƒ€ì¼
                            if (finalStyle) {
                                const finalizedStyleEl = document.getElementById('finalizedStyle');
                                if (finalizedStyleEl) finalizedStyleEl.value = finalStyle;
                            }
                            
                            // ê°œì„ ì•ˆ í‘œì‹œ (ìˆëŠ” ê²½ìš°)
                            if (projectData.improvements && projectData.improvements.length > 0) {
                                // ê°œì„ ì•ˆì€ ì´ë¯¸ í‘œì‹œë˜ì–´ ìˆì„ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ë‚˜ì¤‘ì— ì²˜ë¦¬
                            }
                        }
                    }
                    
                    // 5ë‹¨ê³„: ìµœì¢… ì¶œë ¥
                    if (finalLyrics) {
                        const finalLyricsEl = document.getElementById('finalLyrics');
                        if (finalLyricsEl) {
                            finalLyricsEl.textContent = finalLyrics;
                        }
                    }
                    
                    if (finalStyle) {
                        const finalStyleEl = document.getElementById('finalStyle');
                        if (finalStyleEl) {
                            finalStyleEl.textContent = finalStyle;
                        }
                    }
                    
                    // ìµœì¢… í‰ê°€ ì ìˆ˜Â·ë“±ê¸‰Â·í”„ë¡œê·¸ë ˆìŠ¤ ë°”
                    if (projectData.beforeScore !== undefined || projectData.afterScore !== undefined) {
                        const before = projectData.beforeScore !== undefined ? projectData.beforeScore : 0;
                        const after = projectData.afterScore !== undefined ? projectData.afterScore : before;
                        if (typeof window.updateFinalEvaluationUI === 'function') {
                            window.updateFinalEvaluationUI(before, after, projectData.aiComment != null ? projectData.aiComment : undefined);
                        } else {
                            const beforeScoreEl = document.getElementById('beforeScore');
                            const afterScoreEl = document.getElementById('afterScore');
                            const aiCommentEl = document.getElementById('aiComment');
                            if (beforeScoreEl) beforeScoreEl.textContent = before;
                            if (afterScoreEl) afterScoreEl.textContent = after;
                            if (projectData.aiComment != null && aiCommentEl) aiCommentEl.textContent = projectData.aiComment;
                        }
                    } else if (projectData.aiComment) {
                        const aiCommentEl = document.getElementById('aiComment');
                        if (aiCommentEl) aiCommentEl.textContent = projectData.aiComment;
                    }
                    
                    // ì œëª© í‘œì‹œ
                    if (title) {
                        const finalTitleText = document.getElementById('finalTitleText');
                        if (finalTitleText) finalTitleText.textContent = title;
                    }
                    
                    // 6ë‹¨ê³„: ë§ˆì¼€íŒ… ìë£Œ
                    if (projectData.marketing) {
                        const marketingResult = document.getElementById('marketingResult');
                        const marketingLoading = document.getElementById('marketingLoading');
                        if (marketingResult && marketingLoading) {
                            marketingLoading.style.display = 'none';
                            marketingResult.style.display = 'block';
                            
                            const marketing = projectData.marketing;
                            
                            // ìœ íŠœë¸Œ ì„¤ëª…
                            if (marketing.youtubeDesc) {
                                const youtubeDescEl = document.getElementById('youtubeDesc');
                                if (youtubeDescEl) youtubeDescEl.textContent = marketing.youtubeDesc;
                            }
                            
                            // í‹±í†¡ ì„¤ëª…
                            if (marketing.tiktokDesc) {
                                const tiktokDescEl = document.getElementById('tiktokDesc');
                                if (tiktokDescEl) tiktokDescEl.textContent = marketing.tiktokDesc;
                            }
                            
                            // í•´ì‹œíƒœê·¸
                            if (marketing.hashtags) {
                                const hashtagsEl = document.getElementById('hashtagsContent');
                                if (hashtagsEl) hashtagsEl.textContent = marketing.hashtags;
                            }
                            
                            // ì¸ë„¤ì¼
                            if (marketing.thumbnails && marketing.thumbnails.length > 0) {
                                const thumbnailsGrid = document.getElementById('thumbnailsGrid');
                                if (thumbnailsGrid) {
                                    let thumbnailsHtml = '';
                                    marketing.thumbnails.forEach((thumb, index) => {
                                        thumbnailsHtml += `
                                            <div class="thumbnail-item" style="padding: 15px; background: var(--bg-card); border-radius: 8px; border: 1px solid var(--border);">
                                                <div style="font-weight: 600; margin-bottom: 8px;">${thumb}</div>
                                                <button class="btn btn-small btn-success" onclick="copyToClipboard(null, '${thumb}', event)">ğŸ“‹ ë³µì‚¬</button>
                                            </div>
                                        `;
                                    });
                                    thumbnailsGrid.innerHTML = thumbnailsHtml;
                                }
                            }
                            
                            // MV í”„ë¡¬í”„íŠ¸
                            if (marketing.mvPrompts && marketing.mvPrompts.length > 0) {
                                // MV í”„ë¡¬í”„íŠ¸ëŠ” ë‚˜ì¤‘ì— ì²˜ë¦¬ (ë³µì¡í•œ êµ¬ì¡°)
                                window.currentMVPrompts = marketing.mvPrompts;
                            }
                        }
                    }
                    
                    // ë§ˆì§€ë§‰ ë‹¨ê³„ë¡œ ì´ë™
                    const lastStep = foundProject.lastStep || 1;
                    if (typeof window.goToStep === 'function') {
                        window.goToStep(lastStep, false, true);
                    } else {
                        // goToStepì´ ì—†ìœ¼ë©´ ì§ì ‘ íŒ¨ë„ ì „í™˜
                        goToStepTemporary(lastStep);
                    }
                    // (ì‚¬ì´ë“œë°”ëŠ” ì‚¬ìš©ìê°€ ë‹«ì„ ë•Œë§Œ ìˆ¨ê¹€ - í”„ë¡œì íŠ¸ ë¡œë“œ ì‹œ ìë™ìœ¼ë¡œ ë‹«ì§€ ì•ŠìŒ)
                    
                    console.log('âœ… í”„ë¡œì íŠ¸ ë¡œë“œ ì™„ë£Œ - ëª¨ë“  ë‹¨ê³„ ë°ì´í„° ë¡œë“œë¨');
                    
                } catch (error) {
                    console.error('í”„ë¡œì íŠ¸ ë¡œë“œ ì˜¤ë¥˜:', error);
                    alert('í”„ë¡œì íŠ¸ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n\n' + error.message);
                }
            };
            
            // ë‹¨ê³„ ì´ë™ í•¨ìˆ˜ (ì™„ì „ êµ¬í˜„)
            function goToStepTemporary(step, saveBefore = false, skipValidation = false) {
                try {
                    // ì €ì¥ì´ í•„ìš”í•œ ê²½ìš°
                    if (saveBefore && typeof window.saveCurrentProject === 'function') {
                        window.saveCurrentProject();
                    }
                    
                    // ëª¨ë“  íŒ¨ë„ ë¹„í™œì„±í™”
                    document.querySelectorAll('.panel').forEach(panel => {
                        panel.classList.remove('active');
                    });
                    
                    // ëª¨ë“  ë‹¨ê³„ ë¹„í™œì„±í™”
                    document.querySelectorAll('.step').forEach(stepEl => {
                        stepEl.classList.remove('active');
                    });
                    
                    // ì„ íƒí•œ íŒ¨ë„ í™œì„±í™”
                    const panel = document.getElementById('panel' + step);
                    if (panel) {
                        panel.classList.add('active');
                        // íŒ¨ë„ë¡œ ìŠ¤í¬ë¡¤
                        panel.scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                    
                    // ì„ íƒí•œ ë‹¨ê³„ í™œì„±í™”
                    const stepEl = document.querySelector('.step[data-step="' + step + '"]');
                    if (stepEl) {
                        stepEl.classList.add('active');
                    }
                    
                    console.log('âœ… ë‹¨ê³„ ì´ë™:', step);
                } catch (error) {
                    console.error('ë‹¨ê³„ ì´ë™ ì˜¤ë¥˜:', error);
                }
            }
            
            // goToStep í•¨ìˆ˜ ë“±ë¡
            if (typeof window.goToStep !== 'function') {
                window.goToStep = goToStepTemporary;
            }
            
            // AI ê°€ì‚¬ ìƒì„± í•¨ìˆ˜ (ì„ì‹œ)
            window.generateAILyrics = function() {
                alert('AI ê°€ì‚¬ ìƒì„± ê¸°ëŠ¥ì€ app.js íŒŒì¼ ë³µêµ¬ í›„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\ní˜„ì¬ëŠ” ì§ì ‘ ê°€ì‚¬ë¥¼ ì‘ì„±í•˜ê±°ë‚˜ ì €ì¥ëœ í”„ë¡œì íŠ¸ë¥¼ ë¶ˆëŸ¬ì™€ì„œ ì‚¬ìš©í•˜ì„¸ìš”.');
            };
            
            // ìˆ˜ë…¸ ë³€í™˜ í•¨ìˆ˜ (ì„ì‹œ)
            window.convertToSuno = function() {
                const originalLyrics = document.getElementById('originalLyrics')?.value || '';
                const stylePrompt = document.getElementById('manualStylePrompt')?.value || '';
                
                if (!originalLyrics.trim()) {
                    alert('ê°€ì‚¬ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                // ê°„ë‹¨í•œ ë³€í™˜ (ì‹¤ì œë¡œëŠ” AI API í˜¸ì¶œ í•„ìš”)
                const sunoLyrics = originalLyrics; // ì„ì‹œë¡œ ì›ë³¸ ê°€ì‚¬ ì‚¬ìš©
                const sunoEl = document.getElementById('sunoLyrics');
                const styleEl = document.getElementById('stylePrompt');
                
                if (sunoEl) {
                    sunoEl.value = sunoLyrics;
                }
                if (styleEl && stylePrompt) {
                    styleEl.value = stylePrompt;
                }
                
                alert('ìˆ˜ë…¸ ë³€í™˜ ê¸°ëŠ¥ì€ app.js íŒŒì¼ ë³µêµ¬ í›„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.\n\ní˜„ì¬ëŠ” ì…ë ¥í•œ ê°€ì‚¬ê°€ ê·¸ëŒ€ë¡œ í‘œì‹œë©ë‹ˆë‹¤.');
            };
            
            // 2ë‹¨ê³„ì—ì„œ 3ë‹¨ê³„ë¡œ ì´ë™
            window.goToStep2To3 = function() {
                const sunoLyrics = document.getElementById('sunoLyrics')?.value || '';
                const stylePrompt = document.getElementById('stylePrompt')?.value || '';
                
                if (!sunoLyrics.trim()) {
                    alert('ìˆ˜ë…¸ ê°€ì‚¬ë¥¼ ë¨¼ì € ìƒì„±í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                // 3ë‹¨ê³„ë¡œ ì´ë™
                if (typeof window.goToStep === 'function') {
                    window.goToStep(3, true, false);
                } else {
                    goToStepTemporary(3, true, false);
                }
            };
            
            // 3ë‹¨ê³„ì—ì„œ 4ë‹¨ê³„ë¡œ ì´ë™ (ê°œì„ ì•ˆ ë°˜ì˜)
            window.goToStep4AndApplyImprovements = function() {
                // 4ë‹¨ê³„ë¡œ ì´ë™
                if (typeof window.goToStep === 'function') {
                    window.goToStep(4, true, false);
                } else {
                    goToStepTemporary(4, true, false);
                }
                
                // ê°œì„ ì•ˆ ì¹´ë“œ í‘œì‹œ
                const improvementCard = document.getElementById('improvementCard');
                const improvementLoading = document.getElementById('improvementLoading');
                if (improvementCard && improvementLoading) {
                    improvementLoading.style.display = 'none';
                    improvementCard.style.display = 'block';
                }
            };
            
            // 4ë‹¨ê³„ í™•ì • ì™„ë£Œ
            window.confirmFinalizedContent = function() {
                const finalizedLyrics = document.getElementById('finalizedLyrics')?.value || '';
                const finalizedStyle = document.getElementById('finalizedStyle')?.value || '';
                
                if (!finalizedLyrics.trim()) {
                    alert('í™•ì •ëœ ê°€ì‚¬ë¥¼ ë¨¼ì € ì…ë ¥í•´ì£¼ì„¸ìš”.');
                    return;
                }
                
                // 5ë‹¨ê³„ë¡œ ì´ë™
                if (typeof window.goToStep === 'function') {
                    window.goToStep(5, true, false);
                } else {
                    goToStepTemporary(5, true, false);
                }
                
                // 5ë‹¨ê³„ì— ë°ì´í„° í‘œì‹œ
                const finalLyricsEl = document.getElementById('finalLyrics');
                const finalStyleEl = document.getElementById('finalStyle');
                
                if (finalLyricsEl && finalizedLyrics) {
                    finalLyricsEl.textContent = finalizedLyrics;
                }
                if (finalStyleEl && finalizedStyle) {
                    finalStyleEl.textContent = finalizedStyle;
                }
            };
            
            // ë§ˆì¼€íŒ… ë‹¨ê³„ë¡œ ì´ë™
            window.goToMarketingStep = function() {
                // 6ë‹¨ê³„ë¡œ ì´ë™
                if (typeof window.goToStep === 'function') {
                    window.goToStep(6, true, false);
                } else {
                    goToStepTemporary(6, true, false);
                }
                
                // ë§ˆì¼€íŒ… ê²°ê³¼ í‘œì‹œ (ìˆëŠ” ê²½ìš°)
                const marketingResult = document.getElementById('marketingResult');
                const marketingLoading = document.getElementById('marketingLoading');
                if (marketingResult && marketingLoading) {
                    // ì´ë¯¸ ë°ì´í„°ê°€ ìˆìœ¼ë©´ í‘œì‹œ
                    if (window.currentProject && window.currentProject.data && window.currentProject.data.marketing) {
                        marketingLoading.style.display = 'none';
                        marketingResult.style.display = 'block';
                    } else {
                        alert('ë§ˆì¼€íŒ… ìë£Œ ìƒì„± ê¸°ëŠ¥ì€ app.js íŒŒì¼ ë³µêµ¬ í›„ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                    }
                }
            };
            
            // ë³µì‚¬ í•¨ìˆ˜ (ì„ì‹œ)
            window.copyToClipboard = function(elementId, label, event) {
                try {
                    let text = '';
                    if (elementId) {
                        const el = document.getElementById(elementId);
                        if (el) {
                            text = el.value || el.textContent || el.innerText || '';
                        }
                    } else if (event && event.target) {
                        // ë²„íŠ¼ì˜ ë¶€ëª¨ ìš”ì†Œì—ì„œ í…ìŠ¤íŠ¸ ì°¾ê¸°
                        const parent = event.target.closest('.thumbnail-item, .output-box, .card');
                        if (parent) {
                            text = parent.textContent || parent.innerText || '';
                        }
                    }
                    
                    if (!text.trim()) {
                        alert('ë³µì‚¬í•  ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.');
                        return;
                    }
                    
                    navigator.clipboard.writeText(text).then(() => {
                        alert(`${label || 'ë‚´ìš©'}ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    }).catch(() => {
                        // í´ë°±: í…ìŠ¤íŠ¸ ì˜ì—­ ìƒì„±
                        const textarea = document.createElement('textarea');
                        textarea.value = text;
                        textarea.style.position = 'fixed';
                        textarea.style.opacity = '0';
                        document.body.appendChild(textarea);
                        textarea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textarea);
                        alert(`${label || 'ë‚´ìš©'}ì´ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.`);
                    });
                } catch (error) {
                    console.error('ë³µì‚¬ ì˜¤ë¥˜:', error);
                    alert('ë³µì‚¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                }
            };
            
            // ê¸°íƒ€ ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤
            window.showCopyIndicator = function(message) {
                // ê°„ë‹¨í•œ ì•Œë¦¼ìœ¼ë¡œ ëŒ€ì²´
                console.log(message);
                if (message) {
                    // í™”ë©´ì— í‘œì‹œ
                    const indicator = document.createElement('div');
                    indicator.textContent = message;
                    indicator.style.cssText = 'position: fixed; top: 20px; right: 20px; background: var(--success); color: white; padding: 15px 20px; border-radius: 8px; z-index: 10000; box-shadow: 0 4px 12px rgba(0,0,0,0.3);';
                    document.body.appendChild(indicator);
                    setTimeout(() => {
                        indicator.remove();
                    }, 3000);
                }
            };
            
            window.resetAll = function() {
                if (confirm('ëª¨ë“  ë‚´ìš©ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                    // í¼ ì´ˆê¸°í™”
                    const inputs = document.querySelectorAll('input[type="text"], textarea');
                    inputs.forEach(input => {
                        if (input.id !== 'importFile' && input.id !== 'backupFileInput') {
                            input.value = '';
                        }
                    });
                    
                    // í”„ë¡œì íŠ¸ ìƒíƒœ ì´ˆê¸°í™”
                    window.currentProject = null;
                    window.currentProjectId = null;
                    
                    // 1ë‹¨ê³„ë¡œ ì´ë™
                    if (typeof window.goToStep === 'function') {
                        window.goToStep(1, false, true);
                    } else {
                        goToStepTemporary(1, false, true);
                    }
                    
                    alert('ëª¨ë“  ë‚´ìš©ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
                }
            };
            
            // ë§ˆì¼€íŒ… íƒ­ ì „í™˜
            window.showMarketingTab = function(tabName) {
                // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
                document.querySelectorAll('.marketing-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
                document.querySelectorAll('.marketing-content').forEach(content => {
                    content.classList.remove('active');
                });
                
                // ì„ íƒí•œ íƒ­ í™œì„±í™”
                const tab = document.querySelector(`.marketing-tab[data-tab="${tabName}"]`);
                const content = document.getElementById(`marketing-${tabName}`);
                
                if (tab) tab.classList.add('active');
                if (content) content.classList.add('active');
            };
            
            // MV í”„ë¡¬í”„íŠ¸ ê´€ë ¨ í•¨ìˆ˜ë“¤ì€ app.jsì— ì •ì˜ë˜ì–´ ìˆìŠµë‹ˆë‹¤.
            // ì¤‘ë³µ ì •ì˜ë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•´ ì—¬ê¸°ì„œëŠ” ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.
            // app.jsì˜ í•¨ìˆ˜ë“¤ì´ ì‚¬ìš©ë©ë‹ˆë‹¤:
            // - window.generateSceneOverview (AI í†µí•© ë²„ì „)
            // - window.saveSceneOverview
            // - window.confirmSceneOverviewAndGenerate
            // - window.copyAllMVPrompts
            // - window.downloadMVPrompts
            // - window.generateMVDetailPrompts
            // - window.updateMVPromptTranslation
            // - window.copyMVPromptSection
            // - window.updateMVImageCount
            // - window.saveMVSettings
            // - window.loadMVSettings
            // - window.updateCharacterInputs
            
            // ìƒë‹¨ ë©”ë‰´ ë²„íŠ¼ í´ë¦­ í•¸ë“¤ëŸ¬
            window.handleHeaderButtonClick = function(functionName, event) {
                if (event) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                
                console.log(`ğŸ”˜ í—¤ë” ë²„íŠ¼ í´ë¦­: ${functionName}`);
                
                const functionMap = {
                    'testAPIConnection': () => {
                        if (typeof window.testAPIConnection === 'function') {
                            return window.testAPIConnection();
                        }
                        throw new Error('testAPIConnection í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    },
                    'openAPISettings': () => {
                        if (typeof window.openAPISettings === 'function') {
                            window.openAPISettings();
                            return;
                        }
                        throw new Error('openAPISettings í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    },
                    'openGuidelinesModal': () => {
                        if (typeof window.openGuidelinesModal === 'function') {
                            return window.openGuidelinesModal();
                        }
                        throw new Error('openGuidelinesModal í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    },
                    'saveCurrentProject': () => {
                        if (typeof window.saveCurrentProject === 'function') {
                            try {
                                // ì „ì²´ í”„ë¡œì íŠ¸ ë°ì´í„° ìˆ˜ì§‘ ë° ì €ì¥
                                const saved = window.saveCurrentProject();
                                
                                if (saved) {
                                    // ì €ì¥ ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
                                    const projectTitle = document.getElementById('songTitle')?.value || window.currentProject?.title || 'í”„ë¡œì íŠ¸';
                                    const savedTime = new Date().toLocaleString('ko-KR', {
                                        year: 'numeric',
                                        month: '2-digit',
                                        day: '2-digit',
                                        hour: '2-digit',
                                        minute: '2-digit',
                                        second: '2-digit'
                                    });
                                    
                                    // ì €ì¥ëœ ë°ì´í„° ìš”ì•½
                                    let dataSummary = [];
                                    if (document.getElementById('originalLyrics')?.value) {
                                        dataSummary.push('ê°€ì‚¬ ì‘ì„±');
                                    }
                                    if (document.getElementById('sunoLyrics')?.value) {
                                        dataSummary.push('ìˆ˜ë…¸ ë³€í™˜');
                                    }
                                    if (document.getElementById('finalizedLyrics')?.value || document.getElementById('finalLyrics')?.textContent) {
                                        dataSummary.push('ìµœì¢… í™•ì •');
                                    }
                                    if (window.currentScenes && window.currentScenes.length > 0) {
                                        dataSummary.push(`MV í”„ë¡¬í”„íŠ¸ (${window.currentScenes.length}ê°œ ì”¬)`);
                                    }
                                    
                                    const savedMessage = `âœ… ì „ì²´ í”„ë¡œì íŠ¸ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!\n\ní”„ë¡œì íŠ¸: ${projectTitle}\nì €ì¥ ì‹œê°„: ${savedTime}${dataSummary.length > 0 ? '\n\nì €ì¥ëœ ë‚´ìš©:\n- ' + dataSummary.join('\n- ') : ''}`;
                                    
                                    if (typeof window.showCopyIndicator === 'function') {
                                        window.showCopyIndicator(savedMessage);
                                    } else {
                                        alert(savedMessage);
                                    }
                                    
                                    console.log('âœ… í”„ë¡œì íŠ¸ ì €ì¥ ì™„ë£Œ:', projectTitle, 'ë°ì´í„°:', dataSummary);
                                    return true;
                                } else {
                                    alert('í”„ë¡œì íŠ¸ ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                                    return false;
                                }
                            } catch (error) {
                                console.error('í”„ë¡œì íŠ¸ ì €ì¥ ì˜¤ë¥˜:', error);
                                const errorMessage = `í”„ë¡œì íŠ¸ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n\n${error.message || error}`;
                                alert(errorMessage);
                                return false;
                            }
                        }
                        alert('saveCurrentProject í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        return false;
                    },
                    'manualBackup': () => {
                        // ì „ì²´ í”„ë¡œê·¸ë¨ ë°±ì—…ê³¼ í”„ë¡œì íŠ¸ ë°±ì—… ì¤‘ ì„ íƒ
                        const choice = confirm('ë°±ì—… ë°©ì‹ì„ ì„ íƒí•˜ì„¸ìš”:\n\ní™•ì¸: ì „ì²´ í”„ë¡œê·¸ë¨ ë°±ì—… (í”„ë¡œì íŠ¸ + ì„¤ì •)\nì·¨ì†Œ: í”„ë¡œì íŠ¸ë§Œ ë°±ì—…');
                        
                        if (choice) {
                            // ì „ì²´ í”„ë¡œê·¸ë¨ ë°±ì—…
                            if (typeof window.backupFullProgram === 'function') {
                                return window.backupFullProgram();
                            } else {
                                throw new Error('backupFullProgram í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                            }
                        } else {
                            // í”„ë¡œì íŠ¸ë§Œ ë°±ì—…
                            if (typeof window.manualBackup === 'function') {
                                return window.manualBackup();
                            }
                            throw new Error('manualBackup í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        }
                    },
                    'resetStepOrder': () => {
                        if (typeof window.resetStepOrder === 'function') {
                            return window.resetStepOrder();
                        }
                        throw new Error('resetStepOrder í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    },
                    'resetCurrentStep': () => {
                        if (typeof window.resetCurrentStep === 'function') {
                            return window.resetCurrentStep();
                        }
                        throw new Error('resetCurrentStep í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    },
                    'resetAllSteps': () => {
                        if (typeof window.resetAllSteps === 'function') {
                            return window.resetAllSteps();
                        }
                        throw new Error('resetAllSteps í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    },
                    'openStepOrderHelp': () => {
                        const modal = document.getElementById('stepOrderHelpModal');
                        if (modal) {
                            modal.style.display = 'flex';
                        } else {
                            alert('ë„ì›€ë§ ëª¨ë‹¬ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        }
                    }
                };
                
                const func = functionMap[functionName];
                
                if (func && typeof func === 'function') {
                    try {
                        console.log(`âœ… ${functionName} í•¨ìˆ˜ ì‹¤í–‰ ì¤‘...`);
                        const result = func();
                        if (result instanceof Promise) {
                            result.catch(err => {
                                console.error(`âŒ ${functionName} ì‹¤í–‰ ì˜¤ë¥˜:`, err);
                                alert(`${functionName} ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n\n${err.message || err}`);
                            });
                        }
                    } catch (e) {
                        console.error(`âŒ ${functionName} í˜¸ì¶œ ì˜¤ë¥˜:`, e);
                        alert(`${functionName} í•¨ìˆ˜ í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n\n${e.message || e}`);
                    }
                } else {
                    console.error(`âŒ ${functionName} í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.`);
                    const availableFunctions = Object.keys(functionMap);
                    console.log('ì‚¬ìš© ê°€ëŠ¥í•œ í•¨ìˆ˜ë“¤:', availableFunctions);
                    alert(`${functionName} ê¸°ëŠ¥ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤.\n\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê±°ë‚˜ ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.`);
                    
                    // 1ì´ˆ í›„ ì¬ì‹œë„
                    setTimeout(() => {
                        const retryFunc = functionMap[functionName];
                        if (retryFunc && typeof retryFunc === 'function') {
                            console.log(`âœ… ì¬ì‹œë„: ${functionName} í•¨ìˆ˜ ë°œê²¬`);
                            try {
                                retryFunc();
                            } catch (e) {
                                console.error(`âŒ ì¬ì‹œë„ ì‹¤í–‰ ì˜¤ë¥˜:`, e);
                                alert(`${functionName} ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n\n${e.message || e}`);
                            }
                        }
                    }, 1000);
                }
            };
            
            // API ì„ íƒ ë³€ê²½ í•¸ë“¤ëŸ¬
            window.handleAPIChange = function(value, event) {
                if (event) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                
                console.log(`ğŸ”„ API ì„ íƒ ë³€ê²½: ${value}`);
                
                if (typeof window.changeAPI === 'function') {
                    try {
                        window.changeAPI(value);
                    } catch (e) {
                        console.error('âŒ changeAPI í˜¸ì¶œ ì˜¤ë¥˜:', e);
                        alert('API ì„ íƒ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n\n' + e.message);
                    }
                } else {
                    console.warn('âš ï¸ changeAPI í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ê¸°ë³¸ ë™ì‘ë§Œ ìˆ˜í–‰í•©ë‹ˆë‹¤.');
                    // ê¸°ë³¸ ë™ì‘: ì„ íƒëœ ê°’ë§Œ í‘œì‹œ
                    const apiStatusText = document.getElementById('apiStatusText');
                    if (apiStatusText) {
                        if (value === 'gemini') {
                            apiStatusText.textContent = 'Gemini AI ëª¨ë“œ';
                        } else if (value === 'openai') {
                            apiStatusText.textContent = 'ChatGPT ëª¨ë“œ';
                        }
                    }
                }
            };
            
            // MV í”„ë¡¬í”„íŠ¸ ìƒì„± ë²„íŠ¼ í´ë¦­ í•¸ë“¤ëŸ¬ (ì§„í–‰ í‘œì‹œëŠ” generateSceneOverview ë‚´ë¶€ì—ì„œ ì²˜ë¦¬)
            window.handleMVGenerateClick = function(event) {
                if (event) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                console.log('ğŸ¬ MV í”„ë¡¬í”„íŠ¸ ìƒì„± ë²„íŠ¼ í´ë¦­ë¨');

                if (typeof window.generateSceneOverview === 'function') {
                    console.log('âœ… generateSceneOverview í•¨ìˆ˜ ë°œê²¬, ì‹¤í–‰ ì¤‘...');
                    try {
                        window.generateSceneOverview().catch(function(err) {
                            console.error('âŒ generateSceneOverview ì‹¤í–‰ ì˜¤ë¥˜:', err);
                            alert('MV í”„ë¡¬í”„íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n\n' + (err.message || err));
                        });
                    } catch (e) {
                        console.error('âŒ generateSceneOverview í˜¸ì¶œ ì˜¤ë¥˜:', e);
                        alert('MV í”„ë¡¬í”„íŠ¸ ìƒì„± í•¨ìˆ˜ í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n\n' + e.message);
                    }
                } else {
                    console.error('âŒ generateSceneOverview í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    alert('MV í”„ë¡¬í”„íŠ¸ ìƒì„± ê¸°ëŠ¥ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤.\n\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê±°ë‚˜ ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.');
                    
                    // 1ì´ˆ í›„ ì¬ì‹œë„
                    setTimeout(() => {
                        if (typeof window.generateSceneOverview === 'function') {
                            console.log('âœ… ì¬ì‹œë„: generateSceneOverview í•¨ìˆ˜ ë°œê²¬');
                            window.generateSceneOverview().catch(err => {
                                console.error('âŒ ì¬ì‹œë„ ì‹¤í–‰ ì˜¤ë¥˜:', err);
                                alert('MV í”„ë¡¬í”„íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n\n' + (err.message || err));
                            });
                        }
                    }, 1000);
                }
            };
            
            // í˜ì´ì§€ ë¡œë“œ ì‹œ MV ì„¤ì • ë¡œë“œ
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    setTimeout(() => {
                        if (typeof window.loadMVSettings === 'function') {
                            window.loadMVSettings();
                        } else {
                            console.warn('âš ï¸ loadMVSettings í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                        }
                        if (typeof window.updateMVImageCount === 'function') {
                            window.updateMVImageCount();
                        }
                    }, 500);
                });
            } else {
                setTimeout(() => {
                    if (typeof window.loadMVSettings === 'function') {
                        window.loadMVSettings();
                    } else {
                        console.warn('âš ï¸ loadMVSettings í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    }
                    if (typeof window.updateMVImageCount === 'function') {
                        window.updateMVImageCount();
                    }
                }, 500);
            }
            
            // ì œëª© ë³µì‚¬
            window.copyTitleToClipboard = function(event) {
                const titleText = document.getElementById('finalTitleText')?.textContent || 
                                 document.getElementById('songTitle')?.value || '';
                if (titleText) {
                    window.copyToClipboard(null, 'ì œëª©', { target: { textContent: titleText } });
                } else {
                    alert('ë³µì‚¬í•  ì œëª©ì´ ì—†ìŠµë‹ˆë‹¤.');
                }
            };
            
            // ìµœì¢… ë¹„êµ
            window.showFinalComparison = function() {
                const finalizedLyrics = document.getElementById('finalizedLyrics')?.value || '';
                const finalLyrics = document.getElementById('finalLyrics')?.textContent || '';
                
                if (!finalizedLyrics && !finalLyrics) {
                    alert('ë¹„êµí•  ê°€ì‚¬ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }
                
                let comparison = '=== 4ë‹¨ê³„ í™•ì • ê°€ì‚¬ ===\n\n' + finalizedLyrics + 
                                '\n\n=== 5ë‹¨ê³„ ìµœì¢… ê°€ì‚¬ ===\n\n' + finalLyrics;
                
                alert(comparison);
            };
            
            // ëª¨ë“  í•„ìˆ˜ í•¨ìˆ˜ê°€ ì „ì—­ìœ¼ë¡œ ë“±ë¡ë˜ì—ˆëŠ”ì§€ í™•ì¸
            console.log('âœ… í•µì‹¬ í•¨ìˆ˜ ë“±ë¡ ì™„ë£Œ:', {
                goToStep: typeof window.goToStep === 'function',
                generateAILyrics: typeof window.generateAILyrics === 'function',
                convertToSuno: typeof window.convertToSuno === 'function',
                goToStep2To3: typeof window.goToStep2To3 === 'function',
                goToStep4AndApplyImprovements: typeof window.goToStep4AndApplyImprovements === 'function',
                confirmFinalizedContent: typeof window.confirmFinalizedContent === 'function',
                goToMarketingStep: typeof window.goToMarketingStep === 'function',
                saveCurrentProject: typeof window.saveCurrentProject === 'function',
                copyToClipboard: typeof window.copyToClipboard === 'function',
                toggleEditMode: typeof window.toggleEditMode === 'function',
                updateEditModeUI: typeof window.updateEditModeUI === 'function',
                setReadOnlyMode: typeof window.setReadOnlyMode === 'function'
            });
            
            // ì‚¬ì´ë“œë°” í† ê¸€ í•¨ìˆ˜ (ì„ì‹œ)
            window.toggleSidebar = function() {
                const sidebar = document.getElementById('sidebar');
                const overlay = document.getElementById('sidebarOverlay');
                if (sidebar) {
                    const isOpen = sidebar.classList.contains('open');
                    if (isOpen) {
                        sidebar.classList.remove('open');
                        if (overlay) overlay.style.display = 'none';
                    } else {
                        sidebar.classList.add('open');
                        if (overlay) overlay.style.display = 'block';
                    }
                }
            };
            
            // í”„ë¡œì íŠ¸ ì €ì¥: app.jsì—ì„œë§Œ êµ¬í˜„. app.js ë¡œë“œ í›„ window.saveCurrentProjectê°€ í•´ë‹¹ êµ¬í˜„ìœ¼ë¡œ ë®ì–´ì”Œì›Œì§.
        })();
    </script>
    
    <script>
        // íŒŒì¼ ë³µêµ¬ ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜
        function openFileRecoveryModal() {
            const modal = document.getElementById('fileRecoveryModal');
            if (modal) {
                // !importantë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ ìŠ¤íƒ€ì¼ì„ ë¬´ì‹œí•˜ê³  ëª¨ë‹¬ í‘œì‹œ
                modal.style.cssText = 'display: flex !important; pointer-events: auto !important; opacity: 1 !important; visibility: visible !important; z-index: 10000 !important;';
                modal.classList.add('show');
            }
        }
        
        function closeFileRecoveryModal() {
            const modal = document.getElementById('fileRecoveryModal');
            if (modal) {
                modal.style.display = 'none';
                modal.style.pointerEvents = 'none';
                modal.style.opacity = '0';
                modal.style.visibility = 'hidden';
                modal.style.zIndex = '-1';
            }
        }
        
        function checkAppJsStatus() {
            const statusEl = document.getElementById('appJsStatus');
            if (!statusEl) return;
            
            statusEl.style.display = 'block';
            const contentEl = statusEl.querySelector('div');
            if (!contentEl) return;
            
            contentEl.innerHTML = 'í™•ì¸ ì¤‘...';
            
            // app.js íŒŒì¼ì˜ ì£¼ìš” í•¨ìˆ˜ë“¤ì´ ìˆëŠ”ì§€ í™•ì¸
            const requiredFunctions = [
                'loadProjectList',
                'loadProject',
                'saveCurrentProject',
                'toggleSidebar',
                'goToStep',
                'generateAILyrics',
                'convertToSuno',
                'regenerateMVPrompts'
            ];
            
            let statusText = 'ğŸ“Š app.js íŒŒì¼ ìƒíƒœ í™•ì¸ ê²°ê³¼:\n\n';
            
            let foundCount = 0;
            let missingFunctions = [];
            
            requiredFunctions.forEach(funcName => {
                if (typeof window[funcName] === 'function') {
                    foundCount++;
                } else {
                    missingFunctions.push(funcName);
                }
            });
            
            statusText += `âœ… ë°œê²¬ëœ í•¨ìˆ˜: ${foundCount}/${requiredFunctions.length}ê°œ\n\n`;
            
            if (missingFunctions.length > 0) {
                statusText += `âŒ ëˆ„ë½ëœ í•¨ìˆ˜ (${missingFunctions.length}ê°œ):\n`;
                missingFunctions.forEach(func => {
                    statusText += `   - ${func}\n`;
                });
                statusText += '\nâš ï¸ app.js íŒŒì¼ì´ ì†ìƒë˜ì—ˆê±°ë‚˜ ë¶ˆì™„ì „í•©ë‹ˆë‹¤.\n';
                statusText += 'ìœ„ì˜ ë³µêµ¬ ë°©ë²•ì„ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ì„ ë³µêµ¬í•´ì£¼ì„¸ìš”.';
            } else {
                statusText += 'âœ… ëª¨ë“  ì£¼ìš” í•¨ìˆ˜ê°€ ë°œê²¬ë˜ì—ˆìŠµë‹ˆë‹¤!\n';
                statusText += 'app.js íŒŒì¼ì´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ê³  ìˆìŠµë‹ˆë‹¤.';
            }
            
            contentEl.textContent = statusText;
            contentEl.style.color = missingFunctions.length > 0 ? '#f59e0b' : '#10b981';
        }
        
        // ë°±ì—… íŒŒì¼ ì„ íƒ ì²˜ë¦¬
        let selectedBackupFileContent = null;
        let selectedBackupFileName = null;
        
        function handleBackupFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            selectedBackupFileName = file.name;
            const fileInfo = document.getElementById('backupFileInfo');
            const fileNameEl = document.getElementById('selectedFileName');
            const fileSizeEl = document.getElementById('selectedFileSize');
            const restoreStatus = document.getElementById('backupRestoreStatus');
            
            if (fileInfo && fileNameEl && fileSizeEl) {
                fileNameEl.textContent = file.name;
                fileSizeEl.textContent = formatFileSize(file.size);
                fileInfo.style.display = 'block';
                if (restoreStatus) {
                    restoreStatus.style.display = 'none';
                    restoreStatus.innerHTML = '';
                }
            }
            
            // íŒŒì¼ ë‚´ìš© ì½ê¸°
            const reader = new FileReader();
            reader.onload = function(e) {
                selectedBackupFileContent = e.target.result;
                console.log('âœ… ë°±ì—… íŒŒì¼ ì½ê¸° ì™„ë£Œ:', file.name, 'í¬ê¸°:', file.size, 'bytes');
            };
            reader.onerror = function() {
                alert('íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                selectedBackupFileContent = null;
            };
            reader.readAsText(file);
        }
        
        // íŒŒì¼ í¬ê¸° í¬ë§·íŒ…
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }
        
        // ì„ íƒí•œ ë°±ì—… íŒŒì¼ë¡œ ë³µêµ¬
        function restoreFromSelectedBackup() {
            if (!selectedBackupFileContent) {
                alert('ë°±ì—… íŒŒì¼ì„ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (!confirm('ì„ íƒí•œ ë°±ì—… íŒŒì¼ë¡œ app.jsë¥¼ ë³µêµ¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì£¼ì˜: í˜„ì¬ app.js íŒŒì¼ì´ ë®ì–´ì”Œì›Œì§‘ë‹ˆë‹¤.')) {
                return;
            }
            
            try {
                // íŒŒì¼ ë‚´ìš©ì„ Blobìœ¼ë¡œ ìƒì„±
                const blob = new Blob([selectedBackupFileContent], { type: 'text/javascript' });
                const url = URL.createObjectURL(blob);
                
                // ë‹¤ìš´ë¡œë“œ ë§í¬ ìƒì„±
                const a = document.createElement('a');
                a.href = url;
                a.download = 'app.js';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                // ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ
                const restoreStatus = document.getElementById('backupRestoreStatus');
                if (restoreStatus) {
                    restoreStatus.style.display = 'block';
                    restoreStatus.style.background = 'rgba(16, 185, 129, 0.1)';
                    restoreStatus.style.borderLeft = '4px solid #10b981';
                    restoreStatus.style.color = '#10b981';
                    restoreStatus.innerHTML = `
                        <div style="font-weight: 600; margin-bottom: 8px;">âœ… ë³µêµ¬ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ</div>
                        <div style="font-size: 0.85rem; line-height: 1.6;">
                            <p style="margin: 0 0 8px 0;">
                                <code>app.js</code> íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.
                            </p>
                            <p style="margin: 0 0 8px 0;">
                                ë‹¤ìŒ ë‹¨ê³„ë¥¼ ë”°ë¼ì£¼ì„¸ìš”:
                            </p>
                            <ol style="margin: 8px 0 0 20px; padding: 0;">
                                <li>ë‹¤ìš´ë¡œë“œ í´ë”ì—ì„œ <code>app.js</code> íŒŒì¼ì„ ì°¾ìŠµë‹ˆë‹¤</li>
                                <li>íŒŒì¼ì„ <code>/Users/leemunhyeong/Music Creator/</code> í´ë”ë¡œ ì´ë™í•©ë‹ˆë‹¤</li>
                                <li>ê¸°ì¡´ <code>app.js</code> íŒŒì¼ì„ ë°±ì—…í•œ í›„ ìƒˆ íŒŒì¼ë¡œ êµì²´í•©ë‹ˆë‹¤</li>
                                <li>í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨(F5 ë˜ëŠ” Cmd+R)í•©ë‹ˆë‹¤</li>
                            </ol>
                        </div>
                    `;
                }
                
                console.log('âœ… ë°±ì—… íŒŒì¼ ë³µêµ¬ ë‹¤ìš´ë¡œë“œ ì™„ë£Œ');
            } catch (error) {
                console.error('ë³µêµ¬ íŒŒì¼ ìƒì„± ì˜¤ë¥˜:', error);
                alert('ë³µêµ¬ íŒŒì¼ì„ ìƒì„±í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n\n' + error.message);
            }
        }
        
        // ë°±ì—… íŒŒì¼ì—ì„œ í”„ë¡œì íŠ¸ ë³µêµ¬ í•¨ìˆ˜
        function restoreFromBackupFile() {
            // íŒŒì¼ ì…ë ¥ ìš”ì†Œ ìƒì„±
            const fileInput = document.createElement('input');
            fileInput.type = 'file';
            fileInput.accept = '.json';
            fileInput.style.display = 'none';
            
            fileInput.onchange = function(event) {
                const file = event.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const backupData = JSON.parse(e.target.result);
                        console.log('âœ… ë°±ì—… íŒŒì¼ ì½ê¸° ì™„ë£Œ:', file.name);
                        
                        // ë°±ì—… ë°ì´í„° êµ¬ì¡° í™•ì¸
                        if (!backupData || typeof backupData !== 'object') {
                            throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ ë°±ì—… íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤.');
                        }
                        
                        // í”„ë¡œì íŠ¸ ë°°ì—´ì¸ì§€ í™•ì¸
                        let projects = [];
                        if (Array.isArray(backupData)) {
                            projects = backupData;
                        } else if (backupData.projects && Array.isArray(backupData.projects)) {
                            projects = backupData.projects;
                        } else if (backupData.musicCreatorProjects && Array.isArray(backupData.musicCreatorProjects)) {
                            projects = backupData.musicCreatorProjects;
                        } else {
                            // ë‹¨ì¼ í”„ë¡œì íŠ¸ì¸ ê²½ìš°
                            if (backupData.id || backupData.title) {
                                projects = [backupData];
                            } else {
                                throw new Error('ë°±ì—… íŒŒì¼ì—ì„œ í”„ë¡œì íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                            }
                        }
                        
                        if (projects.length === 0) {
                            throw new Error('ë°±ì—… íŒŒì¼ì— í”„ë¡œì íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.');
                        }
                        
                        // ë³µêµ¬ í™•ì¸
                        const confirmMessage = `ë°±ì—… íŒŒì¼ì—ì„œ ${projects.length}ê°œì˜ í”„ë¡œì íŠ¸ë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.\n\në³µêµ¬í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì£¼ì˜: ê¸°ì¡´ í”„ë¡œì íŠ¸ì™€ IDê°€ ê°™ìœ¼ë©´ ë®ì–´ì”Œì›Œì§‘ë‹ˆë‹¤.`;
                        if (!confirm(confirmMessage)) {
                            return;
                        }
                        
                        // localStorageì— í”„ë¡œì íŠ¸ ì €ì¥
                        let restoredCount = 0;
                        let updatedCount = 0;
                        let errorCount = 0;
                        
                        projects.forEach(project => {
                            try {
                                if (!project.id) {
                                    console.warn('í”„ë¡œì íŠ¸ IDê°€ ì—†ì–´ ê±´ë„ˆëœë‹ˆë‹¤:', project);
                                    errorCount++;
                                    return;
                                }
                                
                                // í”„ë¡œì íŠ¸ì— íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ê°€
                                const now = new Date().toISOString();
                                if (!project.savedAt) {
                                    project.savedAt = now;
                                }
                                if (!project.updatedAt) {
                                    project.updatedAt = now;
                                }
                                
                                // ê¸°ì¡´ í”„ë¡œì íŠ¸ í™•ì¸
                                const existingKeys = [
                                    'musicCreatorProjects',
                                    'savedProjects',
                                    'sunoLyricsHistory',
                                    'stylePromptHistory',
                                    'projects'
                                ];
                                
                                let isUpdate = false;
                                for (const key of existingKeys) {
                                    try {
                                        const existingData = localStorage.getItem(key);
                                        if (existingData) {
                                            const existingProjects = JSON.parse(existingData);
                                            if (Array.isArray(existingProjects)) {
                                                const existingIndex = existingProjects.findIndex(p => p.id === project.id);
                                                if (existingIndex !== -1) {
                                                    existingProjects[existingIndex] = project;
                                                    localStorage.setItem(key, JSON.stringify(existingProjects));
                                                    isUpdate = true;
                                                    updatedCount++;
                                                    break;
                                                }
                                            }
                                        }
                                    } catch (err) {
                                        // í•´ë‹¹ í‚¤ì— ë¬¸ì œê°€ ìˆì–´ë„ ê³„ì† ì§„í–‰
                                        continue;
                                    }
                                }
                                
                                // ê¸°ì¡´ í”„ë¡œì íŠ¸ê°€ ì—†ìœ¼ë©´ ìƒˆë¡œ ì¶”ê°€
                                if (!isUpdate) {
                                    // musicCreatorProjectsì— ì¶”ê°€
                                    try {
                                        const existingData = localStorage.getItem('musicCreatorProjects');
                                        const existingProjects = existingData ? JSON.parse(existingData) : [];
                                        if (Array.isArray(existingProjects)) {
                                            existingProjects.push(project);
                                            localStorage.setItem('musicCreatorProjects', JSON.stringify(existingProjects));
                                            restoredCount++;
                                        }
                                    } catch (err) {
                                        // musicCreatorProjectsì— ë¬¸ì œê°€ ìˆìœ¼ë©´ ìƒˆë¡œ ìƒì„±
                                        localStorage.setItem('musicCreatorProjects', JSON.stringify([project]));
                                        restoredCount++;
                                    }
                                }
                                
                            } catch (err) {
                                console.error('í”„ë¡œì íŠ¸ ë³µêµ¬ ì˜¤ë¥˜:', project.id, err);
                                errorCount++;
                            }
                        });
                        
                        // ê²°ê³¼ ë©”ì‹œì§€
                        let resultMessage = `âœ… ë³µêµ¬ ì™„ë£Œ!\n\n`;
                        resultMessage += `â€¢ ìƒˆë¡œ ë³µêµ¬ëœ í”„ë¡œì íŠ¸: ${restoredCount}ê°œ\n`;
                        resultMessage += `â€¢ ì—…ë°ì´íŠ¸ëœ í”„ë¡œì íŠ¸: ${updatedCount}ê°œ\n`;
                        if (errorCount > 0) {
                            resultMessage += `â€¢ ì˜¤ë¥˜ ë°œìƒ: ${errorCount}ê°œ\n`;
                        }
                        resultMessage += `\ní˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ì—¬ í”„ë¡œì íŠ¸ ëª©ë¡ì„ í™•ì¸í•˜ì„¸ìš”.`;
                        
                        alert(resultMessage);
                        
                        // í”„ë¡œì íŠ¸ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
                        if (typeof window.loadProjectList === 'function') {
                            window.loadProjectList();
                        } else if (typeof loadProjectListTemporary === 'function') {
                            loadProjectListTemporary();
                        }
                        
                    } catch (error) {
                        console.error('ë°±ì—… íŒŒì¼ ë³µêµ¬ ì˜¤ë¥˜:', error);
                        alert('ë°±ì—… íŒŒì¼ ë³µêµ¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤:\n\n' + error.message + '\n\níŒŒì¼ í˜•ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
                    }
                };
                
                reader.onerror = function() {
                    alert('íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                };
                
                reader.readAsText(file);
            };
            
            // íŒŒì¼ ì„ íƒ ëŒ€í™”ìƒì ì—´ê¸°
            document.body.appendChild(fileInput);
            fileInput.click();
            document.body.removeChild(fileInput);
        }
        
        // ì „ì—­ í•¨ìˆ˜ë¡œ ë“±ë¡
        window.openFileRecoveryModal = openFileRecoveryModal;
        window.closeFileRecoveryModal = closeFileRecoveryModal;
        window.checkAppJsStatus = checkAppJsStatus;
        window.handleBackupFileSelect = handleBackupFileSelect;
        window.restoreFromSelectedBackup = restoreFromSelectedBackup;
        window.restoreFromBackupFile = restoreFromBackupFile;
    </script>
    
    <script src="app.js" onerror="console.error('âŒ app.js íŒŒì¼ì„ ë¡œë“œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. íŒŒì¼ ê²½ë¡œë¥¼ í™•ì¸í•˜ì„¸ìš”.');"></script>
    <script>
        // app.js ë¡œë“œ í›„ í”„ë¡œì íŠ¸ ëª©ë¡ ë¡œë“œ ì‹œë„
        (function() {
            function tryLoadProjectListNow() {
                const projectListEl = document.getElementById('projectList');
                if (!projectListEl) {
                    console.warn('âš ï¸ projectList ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return false;
                }
                
                // ì—¬ëŸ¬ ë°©ë²•ìœ¼ë¡œ í•¨ìˆ˜ ì°¾ê¸°
                let loadFunc = null;
                if (typeof window.loadProjectList === 'function') {
                    loadFunc = window.loadProjectList;
                } else if (typeof loadProjectList === 'function') {
                    loadFunc = loadProjectList;
                }
                
                if (loadFunc) {
                    console.log('ğŸ”„ loadProjectList í•¨ìˆ˜ í˜¸ì¶œ');
                    try {
                        loadFunc();
                        return true;
                    } catch (e) {
                        console.error('loadProjectList ì‹¤í–‰ ì˜¤ë¥˜:', e);
                        return false;
                    }
                } else {
                    console.warn('âš ï¸ loadProjectList í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return false;
                }
            }
            
            // DOMContentLoadedì—ì„œë„ í”„ë¡œì íŠ¸ ëª©ë¡ ë¡œë“œ ì‹œë„
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', function() {
                    console.log('ğŸ“‹ DOMContentLoaded ì´ë²¤íŠ¸ - í”„ë¡œì íŠ¸ ëª©ë¡ ë¡œë“œ ì‹œë„');
                    setTimeout(() => {
                        if (!tryLoadProjectListNow()) {
                            setTimeout(() => tryLoadProjectListNow(), 500);
                        }
                    }, 100);
                });
            } else {
                // ì´ë¯¸ ë¡œë“œëœ ê²½ìš° ì¦‰ì‹œ ì‹œë„
                setTimeout(() => {
                    if (!tryLoadProjectListNow()) {
                        setTimeout(() => tryLoadProjectListNow(), 500);
                    }
                }, 100);
            }
        })();
        
        // í˜ì´ì§€ ë¡œë“œ ì¦‰ì‹œ ì˜¤ë²„ë ˆì´ì™€ ëª¨ë‹¬ ì™„ì „íˆ ì œê±°/ìˆ¨ê¸°ê¸° (í´ë¦­ ë°©ì§€ ë¬¸ì œ í•´ê²°)
        (function() {
            function forceHideOverlays() {
                try {
                    // sidebar-overlay ì™„ì „íˆ ìˆ¨ê¸°ê¸°
                    const sidebarOverlay = document.getElementById('sidebarOverlay');
                    if (sidebarOverlay) {
                        sidebarOverlay.style.cssText = 'display: none !important; pointer-events: none !important; opacity: 0 !important; visibility: hidden !important; z-index: -9999 !important; position: fixed !important;';
                        sidebarOverlay.classList.remove('show', 'active');
                        sidebarOverlay.removeAttribute('onclick'); // onclick ì œê±°ë¡œ í´ë¦­ ë°©ì§€
                    }
                    
                    // ëª¨ë“  ëª¨ë‹¬ ì™„ì „íˆ ìˆ¨ê¸°ê¸° (API í‚¤ ì„¤ì • ëª¨ë‹¬ì€ ì œì™¸ - ì‚¬ìš©ìê°€ ì—´ì–´ë‘” ê²½ìš° ìœ ì§€)
                    const modals = ['guidelinesModal', 'projectReferenceModal'];
                    modals.forEach(modalId => {
                        const modal = document.getElementById(modalId);
                        if (modal) {
                            modal.style.cssText = 'display: none !important; pointer-events: none !important; z-index: -9999 !important;';
                            modal.classList.remove('show');
                        }
                    });
                    // apiSettingsModalì€ ì ˆëŒ€ ê±´ë“œë¦¬ì§€ ì•ŠìŒ (openAPISettings/closeAPISettingsë¡œë§Œ ì œì–´)
                    
                    // .modal-overlay ì¤‘ API ì„¤ì • ëª¨ë‹¬ì´ ì•„ë‹Œ ê²ƒë§Œ ìˆ¨ê¸°ê¸°
                    document.querySelectorAll('.modal-overlay').forEach(overlay => {
                        if (overlay.id === 'apiSettingsModal') return;
                        overlay.style.cssText = 'display: none !important; pointer-events: none !important; z-index: -9999 !important;';
                        overlay.classList.remove('show');
                    });
                    
                    // bodyì™€ htmlì´ í´ë¦­ ê°€ëŠ¥í•œì§€ í™•ì¸
                    document.body.style.pointerEvents = 'auto';
                    document.documentElement.style.pointerEvents = 'auto';
                    document.body.style.cursor = 'default';
                    document.documentElement.style.cursor = 'default';
                    
                    // ëª¨ë“  ë²„íŠ¼ê³¼ í´ë¦­ ê°€ëŠ¥í•œ ìš”ì†Œê°€ í´ë¦­ ê°€ëŠ¥í•œì§€ í™•ì¸
                    document.querySelectorAll('button, a, input, textarea, select').forEach(el => {
                        el.style.pointerEvents = 'auto';
                        el.style.cursor = el.tagName === 'BUTTON' || el.tagName === 'A' ? 'pointer' : 'default';
                    });
                    
                    console.log('âœ… ì˜¤ë²„ë ˆì´/ëª¨ë‹¬ ê°•ì œ ìˆ¨ê¹€ ì™„ë£Œ');
                } catch (e) {
                    console.error('ê°•ì œ ìˆ¨ê¹€ ì˜¤ë¥˜:', e);
                }
            }
            
            // ì¦‰ì‹œ ì‹¤í–‰ (ìŠ¤í¬ë¦½íŠ¸ê°€ ì‹¤í–‰ë˜ëŠ” ìˆœê°„)
            forceHideOverlays();
            
            // DOMContentLoaded ì‹œì—ë„ ì‹¤í–‰
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', forceHideOverlays, { once: true });
            }
            
            // ì¶”ê°€ ì•ˆì „ì¥ì¹˜: ì—¬ëŸ¬ ì‹œì ì—ì„œ ì‹¤í–‰
            setTimeout(forceHideOverlays, 0);
            setTimeout(forceHideOverlays, 50);
            setTimeout(forceHideOverlays, 100);
            setTimeout(forceHideOverlays, 300);
            setTimeout(forceHideOverlays, 500);
            setTimeout(forceHideOverlays, 1000);
            
            // window.load ì‹œì—ë„ ì‹¤í–‰
            window.addEventListener('load', forceHideOverlays, { once: true });
        })();
    </script>
    
    <!-- ê°œë°œììš© í…ŒìŠ¤íŠ¸ íŒ¨ë„ (ê°œë°œ ëª¨ë“œì—ì„œë§Œ í‘œì‹œ) -->
    <div id="devTestPanel" style="position: fixed; bottom: 20px; right: 20px; z-index: 10000; display: none; background: rgba(0, 0, 0, 0.9); border: 2px solid var(--accent); border-radius: 10px; padding: 15px; max-width: 300px; font-family: monospace; box-shadow: 0 4px 20px rgba(139, 92, 246, 0.3);">
        <div style="color: var(--accent); font-weight: 600; margin-bottom: 10px; font-size: 0.9rem;">ğŸ§ª ê°œë°œì í…ŒìŠ¤íŠ¸ ë„êµ¬</div>
        <div style="display: flex; flex-direction: column; gap: 8px;">
            <button class="btn btn-small btn-primary" onclick="runAutoTest()" style="width: 100%; font-size: 0.85rem;">
                ğŸ” ì „ì²´ ìë™ í…ŒìŠ¤íŠ¸
            </button>
            <button class="btn btn-small btn-secondary" onclick="quickCheck()" style="width: 100%; font-size: 0.85rem;">
                âš¡ ë¹ ë¥¸ ì˜¤ë¥˜ ê²€ì‚¬
            </button>
            <button class="btn btn-small btn-secondary" onclick="testStep(1)" style="width: 100%; font-size: 0.85rem;">
                ğŸ“‹ 1ë‹¨ê³„ í…ŒìŠ¤íŠ¸
            </button>
            <button class="btn btn-small btn-secondary" onclick="testStep(5)" style="width: 100%; font-size: 0.85rem;">
                ğŸ“‹ 5ë‹¨ê³„ í…ŒìŠ¤íŠ¸
            </button>
            <button class="btn btn-small btn-secondary" onclick="document.getElementById('devTestPanel').style.display='none'" style="width: 100%; font-size: 0.85rem; background: var(--error);">
                âœ• ë‹«ê¸°
            </button>
        </div>
        <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid var(--border); font-size: 0.75rem; color: var(--text-secondary);">
            ğŸ’¡ ì½˜ì†”ì—ì„œë„ ì‹¤í–‰ ê°€ëŠ¥:<br>
            <code style="background: rgba(139, 92, 246, 0.2); padding: 2px 4px; border-radius: 3px;">runAutoTest()</code>
        </div>
    </div>
    
    <script>
        // ê°œë°œì ëª¨ë“œ í™œì„±í™” (URLì— ?dev=true ì¶”ê°€í•˜ê±°ë‚˜ Ctrl+Shift+Të¡œ í† ê¸€)
        if (window.location.search.includes('dev=true') || localStorage.getItem('devMode') === 'true') {
            document.getElementById('devTestPanel').style.display = 'block';
        }
        
        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ë¡œ í† ê¸€ (Ctrl+Shift+T)
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.shiftKey && e.key === 'T') {
                const panel = document.getElementById('devTestPanel');
                panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
                if (panel.style.display === 'block') {
                    localStorage.setItem('devMode', 'true');
                } else {
                    localStorage.removeItem('devMode');
                }
            }
        });
    </script>
</body>
</html>


